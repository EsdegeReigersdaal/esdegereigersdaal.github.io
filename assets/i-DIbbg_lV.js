import{r as m,j as o}from"./likec4-DsKTg5QM.js";import{aM as Fd,ax as de,aN as Vd,aO as ln,aP as gi,aQ as gr,aR as $i,au as yn,aS as Fi,aT as h,aU as ut,aA as Me,aV as hr,a4 as Z,aW as He,ah as Vi,aX as mr,aY as Od,aZ as Wd,a_ as Oi,i as X,T as z,a$ as ne,e as _e,b0 as hi,b1 as Hd,b2 as fr,b3 as pe,b4 as I,b5 as St,ak as qd,B as ke,b6 as Xd,b7 as Yd,b8 as xr,b9 as Jn,ba as Oe,bb as eo,bc as Xe,bd as ee,be as yr,bf as ot,a2 as le,bg as Wt,bh as Zt,bi as Ee,am as fo,H as br,an as xo,r as tt,G as oe,bj as Kt,af as Wi,$ as B,bk as yo,bl as Hi,bm as wr,bn as vr,bo,D as wo,aw as to,S as Te,bp as Gd,bq as fe,br as gn,bs as kr,aH as Ke,bt as jt,ao as re,aK as Ht,bu as no,bv as Zd,bw as Kd,bx as jr,by as Ba,bz as Ta,bA as Ud,bB as Qd,bC as mi,bD as Jd,bE as ec,bF as Cr,av as qt,aq as me,bG as tc,bH as nc,bI as oc,bJ as ic,bK as ac,bL as sc,bM as Ve,bN as vo,ad as rc,P as qi,a9 as Sr,aa as _r,ab as fi,ac as Lt,bO as lc,bP as dc,bQ as cc,bR as hn,bS as _t,bT as Xi,bU as Yi,ar as Se,bV as xi,bW as nt,bX as wt,bY as uc,bZ as pc,b_ as ko,b$ as gc,c0 as hc,u as mc,c1 as fc,c2 as Pr,c3 as gt,c4 as Mr,Y as Er,h as xc,c5 as yc,c6 as Nr,E as Gi,c7 as bc,c8 as wc,c9 as Zi,ca as Ki,cb as it,cc as Ir,g as vc,cd as La,ce as kc,cf as jc,cg as Cc,ch as Rr,ci as Dr,cj as Ui,ck as Sc,cl as _c,cm as oo,aE as Pc,aF as Mc,aG as Ec,cn as Br,I as Tr,M as zt,x as Lr,y as Ar,A as zr,co as Nc,cp as Ic,cq as Aa,cr as $r,cs as Qi,ct as Pe,cu as Fr,ap as Rc,as as Dc,at as Bc,cv as yi,aI as jo,aJ as io,aL as Vr,cw as Tc,cx as ao,cy as Ji,cz as za,cA as Ln,j as dn,R as vt,cB as Lc,cC as bi,cD as Ac,cE as Or,cF as zc,cG as $a,cH as $c,cI as Fa,cJ as Fc,cK as Vc,cL as Xo,cM as Oc,cN as Wr,cO as ea,cP as Wc,cQ as Hc,cR as qc,cS as Xc,cT as Va,cU as Hr,cV as Yc,cW as Gc,cX as Zc,cY as Oa,cZ as Kc,c_ as Wa,c$ as Uc,d0 as ta,d1 as Qc,d2 as Jc,d3 as eu,Z as tu,d4 as nu,d5 as ou,d6 as iu,W as au,ay as su,d7 as ru,d8 as lu,d9 as du,da as cu,db as uu,dc as pu,dd as gu,de as hu,df as qr,dg as wi,t as Ha,dh as qa,di as mu,dj as fu,dk as xu,dl as yu,dm as bu,dn as wu,dp as vu,dq as ku,dr as ju,ds as Cu,dt as Su}from"./e-DmkelDom.js";function so(e){return typeof e=="object"&&e!=null&&!Array.isArray(e)}var _u=e=>typeof e=="object"&&e!==null;function Nt(e){return Object.fromEntries(Object.entries(e??{}).filter(([t,n])=>n!==void 0))}var Pu=e=>e==="base";function Mu(e){return e.slice().filter(t=>!Pu(t))}function Xa(e){return String.fromCharCode(e+(e>25?39:97))}function Eu(e){let t="",n;for(n=Math.abs(e);n>52;n=n/52|0)t=Xa(n%52)+t;return Xa(n%52)+t}function Nu(e,t){let n=t.length;for(;n;)e=e*33^t.charCodeAt(--n);return e}function Iu(e){return Eu(Nu(5381,e)>>>0)}var Xr=/\s*!(important)?/i;function Ru(e){return typeof e=="string"?Xr.test(e):!1}function Du(e){return typeof e=="string"?e.replace(Xr,"").trim():e}function na(e){return typeof e=="string"?e.replaceAll(" ","_"):e}var ge=e=>{const t=new Map;return(...n)=>{const i=JSON.stringify(n);if(t.has(i))return t.get(i);const a=e(...n);return t.set(i,a),a}},Bu=new Set(["__proto__","constructor","prototype"]);function oa(...e){return e.reduce((t,n)=>(n&&Object.keys(n).forEach(i=>{if(Bu.has(i))return;const a=t[i],s=n[i];so(a)&&so(s)?t[i]=oa(a,s):t[i]=s}),t),{})}var Tu=e=>e!=null;function ia(e,t,n={}){const{stop:i,getKey:a}=n;function s(r,l=[]){if(_u(r)){const d={};for(const[c,u]of Object.entries(r)){const p=a?.(c,u)??c,g=[...l,p];if(i?.(r,g))return t(r,l);const f=s(u,g);Tu(f)&&(d[p]=f)}return d}return t(r,l)}return s(e)}function Lu(e,t){return Array.isArray(e)?e.map(n=>t(n)):so(e)?ia(e,n=>t(n)):t(e)}function Au(e,t){return e.reduce((n,i,a)=>{const s=t[a];return i!=null&&(n[s]=i),n},{})}function Yr(e,t,n=!0){const{utility:i,conditions:a}=t,{hasShorthand:s,resolveShorthand:r}=i;return ia(e,l=>Array.isArray(l)?Au(l,a.breakpoints.keys):l,{stop:l=>Array.isArray(l),getKey:n?l=>s?r(l):l:void 0})}var zu={shift:e=>e,finalize:e=>e,breakpoints:{keys:[]}},$u=e=>typeof e=="string"?e.replaceAll(/[\n\s]+/g," "):e;function Gr(e){const{utility:t,hash:n,conditions:i=zu}=e,a=r=>[t.prefix,r].filter(Boolean).join("-"),s=(r,l)=>{let d;if(n){const c=[...i.finalize(r),l];d=a(t.toHash(c,Iu))}else d=[...i.finalize(r),a(l)].join(":");return d};return ge(({base:r,...l}={})=>{const d=Object.assign(l,r),c=Yr(d,e),u=new Set;return ia(c,(p,g)=>{if(p==null)return;const f=Ru(p),[y,...b]=i.shift(g),C=Mu(b),k=t.transform(y,Du($u(p)));let v=s(C,k.className);f&&(v=`${v}!`),u.add(v)}),Array.from(u).join(" ")})}function Fu(...e){return e.flat().filter(t=>so(t)&&Object.keys(Nt(t)).length>0)}function Vu(e){function t(a){const s=Fu(...a);return s.length===1?s:s.map(r=>Yr(r,e))}function n(...a){return oa(...t(a))}function i(...a){return Object.assign({},...t(a))}return{mergeCss:ge(n),assignCss:i}}var Ou=/([A-Z])/g,Wu=/^ms-/,Hu=ge(e=>e.startsWith("--")?e:e.replace(Ou,"-$1").replace(Wu,"-ms-").toLowerCase()),qu=["min","max","clamp","calc"],Xu=new RegExp(`^(${qu.join("|")})\\(.*\\)`),Yu=e=>typeof e=="string"&&Xu.test(e),Gu="cm,mm,Q,in,pc,pt,px,em,ex,ch,rem,lh,rlh,vw,vh,vmin,vmax,vb,vi,svw,svh,lvw,lvh,dvw,dvh,cqw,cqh,cqi,cqb,cqmin,cqmax,%",Zu=`(?:${Gu.split(",").join("|")})`,Ku=new RegExp(`^[+-]?[0-9]*.?[0-9]+(?:[eE][+-]?[0-9]+)?${Zu}$`),Uu=e=>typeof e=="string"&&Ku.test(e),Qu=e=>typeof e=="string"&&/^var\(--.+\)$/.test(e),bn={map:Lu,isCssFunction:Yu,isCssVar:Qu,isCssUnit:Uu},wn=(e,t)=>{if(!e?.defaultValues)return t;const n=typeof e.defaultValues=="function"?e.defaultValues(t):e.defaultValues;return Object.assign({},n,Nt(t))},Ju=(e={})=>{const t=i=>({className:[e.className,i].filter(Boolean).join("__"),base:e.base?.[i]??{},variants:{},defaultVariants:e.defaultVariants??{},compoundVariants:e.compoundVariants?aa(e.compoundVariants,i):[]}),n=(e.slots??[]).map(i=>[i,t(i)]);for(const[i,a]of Object.entries(e.variants??{}))for(const[s,r]of Object.entries(a))n.forEach(([l,d])=>{d.variants[i]??={},d.variants[i][s]=r[l]??{}});return Object.fromEntries(n)},aa=(e,t)=>e.filter(n=>n.css[t]).map(n=>({...n,css:n.css[t]}));function ce(e,...t){const n=Object.getOwnPropertyDescriptors(e),i=Object.keys(n),a=r=>{const l={};for(let d=0;d<r.length;d++){const c=r[d];n[c]&&(Object.defineProperty(l,c,n[c]),delete n[c])}return l},s=r=>a(Array.isArray(r)?r:i.filter(r));return t.map(s).concat(a(i))}var vi=(...e)=>{const t=e.reduce((n,i)=>(i&&i.forEach(a=>n.add(a)),n),new Set([]));return Array.from(t)},Zr=["htmlSize","htmlTranslate","htmlWidth","htmlHeight"];function ep(e){return Zr.includes(e)?e.replace("html","").toLowerCase():e}function ki(e){return Object.fromEntries(Object.entries(e).map(([t,n])=>[ep(t),n]))}ki.keys=Zr;const tp="_hover,_focus,_focusWithin,_focusVisible,_disabled,_active,_visited,_target,_readOnly,_readWrite,_empty,_checked,_enabled,_expanded,_highlighted,_complete,_incomplete,_dragging,_before,_after,_firstLetter,_firstLine,_marker,_selection,_file,_backdrop,_first,_last,_only,_even,_odd,_firstOfType,_lastOfType,_onlyOfType,_peerFocus,_peerHover,_peerActive,_peerFocusWithin,_peerFocusVisible,_peerDisabled,_peerChecked,_peerInvalid,_peerExpanded,_peerPlaceholderShown,_groupFocus,_groupHover,_groupActive,_groupFocusWithin,_groupFocusVisible,_groupDisabled,_groupChecked,_groupExpanded,_groupInvalid,_indeterminate,_required,_valid,_invalid,_autofill,_inRange,_outOfRange,_placeholder,_placeholderShown,_pressed,_selected,_grabbed,_underValue,_overValue,_atValue,_default,_optional,_open,_closed,_fullscreen,_loading,_hidden,_current,_currentPage,_currentStep,_today,_unavailable,_rangeStart,_rangeEnd,_now,_topmost,_motionReduce,_motionSafe,_print,_landscape,_portrait,_dark,_light,_osDark,_osLight,_highContrast,_lessContrast,_moreContrast,_ltr,_rtl,_scrollbar,_scrollbarThumb,_scrollbarTrack,_horizontal,_vertical,_icon,_starting,_noscript,_invertedColors,_shapeSizeXs,_shapeSizeSm,_shapeSizeMd,_shapeSizeLg,_shapeSizeXl,_shapeRectangle,_shapePerson,_shapeBrowser,_shapeMobile,_shapeCylinder,_shapeStorage,_shapeQueue,_notDisabled,_reduceGraphics,_reduceGraphicsOnPan,_noReduceGraphics,_whenPanning,_smallZoom,_compoundTransparent,_edgeActive,_whenHovered,_whenSelected,_whenDimmed,_whenFocused,_p3,_srgb,_rec2020,xs,xsOnly,xsDown,sm,smOnly,smDown,md,mdOnly,mdDown,lg,lgOnly,lgDown,xl,xlOnly,xlDown,xsToSm,xsToMd,xsToLg,xsToXl,smToMd,smToLg,smToXl,mdToLg,mdToXl,lgToXl,@/xs,@/sm,@/md,@/lg,@likec4-root/xs,@likec4-root/sm,@likec4-root/md,@likec4-root/lg,@likec4-dialog/xs,@likec4-dialog/sm,@likec4-dialog/md,@likec4-dialog/lg,base",Kr=new Set(tp.split(",")),np=/^@|&|&$/;function Ya(e){return Kr.has(e)||np.test(e)}const op=/^_/,ip=/&|@/;function Ur(e){return e.map(t=>Kr.has(t)?t.replace(op,""):ip.test(t)?`[${na(t.trim())}]`:t)}function Qr(e){return e.sort((t,n)=>{const i=Ya(t),a=Ya(n);return i&&!a?1:!i&&a?-1:0})}const ap="aspectRatio:asp,boxDecorationBreak:bx-db,zIndex:z,boxSizing:bx-s,objectPosition:obj-p,objectFit:obj-f,overscrollBehavior:ovs-b,overscrollBehaviorX:ovs-bx,overscrollBehaviorY:ovs-by,position:pos/1,top:top,left:left,inset:inset,insetInline:inset-x/insetX,insetBlock:inset-y/insetY,insetBlockEnd:inset-be,insetBlockStart:inset-bs,insetInlineEnd:inset-e/insetEnd/end,insetInlineStart:inset-s/insetStart/start,right:right,bottom:bottom,float:float,visibility:vis,display:d,hideFrom:hide,hideBelow:show,flexBasis:flex-b,flex:flex,flexDirection:flex-d/flexDir,flexGrow:flex-g,flexShrink:flex-sh,gridTemplateColumns:grid-tc,gridTemplateRows:grid-tr,gridColumn:grid-c,gridRow:grid-r,gridColumnStart:grid-cs,gridColumnEnd:grid-ce,gridAutoFlow:grid-af,gridAutoColumns:grid-ac,gridAutoRows:grid-ar,gap:gap,gridGap:grid-g,gridRowGap:grid-rg,gridColumnGap:grid-cg,rowGap:rg,columnGap:cg,justifyContent:jc,alignContent:ac,alignItems:ai,alignSelf:as,padding:p/1,paddingLeft:pl/1,paddingRight:pr/1,paddingTop:pt/1,paddingBottom:pb/1,paddingBlock:py/1/paddingY,paddingBlockEnd:pbe,paddingBlockStart:pbs,paddingInline:px/paddingX/1,paddingInlineEnd:pe/1/paddingEnd,paddingInlineStart:ps/1/paddingStart,marginLeft:ml/1,marginRight:mr/1,marginTop:mt/1,marginBottom:mb/1,margin:m/1,marginBlock:my/1/marginY,marginBlockEnd:mbe,marginBlockStart:mbs,marginInline:mx/1/marginX,marginInlineEnd:me/1/marginEnd,marginInlineStart:ms/1/marginStart,spaceX:sx,spaceY:sy,outlineWidth:ring-w/ringWidth,outlineColor:ring-c/ringColor,outline:ring/1,outlineOffset:ring-o/ringOffset,focusRing:focus-ring,focusVisibleRing:focus-v-ring,focusRingColor:focus-ring-c,focusRingOffset:focus-ring-o,focusRingWidth:focus-ring-w,focusRingStyle:focus-ring-s,divideX:dvd-x,divideY:dvd-y,divideColor:dvd-c,divideStyle:dvd-s,width:w/1,inlineSize:w-is,minWidth:min-w/minW,minInlineSize:min-w-is,maxWidth:max-w/maxW,maxInlineSize:max-w-is,height:h/1,blockSize:h-bs,minHeight:min-h/minH,minBlockSize:min-h-bs,maxHeight:max-h/maxH,maxBlockSize:max-b,boxSize:size,color:c,fontFamily:ff,fontSize:fs,fontSizeAdjust:fs-a,fontPalette:fp,fontKerning:fk,fontFeatureSettings:ff-s,fontWeight:fw,fontSmoothing:fsmt,fontVariant:fv,fontVariantAlternates:fv-alt,fontVariantCaps:fv-caps,fontVariationSettings:fv-s,fontVariantNumeric:fv-num,letterSpacing:ls,lineHeight:lh,textAlign:ta,textDecoration:td,textDecorationColor:td-c,textEmphasisColor:te-c,textDecorationStyle:td-s,textDecorationThickness:td-t,textUnderlineOffset:tu-o,textTransform:tt,textIndent:ti,textShadow:tsh,textShadowColor:tsh-c/textShadowColor,textOverflow:tov,verticalAlign:va,wordBreak:wb,textWrap:tw,truncate:trunc,lineClamp:lc,listStyleType:li-t,listStylePosition:li-pos,listStyleImage:li-img,listStyle:li-s,backgroundPosition:bg-p/bgPosition,backgroundPositionX:bg-p-x/bgPositionX,backgroundPositionY:bg-p-y/bgPositionY,backgroundAttachment:bg-a/bgAttachment,backgroundClip:bg-cp/bgClip,background:bg/1,backgroundColor:bg-c/bgColor,backgroundOrigin:bg-o/bgOrigin,backgroundImage:bg-i/bgImage,backgroundRepeat:bg-r/bgRepeat,backgroundBlendMode:bg-bm/bgBlendMode,backgroundSize:bg-s/bgSize,backgroundGradient:bg-grad/bgGradient,backgroundLinear:bg-linear/bgLinear,backgroundRadial:bg-radial/bgRadial,backgroundConic:bg-conic/bgConic,textGradient:txt-grad,gradientFromPosition:grad-from-pos,gradientToPosition:grad-to-pos,gradientFrom:grad-from,gradientTo:grad-to,gradientVia:grad-via,gradientViaPosition:grad-via-pos,borderRadius:bdr/rounded,borderTopLeftRadius:bdr-tl/roundedTopLeft,borderTopRightRadius:bdr-tr/roundedTopRight,borderBottomRightRadius:bdr-br/roundedBottomRight,borderBottomLeftRadius:bdr-bl/roundedBottomLeft,borderTopRadius:bdr-t/roundedTop,borderRightRadius:bdr-r/roundedRight,borderBottomRadius:bdr-b/roundedBottom,borderLeftRadius:bdr-l/roundedLeft,borderStartStartRadius:bdr-ss/roundedStartStart,borderStartEndRadius:bdr-se/roundedStartEnd,borderStartRadius:bdr-s/roundedStart,borderEndStartRadius:bdr-es/roundedEndStart,borderEndEndRadius:bdr-ee/roundedEndEnd,borderEndRadius:bdr-e/roundedEnd,border:bd,borderWidth:bd-w,borderTopWidth:bd-t-w,borderLeftWidth:bd-l-w,borderRightWidth:bd-r-w,borderBottomWidth:bd-b-w,borderBlockStartWidth:bd-bs-w,borderBlockEndWidth:bd-be-w,borderColor:bd-c,borderInline:bd-x/borderX,borderInlineWidth:bd-x-w/borderXWidth,borderInlineColor:bd-x-c/borderXColor,borderBlock:bd-y/borderY,borderBlockWidth:bd-y-w/borderYWidth,borderBlockColor:bd-y-c/borderYColor,borderLeft:bd-l,borderLeftColor:bd-l-c,borderInlineStart:bd-s/borderStart,borderInlineStartWidth:bd-s-w/borderStartWidth,borderInlineStartColor:bd-s-c/borderStartColor,borderRight:bd-r,borderRightColor:bd-r-c,borderInlineEnd:bd-e/borderEnd,borderInlineEndWidth:bd-e-w/borderEndWidth,borderInlineEndColor:bd-e-c/borderEndColor,borderTop:bd-t,borderTopColor:bd-t-c,borderBottom:bd-b,borderBottomColor:bd-b-c,borderBlockEnd:bd-be,borderBlockEndColor:bd-be-c,borderBlockStart:bd-bs,borderBlockStartColor:bd-bs-c,opacity:op,boxShadow:bx-sh/shadow,boxShadowColor:bx-sh-c/shadowColor,mixBlendMode:mix-bm,filter:filter,brightness:brightness,contrast:contrast,grayscale:grayscale,hueRotate:hue-rotate,invert:invert,saturate:saturate,sepia:sepia,dropShadow:drop-shadow,blur:blur,backdropFilter:bkdp,backdropBlur:bkdp-blur,backdropBrightness:bkdp-brightness,backdropContrast:bkdp-contrast,backdropGrayscale:bkdp-grayscale,backdropHueRotate:bkdp-hue-rotate,backdropInvert:bkdp-invert,backdropOpacity:bkdp-opacity,backdropSaturate:bkdp-saturate,backdropSepia:bkdp-sepia,borderCollapse:bd-cl,borderSpacing:bd-sp,borderSpacingX:bd-sx,borderSpacingY:bd-sy,tableLayout:tbl,transitionTimingFunction:trs-tmf,transitionDelay:trs-dly,transitionDuration:trs-dur,transitionProperty:trs-prop,transition:transition,animation:anim,animationName:anim-n,animationTimingFunction:anim-tmf,animationDuration:anim-dur,animationDelay:anim-dly,animationPlayState:anim-ps,animationComposition:anim-comp,animationFillMode:anim-fm,animationDirection:anim-dir,animationIterationCount:anim-ic,animationRange:anim-r,animationState:anim-s,animationRangeStart:anim-rs,animationRangeEnd:anim-re,animationTimeline:anim-tl,transformOrigin:trf-o,transformBox:trf-b,transformStyle:trf-s,transform:trf,rotate:rotate,rotateX:rotate-x,rotateY:rotate-y,rotateZ:rotate-z,scale:scale,scaleX:scale-x,scaleY:scale-y,translate:translate,translateX:translate-x/x,translateY:translate-y/y,translateZ:translate-z/z,accentColor:ac-c,caretColor:ca-c,scrollBehavior:scr-bhv,scrollbar:scr-bar,scrollbarColor:scr-bar-c,scrollbarGutter:scr-bar-g,scrollbarWidth:scr-bar-w,scrollMargin:scr-m,scrollMarginLeft:scr-ml,scrollMarginRight:scr-mr,scrollMarginTop:scr-mt,scrollMarginBottom:scr-mb,scrollMarginBlock:scr-my/scrollMarginY,scrollMarginBlockEnd:scr-mbe,scrollMarginBlockStart:scr-mbt,scrollMarginInline:scr-mx/scrollMarginX,scrollMarginInlineEnd:scr-me,scrollMarginInlineStart:scr-ms,scrollPadding:scr-p,scrollPaddingBlock:scr-py/scrollPaddingY,scrollPaddingBlockStart:scr-pbs,scrollPaddingBlockEnd:scr-pbe,scrollPaddingInline:scr-px/scrollPaddingX,scrollPaddingInlineEnd:scr-pe,scrollPaddingInlineStart:scr-ps,scrollPaddingLeft:scr-pl,scrollPaddingRight:scr-pr,scrollPaddingTop:scr-pt,scrollPaddingBottom:scr-pb,scrollSnapAlign:scr-sa,scrollSnapStop:scrs-s,scrollSnapType:scrs-t,scrollSnapStrictness:scrs-strt,scrollSnapMargin:scrs-m,scrollSnapMarginTop:scrs-mt,scrollSnapMarginBottom:scrs-mb,scrollSnapMarginLeft:scrs-ml,scrollSnapMarginRight:scrs-mr,scrollSnapCoordinate:scrs-c,scrollSnapDestination:scrs-d,scrollSnapPointsX:scrs-px,scrollSnapPointsY:scrs-py,scrollSnapTypeX:scrs-tx,scrollSnapTypeY:scrs-ty,scrollTimeline:scrtl,scrollTimelineAxis:scrtl-a,scrollTimelineName:scrtl-n,touchAction:tch-a,userSelect:us,overflow:ov,overflowWrap:ov-wrap,overflowX:ov-x,overflowY:ov-y,overflowAnchor:ov-a,overflowBlock:ov-b,overflowInline:ov-i,overflowClipBox:ovcp-bx,overflowClipMargin:ovcp-m,overscrollBehaviorBlock:ovs-bb,overscrollBehaviorInline:ovs-bi,fill:fill,stroke:stk,strokeWidth:stk-w,strokeDasharray:stk-dsh,strokeDashoffset:stk-do,strokeLinecap:stk-lc,strokeLinejoin:stk-lj,strokeMiterlimit:stk-ml,strokeOpacity:stk-op,srOnly:sr,debug:debug,appearance:ap,backfaceVisibility:bfv,clipPath:cp-path,hyphens:hy,mask:msk,maskImage:msk-i,maskSize:msk-s,textSizeAdjust:txt-adj,container:cq,containerName:cq-n,containerType:cq-t,cursor:cursor,textStyle:textStyle,layerStyle:layerStyle,animationStyle:animationStyle",Jr=new Map,el=new Map;ap.split(",").forEach(e=>{const[t,n]=e.split(":"),[i,...a]=n.split("/");Jr.set(t,i),a.length&&a.forEach(s=>{el.set(s==="1"?i:s,t)})});const Ga=e=>el.get(e)||e,tl={conditions:{shift:Qr,finalize:Ur,breakpoints:{keys:["base","xs","sm","md","lg","xl"]}},utility:{transform:(e,t)=>{const n=Ga(e);return{className:`${Jr.get(n)||Hu(n)}_${na(t)}`}},hasShorthand:!0,toHash:(e,t)=>t(e.join(":")),resolveShorthand:Ga}},sp=Gr(tl),x=(...e)=>sp(kt(...e));x.raw=(...e)=>kt(...e);const{mergeCss:kt}=Vu(tl);function S(){let e="",t=0,n;for(;t<arguments.length;)(n=arguments[t++])&&typeof n=="string"&&(e&&(e+=" "),e+=n);return e}const Za=e=>({base:{},variants:{},defaultVariants:{},compoundVariants:[],...e});function vn(e){const{base:t,variants:n,defaultVariants:i,compoundVariants:a}=Za(e),s=g=>({...i,...Nt(g)});function r(g={}){const f=s(g);let y={...t};for(const[C,k]of Object.entries(f))n[C]?.[k]&&(y=kt(y,n[C][k]));const b=ji(a,f);return kt(y,b)}function l(g){const f=Za(g.config),y=vi(g.variantKeys,Object.keys(n));return vn({base:kt(t,f.base),variants:Object.fromEntries(y.map(b=>[b,kt(n[b],f.variants[b])])),defaultVariants:oa(i,f.defaultVariants),compoundVariants:[...a,...f.compoundVariants]})}function d(g){return x(r(g))}const c=Object.keys(n);function u(g){return ce(g,c)}const p=Object.fromEntries(Object.entries(n).map(([g,f])=>[g,Object.keys(f)]));return Object.assign(ge(d),{__cva__:!0,variantMap:p,variantKeys:c,raw:r,config:e,merge:l,splitVariantProps:u,getVariantProps:s})}function ji(e,t){let n={};return e.forEach(i=>{Object.entries(i).every(([a,s])=>a==="css"?!0:(Array.isArray(s)?s:[s]).some(r=>t[a]===r))&&(n=kt(n,i.css))}),n}function rp(e,t,n,i){if(t.length>0&&typeof n?.[i]=="object")throw new Error(`[recipe:${e}:${i}] Conditions are not supported when using compound variants.`)}function lp(e){const t=Object.entries(Ju(e)).map(([p,g])=>[p,vn(g)]),n=e.defaultVariants??{},i=t.reduce((p,[g,f])=>(e.className&&(p[g]=f.config.className),p),{});function a(p){const g=t.map(([f,y])=>[f,S(y(p),i[f])]);return Object.fromEntries(g)}function s(p){const g=t.map(([f,y])=>[f,y.raw(p)]);return Object.fromEntries(g)}const r=e.variants??{},l=Object.keys(r);function d(p){return ce(p,l)}const c=p=>({...n,...Nt(p)}),u=Object.fromEntries(Object.entries(r).map(([p,g])=>[p,Object.keys(g)]));return Object.assign(ge(a),{__cva__:!1,raw:s,config:e,variantMap:u,variantKeys:l,classNameMap:i,splitVariantProps:d,getVariantProps:c})}/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var dp={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=(e,t,n,i)=>{const a=m.forwardRef(({color:s="currentColor",size:r=24,stroke:l=2,title:d,className:c,children:u,...p},g)=>m.createElement("svg",{ref:g,...dp[e],width:r,height:r,className:["tabler-icon",`tabler-icon-${t}`,c].join(" "),...e==="filled"?{fill:s}:{strokeWidth:l,stroke:s},...p},[d&&m.createElement("title",{key:"svg-title"},d),...i.map(([f,y])=>m.createElement(f,y)),...Array.isArray(u)?u:[u]]));return a.displayName=`${n}`,a};/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=[["path",{d:"M12 9v4",key:"svg-0"}],["path",{d:"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]],nl=R("outline","alert-triangle","AlertTriangle",cp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M17 8l0 9l-9 0",key:"svg-1"}]],pp=R("outline","arrow-down-right","ArrowDownRight",up);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const gp=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M5 12l6 6",key:"svg-1"}],["path",{d:"M5 12l6 -6",key:"svg-2"}]],hp=R("outline","arrow-left","ArrowLeft",gp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const mp=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],Xt=R("outline","arrow-right","ArrowRight",mp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const fp=[["path",{d:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11",key:"svg-0"}]],xp=R("outline","bolt","Bolt",fp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const yp=[["path",{d:"M4 8h16",key:"svg-0"}],["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-1"}],["path",{d:"M8 4v4",key:"svg-2"}]],bp=R("outline","browser","Browser",yp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const wp=[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]],ol=R("outline","check","Check",wp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const vp=[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]],kp=R("outline","chevron-down","ChevronDown",vp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=[["path",{d:"M15 6l-6 6l6 6",key:"svg-0"}]],il=R("outline","chevron-left","ChevronLeft",jp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cp=[["path",{d:"M9 6l6 6l-6 6",key:"svg-0"}]],It=R("outline","chevron-right","ChevronRight",Cp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sp=[["path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-0"}],["path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-1"}]],_p=R("outline","copy","Copy",Sp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pp=[["path",{d:"M12 6m-7 0a7 3 0 1 0 14 0a7 3 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M5 6v12c0 1.657 3.134 3 7 3s7 -1.343 7 -3v-12",key:"svg-1"}]],Ka=R("outline","cylinder","Cylinder",Pp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mp=[["path",{d:"M6 5a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2v-14z",key:"svg-0"}],["path",{d:"M11 4h2",key:"svg-1"}],["path",{d:"M12 17v.01",key:"svg-2"}]],Ep=R("outline","device-mobile","DeviceMobile",Mp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Np=[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]],al=R("outline","external-link","ExternalLink",Np);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ip=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M10 13l-1 2l1 2",key:"svg-2"}],["path",{d:"M14 13l1 2l-1 2",key:"svg-3"}]],Kb=R("outline","file-code","FileCode",Ip);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rp=[["path",{d:"M4 21v-4a3 3 0 0 1 3 -3h5",key:"svg-0"}],["path",{d:"M9 17l3 -3l-3 -3",key:"svg-1"}],["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-2"}],["path",{d:"M5 11v-6a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-9.5",key:"svg-3"}]],Ut=R("outline","file-symlink","FileSymlink",Rp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dp=[["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2",key:"svg-1"}],["path",{d:"M4 16v2a2 2 0 0 0 2 2h2",key:"svg-2"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"svg-3"}],["path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2",key:"svg-4"}]],Bp=R("outline","focus-centered","FocusCentered",Dp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tp=[["path",{d:"M5 19l2.757 -7.351a1 1 0 0 1 .936 -.649h12.307a1 1 0 0 1 .986 1.164l-.996 5.211a2 2 0 0 1 -1.964 1.625h-14.026a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v2",key:"svg-0"}]],Ub=R("outline","folder-open","FolderOpen",Tp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lp=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 16v.01",key:"svg-1"}],["path",{d:"M12 13a2 2 0 0 0 .914 -3.782a1.98 1.98 0 0 0 -2.414 .483",key:"svg-2"}]],Ap=R("outline","help-circle","HelpCircle",Lp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=[["path",{d:"M3 4m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v10a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z",key:"svg-0"}],["path",{d:"M9 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M15 8l2 0",key:"svg-2"}],["path",{d:"M15 12l2 0",key:"svg-3"}],["path",{d:"M7 16l10 0",key:"svg-4"}]],sa=R("outline","id","Id",zp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const $p=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 9h.01",key:"svg-1"}],["path",{d:"M11 12h1v4h1",key:"svg-2"}]],ra=R("outline","info-circle","InfoCircle",$p);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fp=[["path",{d:"M4 20l16 0",key:"svg-0"}],["path",{d:"M9 4m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}]],Vp=R("outline","layout-align-bottom","LayoutAlignBottom",Fp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Op=[["path",{d:"M12 4l0 5",key:"svg-0"}],["path",{d:"M12 15l0 5",key:"svg-1"}],["path",{d:"M6 9m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z",key:"svg-2"}]],Wp=R("outline","layout-align-center","LayoutAlignCenter",Op);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hp=[["path",{d:"M4 4l0 16",key:"svg-0"}],["path",{d:"M8 9m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z",key:"svg-1"}]],qp=R("outline","layout-align-left","LayoutAlignLeft",Hp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xp=[["path",{d:"M4 12l5 0",key:"svg-0"}],["path",{d:"M15 12l5 0",key:"svg-1"}],["path",{d:"M9 6m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-2"}]],Yp=R("outline","layout-align-middle","LayoutAlignMiddle",Xp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gp=[["path",{d:"M20 4l0 16",key:"svg-0"}],["path",{d:"M4 9m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z",key:"svg-1"}]],Zp=R("outline","layout-align-right","LayoutAlignRight",Gp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kp=[["path",{d:"M4 4l16 0",key:"svg-0"}],["path",{d:"M9 8m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}]],Up=R("outline","layout-align-top","LayoutAlignTop",Kp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qp=[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M4 12h8",key:"svg-1"}],["path",{d:"M12 15h8",key:"svg-2"}],["path",{d:"M12 9h8",key:"svg-3"}],["path",{d:"M12 4v16",key:"svg-4"}]],Ua=R("outline","layout-board-split","LayoutBoardSplit",Qp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jp=[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M10 4l4 16",key:"svg-1"}],["path",{d:"M12 12l-8 2",key:"svg-2"}]],eg=R("outline","layout-collage","LayoutCollage",Jp);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const tg=[["path",{d:"M5 4h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-6a1 1 0 0 1 1 -1",key:"svg-0"}],["path",{d:"M5 16h4a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-2a1 1 0 0 1 1 -1",key:"svg-1"}],["path",{d:"M15 12h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-6a1 1 0 0 1 1 -1",key:"svg-2"}],["path",{d:"M15 4h4a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-2a1 1 0 0 1 1 -1",key:"svg-3"}]],ng=R("outline","layout-dashboard","LayoutDashboard",tg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],ig=R("outline","link","Link",og);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=[["path",{d:"M3 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M13 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]],sg=R("outline","lock-open-2","LockOpen2",ag);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const rg=[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]],lg=R("outline","lock","Lock",rg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}],["path",{d:"M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2",key:"svg-1"}],["path",{d:"M19 11h2m-1 -1v2",key:"svg-2"}]],Qb=R("outline","moon-stars","MoonStars",dg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const cg=[["path",{d:"M21 14.008v-5.018a1.98 1.98 0 0 0 -1 -1.717l-4 -2.008a2.016 2.016 0 0 0 -2 0l-10 5.008c-.619 .355 -1 1.01 -1 1.718v5.018c0 .709 .381 1.363 1 1.717l4 2.008a2.016 2.016 0 0 0 2 0l10 -5.008c.619 -.355 1 -1.01 1 -1.718z",key:"svg-0"}],["path",{d:"M9 21v-7.5",key:"svg-1"}],["path",{d:"M9 13.5l11.5 -5.5",key:"svg-2"}],["path",{d:"M3.5 11l5.5 2.5",key:"svg-3"}]],ug=R("outline","rectangular-prism","RectangularPrism",cg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const pg=[["path",{d:"M3 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M17 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M5 11v-3a3 3 0 0 1 3 -3h8a3 3 0 0 1 3 3v3",key:"svg-3"}],["path",{d:"M16.5 8.5l2.5 2.5l2.5 -2.5",key:"svg-4"}]],gg=R("outline","reorder","Reorder",pg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=[["path",{d:"M6 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M18 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M12 19h4.5c.71 0 1.372 -.212 1.924 -.576m1.545 -2.459a3.5 3.5 0 0 0 -3.469 -3.965h-.499m-4 0h-3.501a3.5 3.5 0 0 1 -2.477 -5.972m2.477 -1.028h3.5",key:"svg-2"}],["path",{d:"M3 3l18 18",key:"svg-3"}]],mg=R("outline","route-off","RouteOff",hg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const fg=[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]],la=R("outline","search","Search",fg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const xg=[["path",{d:"M8 9l4 -4l4 4",key:"svg-0"}],["path",{d:"M16 15l-4 4l-4 -4",key:"svg-1"}]],da=R("outline","selector","Selector",xg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=[["path",{d:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-1"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-2"}],["path",{d:"M8.7 10.7l6.6 -3.4",key:"svg-3"}],["path",{d:"M8.7 13.3l6.6 3.4",key:"svg-4"}]],Jb=R("outline","share","Share",yg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const bg=[["path",{d:"M12 4l-8 4l8 4l8 -4l-8 -4",key:"svg-0"}],["path",{d:"M4 12l8 4l8 -4",key:"svg-1"}],["path",{d:"M4 16l8 4l8 -4",key:"svg-2"}]],ca=R("outline","stack-2","Stack2",bg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],ew=R("outline","sun","Sun",wg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const vg=[["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 12m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0",key:"svg-1"}],["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-2"}]],kg=R("outline","target","Target",vg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=[["path",{d:"M3 6a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-0"}],["path",{d:"M21 11v-3a2 2 0 0 0 -2 -2h-6l3 3m0 -6l-3 3",key:"svg-1"}],["path",{d:"M3 13v3a2 2 0 0 0 2 2h6l-3 -3m0 6l3 -3",key:"svg-2"}],["path",{d:"M15 18a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-3"}]],kn=R("outline","transform","Transform",jg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2",key:"svg-1"}]],Sg=R("outline","user","User",Cg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const _g=[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]],jn=R("outline","x","X",_g);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pg=[["path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2",key:"svg-0"}],["path",{d:"M4 16v2a2 2 0 0 0 2 2h2",key:"svg-1"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"svg-2"}],["path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2",key:"svg-3"}],["path",{d:"M8 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-4"}],["path",{d:"M16 16l-2.5 -2.5",key:"svg-5"}]],Ae=R("outline","zoom-scan","ZoomScan",Pg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=[["path",{d:"M10.52 2.614a2.095 2.095 0 0 1 2.835 -.117l.126 .117l7.905 7.905c.777 .777 .816 2.013 .117 2.836l-.117 .126l-7.905 7.905a2.094 2.094 0 0 1 -2.836 .117l-.126 -.117l-7.907 -7.906a2.096 2.096 0 0 1 -.115 -2.835l.117 -.126l7.905 -7.905zm5.969 9.535l.01 -.116l-.003 -.12l-.016 -.114l-.03 -.11l-.044 -.112l-.052 -.098l-.076 -.105l-.07 -.081l-3.5 -3.5l-.095 -.083a1 1 0 0 0 -1.226 0l-.094 .083l-.083 .094a1 1 0 0 0 0 1.226l.083 .094l1.792 1.793h-5.085l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h5.085l-1.792 1.793l-.083 .094a1 1 0 0 0 1.403 1.403l.094 -.083l3.5 -3.5l.097 -.112l.05 -.074l.037 -.067l.05 -.112l.023 -.076l.025 -.117z",key:"svg-0"}]],Eg=R("filled","direction-sign-filled","DirectionSignFilled",Mg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ng=[["path",{d:"M9 3a1 1 0 0 1 .608 .206l.1 .087l2.706 2.707h6.586a3 3 0 0 1 2.995 2.824l.005 .176v8a3 3 0 0 1 -2.824 2.995l-.176 .005h-14a3 3 0 0 1 -2.995 -2.824l-.005 -.176v-11a3 3 0 0 1 2.824 -2.995l.176 -.005h4z",key:"svg-0"}]],Ig=R("filled","folder-filled","FolderFilled",Ng);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=[["path",{d:"M6 4v16a1 1 0 0 0 1.524 .852l13 -8a1 1 0 0 0 0 -1.704l-13 -8a1 1 0 0 0 -1.524 .852z",key:"svg-0"}]],Dg=R("filled","player-play-filled","PlayerPlayFilled",Rg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=[["path",{d:"M19.496 4.136l-12 7a1 1 0 0 0 0 1.728l12 7a1 1 0 0 0 1.504 -.864v-14a1 1 0 0 0 -1.504 -.864z",key:"svg-0"}],["path",{d:"M4 4a1 1 0 0 1 .993 .883l.007 .117v14a1 1 0 0 1 -1.993 .117l-.007 -.117v-14a1 1 0 0 1 1 -1z",key:"svg-1"}]],Tg=R("filled","player-skip-back-filled","PlayerSkipBackFilled",Bg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=[["path",{d:"M3 5v14a1 1 0 0 0 1.504 .864l12 -7a1 1 0 0 0 0 -1.728l-12 -7a1 1 0 0 0 -1.504 .864z",key:"svg-0"}],["path",{d:"M20 4a1 1 0 0 1 .993 .883l.007 .117v14a1 1 0 0 1 -1.993 .117l-.007 -.117v-14a1 1 0 0 1 1 -1z",key:"svg-1"}]],Ag=R("filled","player-skip-forward-filled","PlayerSkipForwardFilled",Lg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const zg=[["path",{d:"M17 4h-10a3 3 0 0 0 -3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3 -3v-10a3 3 0 0 0 -3 -3z",key:"svg-0"}]],$g=R("filled","player-stop-filled","PlayerStopFilled",zg);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fg=[["path",{d:"M8.243 7.34l-6.38 .925l-.113 .023a1 1 0 0 0 -.44 1.684l4.622 4.499l-1.09 6.355l-.013 .11a1 1 0 0 0 1.464 .944l5.706 -3l5.693 3l.1 .046a1 1 0 0 0 1.352 -1.1l-1.091 -6.355l4.624 -4.5l.078 -.085a1 1 0 0 0 -.633 -1.62l-6.38 -.926l-2.852 -5.78a1 1 0 0 0 -1.794 0l-2.853 5.78z",key:"svg-0"}]],Vg=R("filled","star-filled","StarFilled",Fg),Ci=m.createContext(null);function Og({value:e,children:t}){return m.useContext(Ci)?o.jsx(o.Fragment,{children:t}):o.jsx(Ci.Provider,{value:e,children:t})}function Co({element:e,className:t,style:n}){const i=m.useContext(Ci);if(!e||!e.icon||e.icon==="none")return null;let a;return e.icon.startsWith("http://")||e.icon.startsWith("https://")?a=o.jsx("img",{src:e.icon,alt:e.title}):i&&(a=o.jsx(i,{node:e})),a?o.jsx("div",{className:S(t,"likec4-element-icon"),"data-likec4-icon":e.icon,style:n,children:a}):null}const Wg={browser:bp,cylinder:Ka,mobile:Ep,person:Sg,queue:gg,rectangle:ug,storage:Ka};function Hg({element:e,className:t}){const n=o.jsx(Co,{element:e,className:t});if(n)return n;const i=Wg[e.shape];return o.jsx("div",{className:S(t,"likec4-shape-icon"),children:o.jsx(i,{})})}const qg=()=>{},sl=(e,t)=>{if(e===t)return!0;if(e.length!==t.length)return!1;for(const[n,i]of e.entries())if(i!==t[n]&&!le(i,t[n]))return!1;return!0};function So(e,t,n,i){const a=Oc();Wr(a?qg:e,t,sl,i)}function Xg(){return Hi()}function ua(e,t){return ko(B(e),le)}function pa(){return yo()}function Qa(e){return pu(e)}const Yg=e=>Math.round(e.transform[2]*100)/100;function Gg(){return ko(Yg)}const Zg=e=>e.transform[2]<.2;function Kg(){return ko(Zg)}function Ug(){const e=typeof window<"u"&&typeof window.devicePixelRatio=="number"?window.devicePixelRatio:1;return Ve(Math.floor(e),{min:1,max:4})}let An;function Be(e){return An??=Ug(),An<2?Math.round(e):Math.round(e*An)/An}function F(e,t){if(typeof e>"u"||e==null){const n=typeof t=="function"?t():t;throw new Error(n??`Expected defined value, but received ${e}`)}return e}function T(e,t){if(!e)throw new Error(t??"Invariant failed")}function Le(e){throw new Error(`NonExhaustive value: ${e}`)}function Qg(e,t){return e===t?0:nt(e)?nt(t)?Mr(e,t):1:nt(t)?-1:0}function Jg(e=".",t=!1){return(n,i)=>{if(n===i)return 0;if(!n)return-1;if(!i)return 1;const a=n.split(e),s=i.split(e),r=Math.min(a.length,s.length);for(let d=0;d<r;d++){const c=a[d],u=s[d],p=Mr(c,u);if(p!==0)return p}const l=a.length-s.length;return t?-1*l:l}}function eh(e){return e!=null&&typeof e=="string"}function ga(e){const t=e.lastIndexOf(".");return t>0?e.slice(t+1):e}const cn=e=>eh(e)?e:e.id;function pt(e,t){const n=cn(e);return t?cn(t).startsWith(n+"."):i=>{const a=cn(i);return n.startsWith(a+".")}}function rl(e,t){if(!t)return a=>rl(e,a);const n=cn(e),i=cn(t);return n===i||i.startsWith(n+".")||n.startsWith(i+".")}function ll(e,t){return n=>pt(e,n)}function th(e){const t=e.split(".");return t.pop(),t.length===0?[]:t.reduce((n,i,a)=>a===0?(n.push(i),n):(n.unshift(`${n[0]}.${i}`),n),[])}function nh(e,t){let n=t;for(const i of e)pt(i,n)&&(n=i);return n!==t?n:null}function Yt(e){const t=[],n=[...e];let i;for(;i=n.shift();){let a;for(;a=nh(n,i);)t.push(n.splice(n.indexOf(a),1)[0]);t.push(i)}return t}function Vt(e,t){const n=t??e;T(gt(n));function*i(a){for(const s of a)n(s)&&(yield s)}return t?i(e):i}function ro(e,t){const n=t??e;T(gt(n));function i(a){for(const s of a)if(n(s))return s}return t?i(e):i}function oh(e,t){const n=e;T(n>=0,"Count must be a non-negative number");function*i(a){let s=0;for(const r of a){if(s>=n)break;yield r,s++}}return a=>i(a)}function ih(e,t){const n=e;T(gt(n));function*i(a){for(const s of a)yield n(s)}return i}function ah(e,t){const n=t??e;T(gt(n));function i(a){for(const s of a)if(n(s))return!0;return!1}return t?i(e):i}function mn(e){return e?Array.from(e):t=>Array.from(t)}function sh(e){return e?new Set(e):t=>new Set(t)}function un(e,t,n){const i=typeof t=="symbol"?t:Symbol.for(t);return e.hasOwnProperty(i)||Object.defineProperty(e,i,{enumerable:!1,writable:!1,value:n()}),e[i]}const rh="LIKEC4_DELAY";function lh(...e){let t=100;return e.length===2?t=vc(e[0],e[1]):e.length===1&&(t=e[0]),new Promise(n=>{setTimeout(()=>{n(rh)},t??100)})}function dh(...e){let t=new Set;for(const n of e)for(const i of n)t.add(i);return t}function Si(e,...t){let n=new Set;if(e.size===0)return n;let i=de(t,2)?Wc.intersection(...t):t[0];if(i.size===0)return n;for(const a of e)i.has(a)&&n.add(a);return n}function ch(e,t){if(e.size===0)return new Set;if(t.size===0)return new Set(e);let n=new Set;for(const i of e)t.has(i)||n.add(i);return n}function uh(e,t){return e.size===t.size&&[...e].every(n=>t.has(n))}function ph(e){let t=5381;const n=e.length;T(n>0,"stringHash: empty string");for(let i=0;i<n;i++)t=t*33^e.charCodeAt(i);return(t>>>0).toString(36)}function gh(){return bu().use(wu).use(vu).use(ku,{allowDangerousHtml:!0,clobberPrefix:"",tableCellPadding:!1,tight:!0}).use(ju).use(Cu).use(Su,{closeSelfClosing:!0,tightSelfClosing:!0})}function hh(e){return String(gh().processSync(e.trim())).trim()}function mh(e){return xu(yu(e),{includeHtml:!1,includeImageAlt:!1})}const Ja={fill:"#3b82f6",stroke:"#2563eb",hiContrast:"#eff6ff",loContrast:"#bfdbfe"},es={fill:"#0284c7",stroke:"#0369a1",hiContrast:"#f0f9ff",loContrast:"#B6ECF7"},ts={fill:"#64748b",stroke:"#475569",hiContrast:"#f8fafc",loContrast:"#cbd5e1"},fh={primary:Ja,blue:Ja,secondary:es,sky:es,muted:ts,slate:ts,gray:{fill:"#737373",stroke:"#525252",hiContrast:"#fafafa",loContrast:"#d4d4d4"},red:{fill:"#AC4D39",stroke:"#853A2D",hiContrast:"#FBD3CB",loContrast:"#f5b2a3"},green:{fill:"#428a4f",stroke:"#2d5d39",hiContrast:"#f8fafc",loContrast:"#c2f0c2"},amber:{fill:"#A35829",stroke:"#7E451D",hiContrast:"#FFE0C2",loContrast:"#f9b27c"},indigo:{fill:"#6366f1",stroke:"#4f46e5",hiContrast:"#eef2ff",loContrast:"#c7d2fe"}},xh={line:"#6E6E6E",labelBg:"#18191b",label:"#C6C6C6"},ns={line:"#64748b",labelBg:"#0f172a",label:"#cbd5e1"},os={line:"#3b82f6",labelBg:"#172554",label:"#60a5fa"},is={line:"#0ea5e9",labelBg:"#082f49",label:"#38bdf8"},yh={amber:{line:"#b45309",labelBg:"#78350f",label:"#FFE0C2"},blue:os,gray:xh,green:{line:"#15803d",labelBg:"#052e16",label:"#22c55e"},indigo:{line:"#6366f1",labelBg:"#1e1b4b",label:"#818cf8"},muted:ns,primary:os,red:{line:"#AC4D39",labelBg:"#b91c1c",label:"#f5b2a3"},secondary:is,sky:is,slate:ns},as=60,ss=2,rs=1;function bh(e){T(ln.valid(e),`Invalid color: ${e}`);const t=Sc(e),n=t[6],i=wh(n);return{elements:{fill:n,stroke:t[7],hiContrast:i[0],loContrast:i[1]},relationships:{line:t[4],label:t[3],labelBg:t[9]}}}function wh(e){const t=ln(e);let n=t.brighten(ss),i=t.darken(ss),a,s,r,l;do a=n,s=i,n=n.brighten(rs),i=i.darken(rs),r=ln.contrastAPCA(t,n),l=ln.contrastAPCA(t,i);while(Math.abs(r)<as&&Math.abs(l)<as&&(!gi(n,a)||!gi(i,s)));return Math.abs(r)>Math.abs(l)?[n.brighten(.4).hex(),n.hex()]:[i.darken(.4).hex(),i.hex()]}const vh=["rectangle","person","browser","mobile","cylinder","storage","queue"],kh=["amber","blue","gray","slate","green","indigo","muted","primary","red","secondary","sky"],jh={colors:Fd(kh,e=>({elements:fh[e],relationships:yh[e]})),sizes:{xs:{width:180,height:100},sm:{width:240,height:135},md:{width:320,height:180},lg:{width:420,height:234},xl:{width:520,height:290}},spacing:{xs:8,sm:10,md:16,lg:24,xl:32},textSizes:{xs:13.33,sm:16,md:19.2,lg:23.04,xl:27.65}};function dl(e){return Tc(e,t=>t===void 0)}const At="@group";function _o(e){return e.startsWith("step-")}function Ch(e){if(!_o(e))throw new Error(`Invalid step edge id: ${e}`);return parseFloat(e.slice(5))}var ct;(e=>{function t({x:l,y:d,width:c,height:u}){return{x:l+c/2,y:d+u/2}}e.center=t;function n(l){const{x1:d,y1:c,x2:u,y2:p}=_i.fromPoints(l);return{x:d,y:c,width:u-d,height:p-c}}e.fromPoints=n;function i(...l){if(T(de(l,1),"No boxes provided"),l.length===1)return l[0];let d=1/0,c=1/0,u=-1/0,p=-1/0;for(const g of l)d=Math.min(d,g.x),c=Math.min(c,g.y),u=Math.max(u,g.x+g.width),p=Math.max(p,g.y+g.height);return{x:d,y:c,width:u-d,height:p-c}}e.merge=i;function a(l){return{x1:l.x,y1:l.y,x2:l.x+l.width,y2:l.y+l.height}}e.toRectBox=a;function s(l,d){return d===0?l:{x:l.x-d,y:l.y-d,width:l.width+d*2,height:l.height+d*2}}e.expand=s;function r(l,d){return d===0?l:{x:l.x+d,y:l.y+d,width:l.width-d*2,height:l.height-d*2}}e.shrink=r})(ct||(ct={}));var _i;(e=>{function t({x1:s,y1:r,x2:l,y2:d}){return{x:(s+l)/2,y:(r+d)/2}}e.center=t;function n(s){T(s.length>0,"At least one point is required");let r=1/0,l=1/0,d=-1/0,c=-1/0;for(const[u,p]of s)r=Math.min(r,u),l=Math.min(l,p),d=Math.max(d,u),c=Math.max(c,p);return{x1:r,y1:l,x2:d,y2:c}}e.fromPoints=n;function i(...s){T(s.length>0,"No boxes provided");let r=1/0,l=1/0,d=-1/0,c=-1/0;for(const u of s)r=Math.min(r,u.x1),l=Math.min(l,u.y1),d=Math.max(d,u.x2),c=Math.max(c,u.y2);return{x1:r,y1:l,x2:d,y2:c}}e.merge=i;function a(s){return{x:s.x1,y:s.y1,width:s.x2-s.x1,height:s.y2-s.y1}}e.toBBox=a})(_i||(_i={}));function Po({size:e,padding:t,textSize:n,...i},a=Pi.defaults.size){return e??=a,n??=e,t??=e,{...i,size:e,padding:t,textSize:n}}function cl(e){const t=typeof e=="string"?e:e.color;return t.startsWith("#")||t.startsWith("rgb")}function Sh(e){return"tag"in e}function _h(e){return"kind"in e}function Ph(e){return"participant"in e}function Mh(e){return"not"in e}function Eh(e){return"and"in e}function Nh(e){return"or"in e}function sn(e){switch(!0){case Ph(e):{const t=e.participant,n=sn(e.operator);return Ih(t,n)}case Sh(e):{if(nt(e.tag)||"eq"in e.tag){const n=nt(e.tag)?e.tag:e.tag.eq;return i=>Array.isArray(i.tags)&&i.tags.includes(n)}const t=e.tag.neq;return n=>!Array.isArray(n.tags)||!n.tags.includes(t)}case _h(e):{if(nt(e.kind)||"eq"in e.kind){const n=nt(e.kind)?e.kind:e.kind.eq;return i=>i.kind===n}const t=e.kind.neq;return n=>Ki(n.kind)||n.kind!==t}case Mh(e):{const t=sn(e.not);return qr(t)}case Eh(e):{const t=e.and.map(sn);return hu(t)}case Nh(e):{const t=e.or.map(sn);return gu(t)}default:Le(e)}}function Ih(e,t){return n=>{if(!n.source||!n.target)return!1;switch(e){case"source":return t(n.source);case"target":return t(n.target)}}}function Yo(e){return _o(e)&&e.includes(".")?e.slice(0,e.indexOf(".")+1):null}const Rh=Symbol.for("text"),Dh=Symbol.for("html"),Ze="";class te{static _cache=new WeakMap;static memoize(t,n,i){return un(t,n,()=>te.from(i))}static from(t){if(t==null||t===te.EMPTY)return te.EMPTY;if(t instanceof te)return t;if(typeof t=="string")return t.trim()===Ze?te.EMPTY:new te({txt:t});if("isEmpty"in t&&t.isEmpty||"md"in t&&t.md.trim()===Ze||"txt"in t&&t.txt.trim()===Ze)return te.EMPTY;const n=t,i=te._cache.get(n);if(i)return i;const a=new te(n);return te._cache.set(n,a),a}static EMPTY=new class extends te{isEmpty=!0;nonEmpty=!1;isMarkdown=!1;$source=null;constructor(){super({txt:Ze})}get text(){return null}get md(){return null}get html(){return null}};$source;isEmpty;nonEmpty;isMarkdown;constructor(t){this.isMarkdown=!1,typeof t=="string"?(this.$source={txt:t},this.isEmpty=t.trim()===Ze):(this.$source=t,this.isEmpty=!0,"md"in t?(this.isEmpty=t.md===Ze,this.isMarkdown=!0):this.isEmpty=t.txt===Ze),this.nonEmpty=!this.isEmpty}get text(){if(this.isEmpty||this.$source===null)return Ze;const t=this.$source;return"txt"in t?t.txt:un(this,Rh,()=>mh(t.md))}get md(){if(this.isEmpty||this.$source===null)return Ze;const t=this.$source;if("md"in t)return t.md;if("txt"in t)return t.txt;Le(t)}get html(){if(this.isEmpty||this.$source===null)return Ze;const t=this.$source;return"txt"in t?t.txt:un(this,Dh,()=>hh(t.md))}equals(t){return this===t?!0:t instanceof te?this.isEmpty&&t.isEmpty?!0:this.isEmpty!==t.isEmpty||this.isMarkdown!==t.isMarkdown?!1:this.isMarkdown?this.$source?.md===t.$source?.md:this.$source?.txt===t.$source?.txt:!1}}const Bh={color:"primary",size:"md",opacity:15,shape:"rectangle",group:{opacity:15,border:"dashed"},relationship:{color:"gray",line:"dashed",arrow:"normal"}},Pi={theme:jh,defaults:Bh};let Th=class Mi{constructor(t){this.config=t,this.theme=t.theme,this.defaults=t.defaults}theme;defaults;static DEFAULT=new Mi(Pi);static from(...t){return de(t,1)?new Mi(Vd(...t,Pi)):this.DEFAULT}get elementColors(){return this.theme.colors[this.defaults.color].elements}get relationshipColors(){return this.theme.colors[this.defaults.relationship.color].relationships}get groupColors(){const t=this.defaults.group?.color;return t?un(this,"defaultGroup",()=>({...this.elementColors,...this.theme.colors[t].elements})):this.elementColors}isDefaultColor(t){return t===this.defaults.color}colors(t){if(t??=this.defaults.color,this.isThemeColor(t))return this.theme.colors[t];throw new Error(`Unknown color: ${t}`)}fontSize(t){return t??=this.defaults.text??this.defaults.size,this.theme.textSizes[t]}padding(t){return t??=this.defaults.padding??this.defaults.size,this.theme.spacing[t]}isThemeColor(t){return t in this.theme.colors}nodeSizes(t){const n=Po(t,this.defaults.size);return{sizes:n,values:{sizes:this.theme.sizes[n.size],padding:this.padding(n.padding),textSize:this.fontSize(n.textSize)}}}computeFrom(t){if(this.isThemeColor(t))return this.theme.colors[t];if(!ln.valid(t))throw new Error(`Invalid color value: "${t}"`);return un(this,`compute-${t}`,()=>bh(t))}equals(t){return t===this?!0:gi(this.config,t.config)}};function ul(e){let[t,...n]=e.points;T(t,"start should be defined");const i=[];for(;de(n,3);){const[a,s,r,...l]=n,d=new Ac(t[0],t[1],a[0],a[1],s[0],s[1],r[0],r[1]),c=d.inflections();c.length===0&&c.push(.5),c.forEach(u=>{const{x:p,y:g}=d.get(u);i.push({x:Math.round(p),y:Math.round(g)})}),n=l,t=r}return T(n.length===0,"all points should be consumed"),i}const ls=(e,t)=>Math.abs(e-t)<3.1;function rn(e,t){const[n,i]=bi(e)?e:[e.x,e.y],[a,s]=bi(t)?t:[t.x,t.y];return ls(n,a)&&ls(i,s)}function ie(e){return e.stopPropagation()}function Lh(e){const{width:t,height:n}=it(e);return{x:e.internals.positionAbsolute.x+t/2,y:e.internals.positionAbsolute.y+n/2}}function Ah(e){let[t,...n]=e;T(t,"start should be defined");let i=`M ${t[0]},${t[1]}`;for(;de(n,3);){const[a,s,r,...l]=n;i=i+` C ${a[0]},${a[1]} ${s[0]},${s[1]} ${r[0]},${r[1]}`,n=l}return T(n.length===0,"all points should be consumed"),i}function zh(e){switch(e){case"dots":return Xo.Dots;case"lines":return Xo.Lines;case"cross":return Xo.Cross;default:Le(e)}}function $h({background:e}){return typeof e=="string"?o.jsx(Aa,{variant:zh(e),size:2,gap:20}):o.jsx(Aa,{...e})}const We={Compound:1,Edge:20,Element:20,Max:30},qe=.05,Ei=3,ds={default:"16px",withControls:{top:"50px",left:"16px",right:"16px",bottom:"16px"}},cs=(e,t)=>(e.data.dimmed??!1)===t?e:{...e,data:{...e.data,dimmed:t}};function Fh(e,t){return t!==void 0?cs(e,t):n=>cs(n,e)}const us=(e,t)=>(e.data.hovered??!1)===t?e:{...e,data:{...e.data,hovered:t}};function Vh(e,t){return t!==void 0?us(e,t):n=>us(n,e)}function ps(e,t){return Lc(e.data,t)?e:{...e,data:{...e.data,...t}}}function Oh(e,t){return t!==void 0?ps(e,t):n=>ps(n,e)}const q={setDimmed:Fh,setHovered:Vh,setData:Oh};function ha({nodes:e,edges:t,onEdgesChange:n,onNodesChange:i,className:a,pannable:s=!0,zoomable:r=!0,nodesSelectable:l=!0,nodesDraggable:d=!1,background:c="dots",children:u,colorMode:p,fitViewPadding:g=0,fitView:f=!0,zoomOnDoubleClick:y=!1,onViewportResize:b,onMoveEnd:C,onNodeMouseEnter:k,onNodeMouseLeave:v,onEdgeMouseEnter:M,onEdgeMouseLeave:w,...j}){const _=c!=="transparent"&&c!=="solid",L=Kg(),P=pa(),{colorScheme:V}=mc();return p||(p=V==="auto"?"system":V),o.jsxs(fc,{colorMode:p,nodes:e,edges:t,className:S(c==="transparent"&&"bg-transparent",a),...L&&{"data-likec4-zoom-small":!0},zoomOnPinch:r,zoomOnScroll:!s&&r,...!r&&{zoomActivationKeyCode:null},zoomOnDoubleClick:y,maxZoom:r?Ei:1,minZoom:r?qe:1,fitView:f,fitViewOptions:{minZoom:qe,maxZoom:1,padding:g,includeHiddenNodes:!1},preventScrolling:r||s,defaultMarkerColor:"var(--xy-edge-stroke)",noDragClassName:"nodrag",noPanClassName:"nopan",noWheelClassName:"nowheel",panOnScroll:s,panOnDrag:s,...!s&&{panActivationKeyCode:null,selectionKeyCode:null},elementsSelectable:l,nodesFocusable:d||l,edgesFocusable:!1,nodesDraggable:d,nodeDragThreshold:4,nodeClickDistance:3,paneClickDistance:3,elevateNodesOnSelect:!1,selectNodesOnDrag:!1,onNodesChange:i,onEdgesChange:n,onMoveEnd:B((O,{x:D,y:$,zoom:H})=>{const E=Be(D),N=Be($);(D!==E||$!==N)&&P.setState({transform:[E,N,H]}),C?.(O,{x:E,y:N,zoom:H})}),onNodeMouseEnter:B((O,D)=>{if(k){k(O,D);return}D.data.hovered||i([{id:D.id,type:"replace",item:q.setHovered(D,!0)}])}),onNodeMouseLeave:B((O,D)=>{if(v){v(O,D);return}D.data.hovered&&i([{id:D.id,type:"replace",item:q.setHovered(D,!1)}])}),onEdgeMouseEnter:B((O,D)=>{if(M){M(O,D);return}D.data.hovered||n([{id:D.id,type:"replace",item:q.setHovered(D,!0)}])}),onEdgeMouseLeave:B((O,D)=>{if(w){w(O,D);return}D.data.hovered&&n([{id:D.id,type:"replace",item:q.setHovered(D,!1)}])}),onNodeDoubleClick:ie,onEdgeDoubleClick:ie,...j,children:[_&&o.jsx($h,{background:c}),b&&o.jsx(Hh,{onViewportResize:b}),u]})}const Wh=({width:e,height:t})=>(e||1)*(t||1),Hh=({onViewportResize:e})=>{const t=ko(Wh);return So(e,[t]),null},ma=m.createContext(null);function pl(){const e=m.useContext(ma);if(!e)throw new Error("useRootContainer must be used within a RootContainer");return e}function qh(){return pl().ref}function Xh(){return pl().ref.current}const gl=m.createContext(null);function Yh(){const e=m.useContext(gl);return e===null&&console.warn("ReduceGraphicsMode is not provided"),e??!1}const[Gh,Zh]=gr("PanningAtomSafeCtx is not provided");function Kh({id:e,className:t,reduceGraphics:n=!1,children:i}){const[a,s]=m.useState(!1),r=m.useRef(null),l=m.useRef(null);l.current||(l.current=au(!1)),su(()=>{s(!0)},[]),m.useEffect(()=>l.current?.subscribe(c=>{r.current?.setAttribute("data-likec4-diagram-panning",c?"true":"false")}),[]);const d=m.useMemo(()=>({id:e,ref:r}),[e,r]);return o.jsx(Gh,{value:l.current,children:o.jsx(gl.Provider,{value:n,children:o.jsx("div",{id:e,className:S("likec4-root",t),ref:r,...n&&{"data-likec4-reduced-graphics":!0},children:a&&!!d.ref.current&&o.jsx(ma.Provider,{value:d,children:i})})})})}const hl={onChange:null,onNavigateTo:null,onNodeClick:null,onNodeContextMenu:null,onCanvasContextMenu:null,onEdgeClick:null,onEdgeContextMenu:null,onCanvasClick:null,onCanvasDblClick:null,onBurgerMenuClick:null,onOpenSource:null,onInitialized:null},Ni=$i(hl),ml=m.createContext({...yn(Ni,e=>[e,null]),handlersRef:{current:hl}});function Uh({handlers:e,children:t}){const n=Hr(e),i=Ni.map(s=>gt(e[s])),a=m.useMemo(()=>({...yn(Ni,s=>n.current[s]?[s,(...r)=>n.current[s]?.(...r)]:[s,null]),handlersRef:n}),[n,...i]);return o.jsx(ml.Provider,{value:a,children:t})}function at(){return m.useContext(ml)}const Qh=["Controls","ReadOnly","FocusMode","NavigateTo","ElementDetails","RelationshipDetails","RelationshipBrowser","Search","NavigationButtons","Notations","DynamicViewWalkthrough","EdgeEditing","FitView","Vscode","ElementTags"],fl=yn(Qh,e=>[`enable${e}`,!1]),Ii=m.createContext(fl),Jh=e=>{let{enableReadOnly:t,enableEdgeEditing:n,...i}=e;return t&&(n=!1),{enableReadOnly:t,enableEdgeEditing:n,...i}};function Pt({children:e,features:t,overrides:n}){const i=m.useContext(Ii),[a,s]=m.useState(i);return m.useEffect(()=>{s(r=>{const l=Jh({...i,...t,...n});return le(r,l)?r:l})},[i,t,n]),o.jsx(Ii.Provider,{value:a,children:e})}Pt.Overlays=({children:e})=>o.jsx(Pt,{overrides:{enableControls:!1,enableReadOnly:!0,enableEdgeEditing:!1},children:e});function K(){return m.useContext(Ii)}function em({feature:e,children:t,and:n=!0}){return K()[`enable${e}`]===!0&&n?o.jsx(o.Fragment,{children:t}):null}function xl({children:e}){const t=m.useContext(eu);return m.useEffect(()=>{t||console.warn("LikeC4Diagram must be a child of MantineProvider")},[]),t?o.jsx(o.Fragment,{children:e}):o.jsx(tu,{defaultColorScheme:"auto",children:e})}xl.displayName="EnsureMantine";const tm=({reducedMotion:e="user",children:t})=>{const n=Fi()?.();return o.jsx(nu,{features:ou,strict:!0,children:o.jsx(iu,{reducedMotion:e,...n&&{nonce:n},children:t})})},Mo=m.createContext(null),fa=m.createContext(null);function nm({children:e}){return m.useContext(fa)?o.jsx(o.Fragment,{children:e}):null}function be(){const e=m.useContext(Mo);if(!e)throw new Error("LikeC4Model not found. Make sure you have LikeC4ModelProvider.");return e}function om(){const e=be(),[t,n]=m.useState(e.$data.specification);return m.useEffect(()=>{n(i=>I(i,e.$data.specification)?i:e.$data.specification)},[e]),t}const yl=m.createContext({}),im=["yellow","orange","amber","tomato","red","ruby","crimson","pink","pink","purple","violet","indigo","blue","teal","grass","lime"],am=e=>{const t=e.color;if(cl(e))return`
      --colors-likec4-tag-bg: ${t};
      --colors-likec4-tag-bg-hover: color-mix(in srgb, ${t}, var(--colors-likec4-mix-color) 20%);
    `;if(!im.includes(t))return"";let n="12";return["mint","grass","lime","yellow","amber"].includes(t)&&(n="dark-2"),`
  --colors-likec4-tag-border: var(--colors-${t}-8);
  --colors-likec4-tag-bg: var(--colors-${t}-9);
  --colors-likec4-tag-bg-hover: var(--colors-${t}-10);
  --colors-likec4-tag-text: var(--colors-${t}-${n});
  `};function sm(e,t){return!e||ut(e)?"":re(Ui(e),du(([n,i])=>[`:is(${t} [data-likec4-tag="${n}"]) {`,am(i),"}"]),Dr(`
`))}function rm({children:e,rootSelector:t}){const n=om().tags,i=sm(n,t);return o.jsxs(yl.Provider,{value:n,children:[i!==""&&o.jsx(lm,{stylesheet:i}),e]})}const lm=m.memo(({stylesheet:e})=>{const t=Fi()?.();return o.jsx("style",{"data-likec4-tags":!0,type:"text/css",dangerouslySetInnerHTML:{__html:e},nonce:t})});function dm(e){return m.useContext(yl)[e]??{color:"tomato"}}function cm(){return ea().replace("mantine-","likec4-")}var um="css,pos,insetX,insetY,insetEnd,end,insetStart,start,flexDir,p,pl,pr,pt,pb,py,paddingY,paddingX,px,pe,paddingEnd,ps,paddingStart,ml,mr,mt,mb,m,my,marginY,mx,marginX,me,marginEnd,ms,marginStart,ringWidth,ringColor,ring,ringOffset,w,minW,maxW,h,minH,maxH,textShadowColor,bgPosition,bgPositionX,bgPositionY,bgAttachment,bgClip,bg,bgColor,bgOrigin,bgImage,bgRepeat,bgBlendMode,bgSize,bgGradient,bgLinear,bgRadial,bgConic,rounded,roundedTopLeft,roundedTopRight,roundedBottomRight,roundedBottomLeft,roundedTop,roundedRight,roundedBottom,roundedLeft,roundedStartStart,roundedStartEnd,roundedStart,roundedEndStart,roundedEndEnd,roundedEnd,borderX,borderXWidth,borderXColor,borderY,borderYWidth,borderYColor,borderStart,borderStartWidth,borderStartColor,borderEnd,borderEndWidth,borderEndColor,shadow,shadowColor,x,y,z,scrollMarginY,scrollMarginX,scrollPaddingY,scrollPaddingX,aspectRatio,boxDecorationBreak,zIndex,boxSizing,objectPosition,objectFit,overscrollBehavior,overscrollBehaviorX,overscrollBehaviorY,position,top,left,inset,insetInline,insetBlock,insetBlockEnd,insetBlockStart,insetInlineEnd,insetInlineStart,right,bottom,float,visibility,display,hideFrom,hideBelow,flexBasis,flex,flexDirection,flexGrow,flexShrink,gridTemplateColumns,gridTemplateRows,gridColumn,gridRow,gridColumnStart,gridColumnEnd,gridAutoFlow,gridAutoColumns,gridAutoRows,gap,gridGap,gridRowGap,gridColumnGap,rowGap,columnGap,justifyContent,alignContent,alignItems,alignSelf,padding,paddingLeft,paddingRight,paddingTop,paddingBottom,paddingBlock,paddingBlockEnd,paddingBlockStart,paddingInline,paddingInlineEnd,paddingInlineStart,marginLeft,marginRight,marginTop,marginBottom,margin,marginBlock,marginBlockEnd,marginBlockStart,marginInline,marginInlineEnd,marginInlineStart,spaceX,spaceY,outlineWidth,outlineColor,outline,outlineOffset,focusRing,focusVisibleRing,focusRingColor,focusRingOffset,focusRingWidth,focusRingStyle,divideX,divideY,divideColor,divideStyle,width,inlineSize,minWidth,minInlineSize,maxWidth,maxInlineSize,height,blockSize,minHeight,minBlockSize,maxHeight,maxBlockSize,boxSize,color,fontFamily,fontSize,fontSizeAdjust,fontPalette,fontKerning,fontFeatureSettings,fontWeight,fontSmoothing,fontVariant,fontVariantAlternates,fontVariantCaps,fontVariationSettings,fontVariantNumeric,letterSpacing,lineHeight,textAlign,textDecoration,textDecorationColor,textEmphasisColor,textDecorationStyle,textDecorationThickness,textUnderlineOffset,textTransform,textIndent,textShadow,textOverflow,verticalAlign,wordBreak,textWrap,truncate,lineClamp,listStyleType,listStylePosition,listStyleImage,listStyle,backgroundPosition,backgroundPositionX,backgroundPositionY,backgroundAttachment,backgroundClip,background,backgroundColor,backgroundOrigin,backgroundImage,backgroundRepeat,backgroundBlendMode,backgroundSize,backgroundGradient,backgroundLinear,backgroundRadial,backgroundConic,textGradient,gradientFromPosition,gradientToPosition,gradientFrom,gradientTo,gradientVia,gradientViaPosition,borderRadius,borderTopLeftRadius,borderTopRightRadius,borderBottomRightRadius,borderBottomLeftRadius,borderTopRadius,borderRightRadius,borderBottomRadius,borderLeftRadius,borderStartStartRadius,borderStartEndRadius,borderStartRadius,borderEndStartRadius,borderEndEndRadius,borderEndRadius,border,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,borderBlockStartWidth,borderBlockEndWidth,borderColor,borderInline,borderInlineWidth,borderInlineColor,borderBlock,borderBlockWidth,borderBlockColor,borderLeft,borderLeftColor,borderInlineStart,borderInlineStartWidth,borderInlineStartColor,borderRight,borderRightColor,borderInlineEnd,borderInlineEndWidth,borderInlineEndColor,borderTop,borderTopColor,borderBottom,borderBottomColor,borderBlockEnd,borderBlockEndColor,borderBlockStart,borderBlockStartColor,opacity,boxShadow,boxShadowColor,mixBlendMode,filter,brightness,contrast,grayscale,hueRotate,invert,saturate,sepia,dropShadow,blur,backdropFilter,backdropBlur,backdropBrightness,backdropContrast,backdropGrayscale,backdropHueRotate,backdropInvert,backdropOpacity,backdropSaturate,backdropSepia,borderCollapse,borderSpacing,borderSpacingX,borderSpacingY,tableLayout,transitionTimingFunction,transitionDelay,transitionDuration,transitionProperty,transition,animation,animationName,animationTimingFunction,animationDuration,animationDelay,animationPlayState,animationComposition,animationFillMode,animationDirection,animationIterationCount,animationRange,animationState,animationRangeStart,animationRangeEnd,animationTimeline,transformOrigin,transformBox,transformStyle,transform,rotate,rotateX,rotateY,rotateZ,scale,scaleX,scaleY,translate,translateX,translateY,translateZ,accentColor,caretColor,scrollBehavior,scrollbar,scrollbarColor,scrollbarGutter,scrollbarWidth,scrollMargin,scrollMarginLeft,scrollMarginRight,scrollMarginTop,scrollMarginBottom,scrollMarginBlock,scrollMarginBlockEnd,scrollMarginBlockStart,scrollMarginInline,scrollMarginInlineEnd,scrollMarginInlineStart,scrollPadding,scrollPaddingBlock,scrollPaddingBlockStart,scrollPaddingBlockEnd,scrollPaddingInline,scrollPaddingInlineEnd,scrollPaddingInlineStart,scrollPaddingLeft,scrollPaddingRight,scrollPaddingTop,scrollPaddingBottom,scrollSnapAlign,scrollSnapStop,scrollSnapType,scrollSnapStrictness,scrollSnapMargin,scrollSnapMarginTop,scrollSnapMarginBottom,scrollSnapMarginLeft,scrollSnapMarginRight,scrollSnapCoordinate,scrollSnapDestination,scrollSnapPointsX,scrollSnapPointsY,scrollSnapTypeX,scrollSnapTypeY,scrollTimeline,scrollTimelineAxis,scrollTimelineName,touchAction,userSelect,overflow,overflowWrap,overflowX,overflowY,overflowAnchor,overflowBlock,overflowInline,overflowClipBox,overflowClipMargin,overscrollBehaviorBlock,overscrollBehaviorInline,fill,stroke,strokeWidth,strokeDasharray,strokeDashoffset,strokeLinecap,strokeLinejoin,strokeMiterlimit,strokeOpacity,srOnly,debug,appearance,backfaceVisibility,clipPath,hyphens,mask,maskImage,maskSize,textSizeAdjust,container,containerName,containerType,cursor,colorPalette,_hover,_focus,_focusWithin,_focusVisible,_disabled,_active,_visited,_target,_readOnly,_readWrite,_empty,_checked,_enabled,_expanded,_highlighted,_complete,_incomplete,_dragging,_before,_after,_firstLetter,_firstLine,_marker,_selection,_file,_backdrop,_first,_last,_only,_even,_odd,_firstOfType,_lastOfType,_onlyOfType,_peerFocus,_peerHover,_peerActive,_peerFocusWithin,_peerFocusVisible,_peerDisabled,_peerChecked,_peerInvalid,_peerExpanded,_peerPlaceholderShown,_groupFocus,_groupHover,_groupActive,_groupFocusWithin,_groupFocusVisible,_groupDisabled,_groupChecked,_groupExpanded,_groupInvalid,_indeterminate,_required,_valid,_invalid,_autofill,_inRange,_outOfRange,_placeholder,_placeholderShown,_pressed,_selected,_grabbed,_underValue,_overValue,_atValue,_default,_optional,_open,_closed,_fullscreen,_loading,_hidden,_current,_currentPage,_currentStep,_today,_unavailable,_rangeStart,_rangeEnd,_now,_topmost,_motionReduce,_motionSafe,_print,_landscape,_portrait,_dark,_light,_osDark,_osLight,_highContrast,_lessContrast,_moreContrast,_ltr,_rtl,_scrollbar,_scrollbarThumb,_scrollbarTrack,_horizontal,_vertical,_icon,_starting,_noscript,_invertedColors,_shapeSizeXs,_shapeSizeSm,_shapeSizeMd,_shapeSizeLg,_shapeSizeXl,_shapeRectangle,_shapePerson,_shapeBrowser,_shapeMobile,_shapeCylinder,_shapeStorage,_shapeQueue,_notDisabled,_reduceGraphics,_reduceGraphicsOnPan,_noReduceGraphics,_whenPanning,_smallZoom,_compoundTransparent,_edgeActive,_whenHovered,_whenSelected,_whenDimmed,_whenFocused,_p3,_srgb,_rec2020,xs,xsOnly,xsDown,sm,smOnly,smDown,md,mdOnly,mdDown,lg,lgOnly,lgDown,xl,xlOnly,xlDown,xsToSm,xsToMd,xsToLg,xsToXl,smToMd,smToLg,smToXl,mdToLg,mdToXl,lgToXl,@/xs,@/sm,@/md,@/lg,@likec4-root/xs,@likec4-root/sm,@likec4-root/md,@likec4-root/lg,@likec4-dialog/xs,@likec4-dialog/sm,@likec4-dialog/md,@likec4-dialog/lg,textStyle,layerStyle,animationStyle",pm=um.split(","),gm="WebkitAppearance,WebkitBorderBefore,WebkitBorderBeforeColor,WebkitBorderBeforeStyle,WebkitBorderBeforeWidth,WebkitBoxReflect,WebkitLineClamp,WebkitMask,WebkitMaskAttachment,WebkitMaskClip,WebkitMaskComposite,WebkitMaskImage,WebkitMaskOrigin,WebkitMaskPosition,WebkitMaskPositionX,WebkitMaskPositionY,WebkitMaskRepeat,WebkitMaskRepeatX,WebkitMaskRepeatY,WebkitMaskSize,WebkitOverflowScrolling,WebkitTapHighlightColor,WebkitTextFillColor,WebkitTextStroke,WebkitTextStrokeColor,WebkitTextStrokeWidth,WebkitTouchCallout,WebkitUserModify,WebkitUserSelect,accentColor,alignContent,alignItems,alignSelf,alignTracks,all,anchorName,anchorScope,animation,animationComposition,animationDelay,animationDirection,animationDuration,animationFillMode,animationIterationCount,animationName,animationPlayState,animationRange,animationRangeEnd,animationRangeStart,animationTimeline,animationTimingFunction,appearance,aspectRatio,backdropFilter,backfaceVisibility,background,backgroundAttachment,backgroundBlendMode,backgroundClip,backgroundColor,backgroundImage,backgroundOrigin,backgroundPosition,backgroundPositionX,backgroundPositionY,backgroundRepeat,backgroundSize,blockSize,border,borderBlock,borderBlockColor,borderBlockEnd,borderBlockEndColor,borderBlockEndStyle,borderBlockEndWidth,borderBlockStart,borderBlockStartColor,borderBlockStartStyle,borderBlockStartWidth,borderBlockStyle,borderBlockWidth,borderBottom,borderBottomColor,borderBottomLeftRadius,borderBottomRightRadius,borderBottomStyle,borderBottomWidth,borderCollapse,borderColor,borderEndEndRadius,borderEndStartRadius,borderImage,borderImageOutset,borderImageRepeat,borderImageSlice,borderImageSource,borderImageWidth,borderInline,borderInlineColor,borderInlineEnd,borderInlineEndColor,borderInlineEndStyle,borderInlineEndWidth,borderInlineStart,borderInlineStartColor,borderInlineStartStyle,borderInlineStartWidth,borderInlineStyle,borderInlineWidth,borderLeft,borderLeftColor,borderLeftStyle,borderLeftWidth,borderRadius,borderRight,borderRightColor,borderRightStyle,borderRightWidth,borderSpacing,borderStartEndRadius,borderStartStartRadius,borderStyle,borderTop,borderTopColor,borderTopLeftRadius,borderTopRightRadius,borderTopStyle,borderTopWidth,borderWidth,bottom,boxAlign,boxDecorationBreak,boxDirection,boxFlex,boxFlexGroup,boxLines,boxOrdinalGroup,boxOrient,boxPack,boxShadow,boxSizing,breakAfter,breakBefore,breakInside,captionSide,caret,caretColor,caretShape,clear,clip,clipPath,clipRule,color,colorInterpolationFilters,colorScheme,columnCount,columnFill,columnGap,columnRule,columnRuleColor,columnRuleStyle,columnRuleWidth,columnSpan,columnWidth,columns,contain,containIntrinsicBlockSize,containIntrinsicHeight,containIntrinsicInlineSize,containIntrinsicSize,containIntrinsicWidth,container,containerName,containerType,content,contentVisibility,counterIncrement,counterReset,counterSet,cursor,cx,cy,d,direction,display,dominantBaseline,emptyCells,fieldSizing,fill,fillOpacity,fillRule,filter,flex,flexBasis,flexDirection,flexFlow,flexGrow,flexShrink,flexWrap,float,floodColor,floodOpacity,font,fontFamily,fontFeatureSettings,fontKerning,fontLanguageOverride,fontOpticalSizing,fontPalette,fontSize,fontSizeAdjust,fontSmooth,fontStretch,fontStyle,fontSynthesis,fontSynthesisPosition,fontSynthesisSmallCaps,fontSynthesisStyle,fontSynthesisWeight,fontVariant,fontVariantAlternates,fontVariantCaps,fontVariantEastAsian,fontVariantEmoji,fontVariantLigatures,fontVariantNumeric,fontVariantPosition,fontVariationSettings,fontWeight,forcedColorAdjust,gap,grid,gridArea,gridAutoColumns,gridAutoFlow,gridAutoRows,gridColumn,gridColumnEnd,gridColumnGap,gridColumnStart,gridGap,gridRow,gridRowEnd,gridRowGap,gridRowStart,gridTemplate,gridTemplateAreas,gridTemplateColumns,gridTemplateRows,hangingPunctuation,height,hyphenateCharacter,hyphenateLimitChars,hyphens,imageOrientation,imageRendering,imageResolution,imeMode,initialLetter,initialLetterAlign,inlineSize,inset,insetBlock,insetBlockEnd,insetBlockStart,insetInline,insetInlineEnd,insetInlineStart,interpolateSize,isolation,justifyContent,justifyItems,justifySelf,justifyTracks,left,letterSpacing,lightingColor,lineBreak,lineClamp,lineHeight,lineHeightStep,listStyle,listStyleImage,listStylePosition,listStyleType,margin,marginBlock,marginBlockEnd,marginBlockStart,marginBottom,marginInline,marginInlineEnd,marginInlineStart,marginLeft,marginRight,marginTop,marginTrim,marker,markerEnd,markerMid,markerStart,mask,maskBorder,maskBorderMode,maskBorderOutset,maskBorderRepeat,maskBorderSlice,maskBorderSource,maskBorderWidth,maskClip,maskComposite,maskImage,maskMode,maskOrigin,maskPosition,maskRepeat,maskSize,maskType,masonryAutoFlow,mathDepth,mathShift,mathStyle,maxBlockSize,maxHeight,maxInlineSize,maxLines,maxWidth,minBlockSize,minHeight,minInlineSize,minWidth,mixBlendMode,objectFit,objectPosition,offset,offsetAnchor,offsetDistance,offsetPath,offsetPosition,offsetRotate,opacity,order,orphans,outline,outlineColor,outlineOffset,outlineStyle,outlineWidth,overflow,overflowAnchor,overflowBlock,overflowClipBox,overflowClipMargin,overflowInline,overflowWrap,overflowX,overflowY,overlay,overscrollBehavior,overscrollBehaviorBlock,overscrollBehaviorInline,overscrollBehaviorX,overscrollBehaviorY,padding,paddingBlock,paddingBlockEnd,paddingBlockStart,paddingBottom,paddingInline,paddingInlineEnd,paddingInlineStart,paddingLeft,paddingRight,paddingTop,page,pageBreakAfter,pageBreakBefore,pageBreakInside,paintOrder,perspective,perspectiveOrigin,placeContent,placeItems,placeSelf,pointerEvents,position,positionAnchor,positionArea,positionTry,positionTryFallbacks,positionTryOrder,positionVisibility,printColorAdjust,quotes,r,resize,right,rotate,rowGap,rubyAlign,rubyMerge,rubyPosition,rx,ry,scale,scrollBehavior,scrollMargin,scrollMarginBlock,scrollMarginBlockEnd,scrollMarginBlockStart,scrollMarginBottom,scrollMarginInline,scrollMarginInlineEnd,scrollMarginInlineStart,scrollMarginLeft,scrollMarginRight,scrollMarginTop,scrollPadding,scrollPaddingBlock,scrollPaddingBlockEnd,scrollPaddingBlockStart,scrollPaddingBottom,scrollPaddingInline,scrollPaddingInlineEnd,scrollPaddingInlineStart,scrollPaddingLeft,scrollPaddingRight,scrollPaddingTop,scrollSnapAlign,scrollSnapCoordinate,scrollSnapDestination,scrollSnapPointsX,scrollSnapPointsY,scrollSnapStop,scrollSnapType,scrollSnapTypeX,scrollSnapTypeY,scrollTimeline,scrollTimelineAxis,scrollTimelineName,scrollbarColor,scrollbarGutter,scrollbarWidth,shapeImageThreshold,shapeMargin,shapeOutside,shapeRendering,stopColor,stopOpacity,stroke,strokeDasharray,strokeDashoffset,strokeLinecap,strokeLinejoin,strokeMiterlimit,strokeOpacity,strokeWidth,tabSize,tableLayout,textAlign,textAlignLast,textAnchor,textBox,textBoxEdge,textBoxTrim,textCombineUpright,textDecoration,textDecorationColor,textDecorationLine,textDecorationSkip,textDecorationSkipInk,textDecorationStyle,textDecorationThickness,textEmphasis,textEmphasisColor,textEmphasisPosition,textEmphasisStyle,textIndent,textJustify,textOrientation,textOverflow,textRendering,textShadow,textSizeAdjust,textSpacingTrim,textTransform,textUnderlineOffset,textUnderlinePosition,textWrap,textWrapMode,textWrapStyle,timelineScope,top,touchAction,transform,transformBox,transformOrigin,transformStyle,transition,transitionBehavior,transitionDelay,transitionDuration,transitionProperty,transitionTimingFunction,translate,unicodeBidi,userSelect,vectorEffect,verticalAlign,viewTimeline,viewTimelineAxis,viewTimelineInset,viewTimelineName,viewTransitionName,visibility,whiteSpace,whiteSpaceCollapse,widows,width,willChange,wordBreak,wordSpacing,wordWrap,writingMode,x,y,zIndex,zoom,alignmentBaseline,baselineShift,colorInterpolation,colorRendering,glyphOrientationVertical",hm=gm.split(",").concat(pm),mm=new Map(hm.map(e=>[e,!0])),fm=/&|@/,bl=ge(e=>mm.has(e)||e.startsWith("--")||fm.test(e));const xm=(e,t)=>!t.includes(e)&&!bl(e),ym=(e,t)=>e.__shouldForwardProps__&&t?n=>e.__shouldForwardProps__(n)&&t(n):t,bm=(e,t)=>{if(e&&!t)return e;if(!e&&t)return t;if(e.__cva__&&t.__cva__||e.__recipe__&&t.__recipe__)return e.merge(t);const n=new TypeError("Cannot merge cva with recipe. Please use either cva or recipe.");throw TypeError.captureStackTrace?.(n),n},wm=e=>typeof e=="string"?e:e?.displayName||e?.name||"Component";function Go(e,t={},n={}){const i=t.__cva__||t.__recipe__?t:vn(t),a=n.shouldForwardProp||xm,s=g=>n.forwardProps?.includes(g)?!0:a(g,i.variantKeys),r=Object.assign(n.dataAttr&&t.__name__?{"data-recipe":t.__name__}:{},n.defaultProps),l=bm(e.__cva__,i),d=ym(e,s),c=e.__base__||e,u=m.forwardRef(function(g,f){const{as:y=c,unstyled:b,children:C,...k}=g,v=m.useMemo(()=>Object.assign({},r,k),[k]),[M,w,j,_,L]=m.useMemo(()=>ce(v,ki.keys,d,l.variantKeys,bl),[v]);function P(){const{css:D,...$}=_,H=l.__getCompoundVariantCss__?.(j);return S(l(j,!1),x(H,$,D),v.className)}function V(){const{css:D,...$}=_,H=l.raw(j);return S(x(H,$,D),v.className)}const O=()=>{if(b){const{css:D,...$}=_;return S(x($,D),v.className)}return t.__recipe__?P():V()};return m.createElement(y,{ref:f,...w,...L,...ki(M),className:O()},C??v.children)}),p=wm(c);return u.displayName=`styled.${p}`,u.__cva__=l,u.__base__=c,u.__shouldForwardProps__=s,u}function vm(){const e=new Map;return new Proxy(Go,{apply(t,n,i){return Go(...i)},get(t,n){return e.has(n)||e.set(n,Go(n)),e.get(n)}})}const st=vm(),gs={transform(e){return e}},km=(e={})=>{const t=wn(gs,e);return gs.transform(t,bn)},J=m.forwardRef(function(e,t){const[n,i]=ce(e,[]),a=km(n),s={ref:t,...a,...i};return m.createElement(st.div,s)}),hs={transform(e){const{justify:t,gap:n,...i}=e;return{display:"flex",alignItems:"center",justifyContent:t,gap:n,flexDirection:"column",...i}},defaultValues:{alignItems:"stretch",gap:"sm"}},xa=(e={})=>{const t=wn(hs,e);return hs.transform(t,bn)},Cn=e=>x(xa(e));Cn.raw=xa;const Qt=m.forwardRef(function(e,t){const[n,i]=ce(e,["justify","gap"]),a=xa(n),s={ref:t,...a,...i};return m.createElement(st.div,s)}),ms={transform(e){const{justify:t,gap:n,...i}=e;return{display:"flex",alignItems:"center",justifyContent:t,gap:n,flexDirection:"row",...i}},defaultValues:{gap:"sm"}},ya=(e={})=>{const t=wn(ms,e);return ms.transform(t,bn)},ye=e=>x(ya(e));ye.raw=ya;const ae=m.forwardRef(function(e,t){const[n,i]=ce(e,["justify","gap"]),a=ya(n),s={ref:t,...a,...i};return m.createElement(st.div,s)}),fs={transform(e){return{position:"relative",maxWidth:"8xl",mx:"auto",px:{base:"4",md:"6",lg:"8"},...e}}},wl=(e={})=>{const t=wn(fs,e);return fs.transform(t,bn)},vl=e=>x(wl(e));vl.raw=wl;const xs={transform(e,{map:t,isCssUnit:n,isCssVar:i}){const{inline:a,block:s,...r}=e,l=d=>n(d)||i(d)?d:`token(spacing.${d}, ${d})`;return{"--bleed-x":t(a,l),"--bleed-y":t(s,l),marginInline:"calc(var(--bleed-x, 0) * -1)",marginBlock:"calc(var(--bleed-y, 0) * -1)",...r}},defaultValues:{inline:"0",block:"0"}},kl=(e={})=>{const t=wn(xs,e);return xs.transform(t,bn)},jl=e=>x(kl(e));jl.raw=kl;function ba({error:e,resetErrorBoundary:t}){const n=e instanceof Error?e.message:"Unknown error";return o.jsx(J,{css:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",padding:"0",backdropFilter:"blur(5px)",backgroundColor:{_dark:"[rgb(34 34 34 / 10%)]",_light:"[rgb(15 15 15/ 20%)]"},zIndex:1e3},children:o.jsxs(Br,{icon:o.jsx(jn,{style:{width:16,height:16}}),styles:{icon:{alignSelf:"flex-start"}},color:"red",title:"Oops, something went wrong",p:"xl",withCloseButton:!1,children:[o.jsx(Xe,{maw:"100%",mah:400,children:o.jsx(Tr,{block:!0,children:n})}),o.jsx(oe,{gap:"xs",mt:"xl",children:o.jsx(ke,{color:"gray",size:"xs",variant:"light",onClick:()=>t(),children:"Reset"})})]})})}function Cl(e){return o.jsx(Gi,{FallbackComponent:ba,onError:(t,n)=>{console.error(t,n)},...e})}function Je(e){return{get overlaysActorRef(){return e.get("overlays")??null},get diagramActorRef(){return e.get("diagram")??null},get searchActorRef(){return e.get("search")??null}}}function Ot(e,t){return e.view.nodes.find(n=>n.id===t)??null}function wa(e,t){return e.view.edges.find(n=>n.id===t)??null}function jm(e){const t=new Map,n=e.context.xynodes.reduce((i,a)=>{let s=a.position;if(a.parentId){const d=t.get(a.parentId)??{x:0,y:0};s={x:s.x+d.x,y:s.y+d.y}}if(t.set(a.id,s),a.hidden||a.data.dimmed)return i;const r=a.measured?.width??a.width??a.initialWidth,l=a.measured?.height??a.height??a.initialHeight;return i.minX=Math.min(i.minX,s.x),i.minY=Math.min(i.minY,s.y),i.maxX=Math.max(i.maxX,s.x+r),i.maxY=Math.max(i.maxY,s.y+l),i},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return n.minX===1/0?{bounds:e.context.view.bounds}:{duration:350,bounds:{x:n.minX-10,y:n.minY-10,width:n.maxX-n.minX+20,height:n.maxY-n.minY+20}}}const Cm=32;function Sm(e){const t=F(e.context.activeWalkthrough),n=F(e.context.xyedges.find(d=>d.id===t.stepId)),i=e.context.xystore.getState(),a=F(i.nodeLookup.get(n.source)),s=F(i.nodeLookup.get(n.target)),r=jc([a,s],i);let l;if(t.parallelPrefix){const d=e.context.xynodes.find(c=>c.type==="seq-parallel"&&c.data.parallelPrefix===t.parallelPrefix);d&&(l={x:d.position.x,y:d.position.y,...it(d)})}return l??=_m(n,i),l?l=ct.merge(l,r):l=r,{duration:350,bounds:ct.expand(l,Cm)}}function _m(e,t){const n=t.nodeLookup.get(e.source),i=t.nodeLookup.get(e.target);if(!n||!i)return null;const a=zc({id:e.id,sourceNode:n,targetNode:i,sourceHandle:e.sourceHandle||null,targetHandle:e.targetHandle||null,connectionMode:t.connectionMode});return a?ct.fromPoints([[a.sourceX,a.sourceY],[a.targetX,a.targetY]]):null}const va=m.createContext(null);va.displayName="DiagramActorSafeContext";const Pm=va.Provider,Jt=()=>{const e=m.useContext(va);if(e===null)throw new Error("DiagramActorRef is not provided");return e};function W(){const e=Jt();return m.useMemo(()=>({actor:e,send:t=>e.send(t),navigateTo:(t,n)=>{e.send({type:"navigate.to",viewId:t,...n&&{fromNode:n}})},navigate:t=>{e.send({type:`navigate.${t}`})},fitDiagram:(t=350)=>{e.send({type:"fitDiagram",duration:t})},openRelationshipsBrowser:t=>{e.send({type:"open.relationshipsBrowser",fqn:t})},openSource:t=>{e.send({type:"open.source",...t})},openElementDetails:(t,n)=>{e.send({type:"open.elementDetails",fqn:t,fromNode:n})},openRelationshipDetails:(...t)=>{t.length===1?e.send({type:"open.relationshipDetails",params:{edgeId:t[0]}}):e.send({type:"open.relationshipDetails",params:{source:t[0],target:t[1]}})},updateNodeData:(t,n)=>{e.send({type:"update.nodeData",nodeId:t,data:n})},updateEdgeData:(t,n)=>{e.send({type:"update.edgeData",edgeId:t,data:n})},scheduleSaveManualLayout:()=>{e.send({type:"saveManualLayout.schedule"})},cancelSaveManualLayout:()=>{const t=e.getSnapshot().children.syncLayout?.getSnapshot().value;return e.send({type:"saveManualLayout.cancel"}),t==="pending"||t==="paused"},align:t=>{e.send({type:"layout.align",mode:t})},resetEdgeControlPoints:()=>{e.send({type:"layout.resetEdgeControlPoints"})},focusNode:t=>{e.send({type:"focus.node",nodeId:t})},get currentView(){return e.getSnapshot().context.view},getSnapshot:()=>e.getSnapshot(),getContext:()=>e.getSnapshot().context,findDiagramNode:t=>Ot(e.getSnapshot().context,t),findEdge:t=>e.getSnapshot().context.xyedges.find(n=>n.data.id===t)??null,findDiagramEdge:t=>wa(e.getSnapshot().context,t),startWalkthrough:()=>{e.send({type:"walkthrough.start"})},walkthroughStep:(t="next")=>{e.send({type:"walkthrough.step",direction:t})},stopWalkthrough:()=>{e.send({type:"walkthrough.end"})},toggleFeature:(t,n)=>{e.send({type:"toggle.feature",feature:t,...n!==void 0&&{forceValue:n}})},highlightNotation:(t,n)=>{e.send({type:"notations.highlight",notation:t,...n&&{kind:n}})},unhighlightNotation:()=>{e.send({type:"notations.unhighlight"})},openSearch:t=>{e.send({type:"open.search",...t&&{search:t}})},switchDynamicViewVariant:t=>{e.send({type:"switch.dynamicViewVariant",variant:t})}}),[e])}function Sl(e,t=le){const n=Jt();return ee.useSelector(n,B(e),t)}function Ne(e,t=le,n){const i=Jt(),a=m.useCallback(s=>e(s.context),n??[]);return ee.useSelector(i,a,t)}function $e(e,t){const n=Jt(),i=m.useRef(t);i.current=t,m.useEffect(()=>{const a=n.on(e,s=>{i.current(s)});return()=>{a.unsubscribe()}},[n])}const Mm=e=>e.children.overlays;function _l(){return Sl(Mm,Object.is)}const Em=e=>e.children.search??null;function Nm(){return Sl(Em,Object.is)}function Pl(){const e=m.useContext(fa);if(!e)throw new Error("No LikeC4ViewModel in context found");return e}function en(){const e=Xh();return m.useMemo(()=>e?{portalProps:{target:e},withinPortal:!0}:{withinPortal:!1},[e])}const Im=h.setup({types:{context:{},events:{},tags:"active",input:{},emitted:{}},delays:{"open timeout":500,"close timeout":350},actions:{"update activatedBy":h.assign({activatedBy:({context:e,event:t})=>{switch(!0){case t.type.includes("click"):return"click";case t.type.includes("mouseEnter"):return"hover";default:return e.activatedBy}}}),"keep dropdown open":h.assign({activatedBy:"click"}),"update selected folder":h.assign(({event:e})=>e.type==="breadcrumbs.click.root"?{selectedFolder:""}:(h.assertEvent(e,["breadcrumbs.click.folder","select.folder"]),{selectedFolder:e.folderPath})),"reset selected folder":h.assign({selectedFolder:({context:e})=>e.viewModel.folder.path}),"update inputs":h.assign(({context:e,event:t})=>{h.assertEvent(t,"update.inputs");const n=t.inputs.viewModel.id!==e.viewModel.id;let i=e.selectedFolder;return t.inputs.viewModel.folder.path.startsWith(i)||(i=t.inputs.viewModel.folder.path),{viewModel:t.inputs.viewModel,selectedFolder:i,activatedBy:n?"hover":e.activatedBy}}),"reset search query":h.assign({searchQuery:""}),"update search query":h.assign(({event:e})=>(h.assertEvent(e,"searchQuery.change"),{searchQuery:e.value??""})),"emit navigateTo":h.emit(({event:e})=>(h.assertEvent(e,"select.view"),{type:"navigateTo",viewId:e.viewId}))},guards:{"was opened on hover":({context:e})=>e.activatedBy==="hover","has search query":({context:e})=>!ut(e.searchQuery),"search query is empty":({context:e})=>ut(e.searchQuery)}}).createMachine({id:"breadcrumbs",context:({input:e})=>({...e,breadcrumbs:[],activatedBy:"hover",selectedFolder:"",searchQuery:"",folderColumns:[]}),initial:"idle",entry:["update activatedBy","reset selected folder"],on:{"update.inputs":{actions:"update inputs"},"searchQuery.change":{actions:["update search query",h.raise({type:"searchQuery.changed"})]}},states:{idle:{id:"idle",on:{"breadcrumbs.mouseEnter.*":{target:"pending",actions:"update activatedBy"},"breadcrumbs.click.*":{target:"active",actions:"update activatedBy"}}},pending:{on:{"breadcrumbs.mouseEnter.*":{actions:"update activatedBy"},"breadcrumbs.mouseLeave.*":{target:"idle"},"breadcrumbs.click.*":{target:"active",actions:"update activatedBy"}},after:{"open timeout":{target:"active"}}},active:{tags:["active"],initial:"decide",on:{"dropdown.dismiss":{target:"#idle"},"breadcrumbs.mouseLeave":{guard:"was opened on hover",target:".closing"},"dropdown.mouseLeave":{guard:"was opened on hover",target:".closing"},"searchQuery.changed":{target:".decide"}},states:{decide:{always:[{guard:"has search query",target:"search"},{target:"opened"}]},opened:{on:{"searchQuery.changed":{guard:"has search query",actions:"keep dropdown open",target:"search"},"breadcrumbs.click.viewtitle":{actions:"reset selected folder"},"breadcrumbs.click.*":{actions:"update selected folder"},"select.folder":{actions:["keep dropdown open","update selected folder"]},"select.view":{actions:["emit navigateTo"]}}},search:{on:{"breadcrumbs.click.viewtitle":{actions:["reset search query","reset selected folder"],target:"opened"},"breadcrumbs.click.*":{actions:["reset search query","update selected folder"],target:"opened"},"select.view":{actions:["emit navigateTo"]}}},closing:{on:{"breadcrumbs.mouseEnter.*":{target:"decide"},"dropdown.mouseEnter":{target:"decide"}},after:{"close timeout":{target:"#idle"}}}}}}}),Rm=Im,Ye=(e,t,n)=>{const i=a=>({[e]:"__ignore__",...t,...Nt(a)});return{recipeFn:(a,s=!0)=>{const r=Gr({conditions:{shift:Qr,finalize:Ur,breakpoints:{keys:["base","xs","sm","md","lg","xl"]}},utility:{toHash:(d,c)=>c(d.join(":")),transform:(d,c)=>(rp(e,n,a,d),c==="__ignore__"?{className:e}:(c=na(c),{className:`${e}--${d}_${c}`}))}}),l=i(a);if(s){const d=ji(n,l);return S(r(l),x(d))}return r(l)},getVariantProps:i,__getCompoundVariantCss__:a=>ji(n,i(a))}},rt=(e,t)=>{if(e&&!t)return e;if(!e&&t)return t;const n=(...s)=>S(e(...s),t(...s)),i=vi(e.variantKeys,t.variantKeys),a=i.reduce((s,r)=>(s[r]=vi(e.variantMap[r],t.variantMap[r]),s),{});return Object.assign(n,{__recipe__:!0,__name__:`${e.__name__} ${t.__name__}`,raw:s=>s,variantKeys:i,variantMap:a,splitVariantProps(s){return ce(s,i)}})},Zo=Ye("action-btn",{size:"md",radius:"md",variant:"filled"},[]),Ml={variant:["transparent","filled"],size:["sm","md"],radius:["sm","md"]},ys=Object.keys(Ml),Eo=Object.assign(ge(Zo.recipeFn),{__recipe__:!0,__name__:"actionBtn",__getCompoundVariantCss__:Zo.__getCompoundVariantCss__,raw:e=>e,variantKeys:ys,variantMap:Ml,merge(e){return rt(this,e)},splitVariantProps(e){return ce(e,ys)},getVariantProps:Zo.getVariantProps}),Ko=Ye("likec4-compound-node",{},[]),El={isTransparent:["false","true"],inverseColor:["true","false"],borderStyle:["solid","dashed","dotted","none"]},bs=Object.keys(El),Dm=Object.assign(ge(Ko.recipeFn),{__recipe__:!0,__name__:"compoundNode",__getCompoundVariantCss__:Ko.__getCompoundVariantCss__,raw:e=>e,variantKeys:bs,variantMap:El,merge(e){return rt(this,e)},splitVariantProps(e){return ce(e,bs)},getVariantProps:Ko.getVariantProps}),Uo=Ye("likec4-edge-action-btn",{},[]),Nl={},ws=Object.keys(Nl),Bm=Object.assign(ge(Uo.recipeFn),{__recipe__:!0,__name__:"edgeActionBtn",__getCompoundVariantCss__:Uo.__getCompoundVariantCss__,raw:e=>e,variantKeys:ws,variantMap:Nl,merge(e){return rt(this,e)},splitVariantProps(e){return ce(e,ws)},getVariantProps:Uo.getVariantProps}),Qo=Ye("likec4-element-node-data",{},[]),Il={},vs=Object.keys(Il),Tm=Object.assign(ge(Qo.recipeFn),{__recipe__:!0,__name__:"elementNodeData",__getCompoundVariantCss__:Qo.__getCompoundVariantCss__,raw:e=>e,variantKeys:vs,variantMap:Il,merge(e){return rt(this,e)},splitVariantProps(e){return ce(e,vs)},getVariantProps:Qo.getVariantProps}),Jo=Ye("likec4-element-shape",{},[]),Rl={shapetype:["html","svg"]},ks=Object.keys(Rl),Dl=Object.assign(ge(Jo.recipeFn),{__recipe__:!0,__name__:"elementShapeRecipe",__getCompoundVariantCss__:Jo.__getCompoundVariantCss__,raw:e=>e,variantKeys:ks,variantMap:Rl,merge(e){return rt(this,e)},splitVariantProps(e){return ce(e,ks)},getVariantProps:Jo.getVariantProps}),ei=Ye("likec4-tag",{autoTextColor:!1},[]),Bl={autoTextColor:["false","true"]},js=Object.keys(Bl),Lm=Object.assign(ge(ei.recipeFn),{__recipe__:!0,__name__:"likec4tag",__getCompoundVariantCss__:ei.__getCompoundVariantCss__,raw:e=>e,variantKeys:js,variantMap:Bl,merge(e){return rt(this,e)},splitVariantProps(e){return ce(e,js)},getVariantProps:ei.getVariantProps}),ti=Ye("likec4-markdown-block",{uselikec4palette:!1,value:"markdown"},[]),Tl={uselikec4palette:["true","false"],value:["markdown","plaintext"]},Cs=Object.keys(Tl),Am=Object.assign(ge(ti.recipeFn),{__recipe__:!0,__name__:"markdownBlock",__getCompoundVariantCss__:ti.__getCompoundVariantCss__,raw:e=>e,variantKeys:Cs,variantMap:Tl,merge(e){return rt(this,e)},splitVariantProps(e){return ce(e,Cs)},getVariantProps:ti.getVariantProps}),ni=Ye("likec4-navigation-panel-icon",{variant:"default"},[]),Ll={variant:["default","filled"]},Ss=Object.keys(Ll),zm=Object.assign(ge(ni.recipeFn),{__recipe__:!0,__name__:"navigationPanelActionIcon",__getCompoundVariantCss__:ni.__getCompoundVariantCss__,raw:e=>e,variantKeys:Ss,variantMap:Ll,merge(e){return rt(this,e)},splitVariantProps(e){return ce(e,Ss)},getVariantProps:ni.getVariantProps}),oi=Ye("likec4-overlay",{fullscreen:!1,withBackdrop:!0},[]),Al={fullscreen:["false","true"],withBackdrop:["false","true"]},_s=Object.keys(Al),$m=Object.assign(ge(oi.recipeFn),{__recipe__:!0,__name__:"overlay",__getCompoundVariantCss__:oi.__getCompoundVariantCss__,raw:e=>e,variantKeys:_s,variantMap:Al,merge(e){return rt(this,e)},splitVariantProps(e){return ce(e,_s)},getVariantProps:oi.getVariantProps}),zl={isStepEdge:!1,cursor:"default"},Fm=[],Vm=[["root","likec4-edge-label__root"],["stepNumber","likec4-edge-label__stepNumber"],["labelContents","likec4-edge-label__labelContents"],["labelText","likec4-edge-label__labelText"],["labelTechnology","likec4-edge-label__labelTechnology"]],Om=Vm.map(([e,t])=>[e,Ye(t,zl,aa(Fm,e))]),Wm=ge((e={})=>Object.fromEntries(Om.map(([t,n])=>[t,n.recipeFn(e)]))),Ps=["cursor","isStepEdge"],Hm=e=>({...zl,...Nt(e)}),qm=Object.assign(Wm,{__recipe__:!1,__name__:"edgeLabel",raw:e=>e,classNameMap:{},variantKeys:Ps,variantMap:{cursor:["pointer","default"],isStepEdge:["false","true"]},splitVariantProps(e){return ce(e,Ps)},getVariantProps:Hm}),$l={truncateLabel:!1},Xm=[],Ym=[["root","likec4-navlink__root"],["body","likec4-navlink__body"],["section","likec4-navlink__section"],["label","likec4-navlink__label"],["description","likec4-navlink__description"]],Gm=Ym.map(([e,t])=>[e,Ye(t,$l,aa(Xm,e))]),Zm=ge((e={})=>Object.fromEntries(Gm.map(([t,n])=>[t,n.recipeFn(e)]))),Ms=["truncateLabel"],Km=e=>({...$l,...Nt(e)}),Um=Object.assign(Zm,{__recipe__:!1,__name__:"navigationLink",raw:e=>e,classNameMap:{},variantKeys:Ms,variantMap:{truncateLabel:["true","false"]},splitVariantProps(e){return ce(e,Ms)},getVariantProps:Km}),Fl=Me.withProps({color:"dark",fz:"xs",openDelay:600,closeDelay:120,label:"",children:null,offset:8,withinPortal:!1}),Vl=()=>o.jsx(Ke,{variant:"transparent",size:16,className:x({display:{base:"none","@/md":"flex"},color:{base:"mantine.colors.gray[5]",_dark:"mantine.colors.dark[3]"}}),children:o.jsx(It,{})});hr.withProps({separator:o.jsx(Vl,{}),separatorMargin:4});const Mt=m.forwardRef(({variant:e="default",className:t,disabled:n=!1,...i},a)=>o.jsx(Z,{size:"md",variant:"transparent",radius:"sm",component:He,...!n&&{whileHover:{scale:1.085},whileTap:{scale:1,translateY:1}},disabled:n,...i,className:S(t,zm({variant:e})),ref:a})),No=Me.withProps({color:"dark",fz:"xs",openDelay:600,closeDelay:120,label:"",children:null,offset:8,position:"right"}),Qm=()=>{const e=W();return o.jsx(No,{label:"Center camera",children:o.jsx(Mt,{onClick:()=>e.fitDiagram(),children:o.jsx(Bp,{})})})};x({gap:"xxs",_empty:{display:"none"}});x({top:"md",left:"md",margin:"0",pointerEvents:"none","& :where(button, .action-icon, [role='dialog'])":{pointerEvents:"all"},"& .action-icon":{"--ai-size":"2rem"},"& .tabler-icon":{width:"65%",height:"65%"},_reduceGraphics:{"& .action-icon":{"--ai-radius":"0px"}}});x({shadow:{base:"md",_whenPanning:"none"}});x({"& .tabler-icon":{width:"65%",height:"65%"}});const zn=x({flex:"1 1 40%",textAlign:"center",fontWeight:500,padding:"[4px 6px]",fontSize:"11px",zIndex:1}),Jm=x({background:"mantine.colors.gray[2]",borderRadius:"sm",border:"1px solid",borderColor:"mantine.colors.gray[4]",_dark:{background:"mantine.colors.dark[5]",borderColor:"mantine.colors.dark[4]"}}),ef=x({position:"relative",borderRadius:"sm",background:"mantine.colors.gray[3]",boxShadow:"inset 1px 1px 3px 0px #00000024",_dark:{background:"mantine.colors.dark[7]"}}),tf=x({position:"absolute",width:8,height:8,border:"2px solid",borderColor:"mantine.colors.gray[5]",borderRadius:3,transform:"translate(-50%, -50%)"}),nf=e=>({viewId:e.view.id,autoLayout:e.view.autoLayout}),of=()=>{const{onChange:e}=at(),t=W(),[n,i]=m.useState(null),[a,s]=m.useState({}),{autoLayout:r,viewId:l}=Ne(nf),{ref:d,hovered:c}=hi(),u=f=>y=>{a[f]=y,s(a)},p=f=>y=>{y.stopPropagation(),e?.({change:{op:"change-autolayout",layout:{...r,direction:f}}})},g=(f,y)=>{t.fitDiagram(),e?.({change:{op:"change-autolayout",layout:{...r,nodeSep:f,rankSep:y}}})};return o.jsxs(ot,{position:"right-start",clickOutsideEvents:["pointerdown"],radius:"xs",shadow:"lg",offset:{mainAxis:10},children:[o.jsx(Zt,{children:o.jsx(No,{label:"Change Auto Layout",children:o.jsx(Mt,{children:o.jsx(ng,{})})})}),o.jsx(Kt,{className:"likec4-top-left-panel",p:8,pt:6,opacity:c?.6:1,children:o.jsxs(X,{pos:"relative",ref:i,children:[o.jsx(_c,{target:a[r.direction],parent:n,className:Jm}),o.jsx(X,{mb:10,children:o.jsx(z,{inline:!0,fz:"xs",c:"dimmed",fw:500,children:"Auto layout:"})}),o.jsxs(oo,{gap:2,wrap:"wrap",justify:"stretch",maw:160,children:[o.jsx(fe,{className:zn,ref:u("TB"),onClick:p("TB"),children:"Top-Bottom"}),o.jsx(fe,{className:zn,ref:u("BT"),onClick:p("BT"),children:"Bottom-Top"}),o.jsx(fe,{className:zn,ref:u("LR"),onClick:p("LR"),children:"Left-Right"}),o.jsx(fe,{className:zn,ref:u("RL"),onClick:p("RL"),children:"Right-Left"})]}),o.jsx(X,{my:10,children:o.jsx(z,{inline:!0,fz:"xs",c:"dimmed",fw:500,children:"Spacing:"})}),o.jsx(af,{ref:d,isVertical:r.direction==="TB"||r.direction==="BT",nodeSep:r.nodeSep,rankSep:r.rankSep,onChange:g},l)]})})]})},Rt=400,af=m.forwardRef(({isVertical:e,nodeSep:t,rankSep:n,onChange:i},a)=>{e||([t,n]=[n,t]);const s=Vi(({x:g,y:f})=>{e||([g,f]=[f,g]),i(Math.round(g*Rt),Math.round(f*Rt))},[i,e],250,2e3),[r,l]=mr({defaultValue:Od({x:(t??100)/Rt,y:(n??120)/Rt}),onChange:s}),{ref:d}=Wd(l);let c=Math.round(r.x*Rt),u=Math.round(r.y*Rt);e||([c,u]=[u,c]);const p=Oi(d,a);return o.jsxs(X,{ref:p,className:ef,pt:"100%",children:[o.jsx(X,{className:tf,style:{left:`${r.x*100}%`,top:`${r.y*100}%`}}),o.jsx(X,{pos:"absolute",left:2,bottom:2,children:o.jsxs(z,{component:"div",fz:8,c:"dimmed",fw:500,children:[u,", ",c]})})]})}),sf=e=>e.context.view.id;function Io(){const e=Jt();return ee.useSelector(e,sf)}const lo=m.createContext(null),Ol=[];function tw(){const e=m.useContext(lo);return e?e.projects:Ol}const rf=()=>{},lf={projects:Ol,onProjectChange:rf};function df(){return m.useContext(lo)??lf}function cf(){const e=m.useContext(Mo);if(!e)throw new Error("No LikeC4ModelContext found");return e.projectId}function Wl(){const e=m.useContext(Mo);e||console.error("No LikeC4ModelContext found");const t=e?.$styles??Th.DEFAULT,[n,i]=m.useState(t);return m.useEffect(()=>{i(a=>a.equals(t)?a:t)},[t]),n}const uf=()=>{const e=en();return Ne(t=>t.view.hasLayoutDrift??!1)?o.jsxs(Pc,{position:"right-start",openDelay:200,closeDelay:100,...e,children:[o.jsx(Mc,{children:o.jsx(Z,{color:"orange",c:"orange",className:x({bg:"mantine.colors.orange.light"}),children:o.jsx(nl,{})})}),o.jsx(Ec,{p:"0",children:o.jsxs(Br,{color:"orange",withBorder:!1,withCloseButton:!1,title:"Manual layout issues",children:[o.jsxs(z,{mt:2,size:"sm",lh:"xs",children:["View contains new elements or their sizes have changed,",o.jsx("br",{}),"last manual layout can not be applied."]}),o.jsxs(z,{mt:"xs",size:"sm",lh:"xs",children:["Update view predicates or remove ",o.jsx(Tr,{children:"@likec4-generated"})]})]})})]}):null},Qe=({label:e,icon:t,onClick:n})=>o.jsx(No,{label:e,withinPortal:!1,position:"top",children:o.jsx(Mt,{classNames:{root:"action-icon",icon:x({"& > svg":{width:"70%",height:"70%"}})},onClick:n,children:t})}),pf=e=>{const t=W(),n=en();return o.jsxs(ot,{position:"right",offset:{mainAxis:12},clickOutsideEvents:["pointerdown"],...n,...e,children:[o.jsx(Zt,{children:o.jsx(No,{label:"Manual layouting tools",children:o.jsx(Mt,{children:o.jsx(eg,{})})})}),o.jsx(Kt,{className:ye({gap:"0.5",layerStyle:"likec4.panel",padding:"1",pointerEvents:"all"}),children:o.jsxs(vo,{children:[o.jsx(Qe,{label:"Align in columns",icon:o.jsx(Ua,{}),onClick:i=>{i.stopPropagation(),t.align("Column")}}),o.jsx(Qe,{label:"Align left",icon:o.jsx(qp,{}),onClick:i=>{i.stopPropagation(),t.align("Left")}}),o.jsx(Qe,{label:"Align center",icon:o.jsx(Wp,{}),onClick:i=>{i.stopPropagation(),t.align("Center")}}),o.jsx(Qe,{label:"Align right",icon:o.jsx(Zp,{}),onClick:i=>{i.stopPropagation(),t.align("Right")}}),o.jsx(Qe,{label:"Align in rows",icon:o.jsx(Ua,{style:{transform:"rotate(90deg)"}}),onClick:i=>{i.stopPropagation(),t.align("Row")}}),o.jsx(Qe,{label:"Align top",icon:o.jsx(Up,{}),onClick:i=>{i.stopPropagation(),t.align("Top")}}),o.jsx(Qe,{label:"Align middle",icon:o.jsx(Yp,{}),onClick:i=>{i.stopPropagation(),t.align("Middle")}}),o.jsx(Qe,{label:"Align bottom",icon:o.jsx(Vp,{}),onClick:i=>{i.stopPropagation(),t.align("Bottom")}}),o.jsx(Qe,{label:"Reset all control points",icon:o.jsx(mg,{}),onClick:i=>{i.stopPropagation(),t.resetEdgeControlPoints()}})]})})]})};function gf(){const{enableReadOnly:e}=K();return o.jsx(Ee,{children:!e&&o.jsx(ne,{layout:"position",className:Cn({gap:"xs",layerStyle:"likec4.panel",position:"relative",cursor:"pointer",padding:"xxs",pointerEvents:"all"}),initial:{opacity:0,translateX:-20},animate:{opacity:1,translateX:0},exit:{opacity:0,translateX:-20},children:o.jsxs(vo,{openDelay:600,closeDelay:120,children:[o.jsx(of,{}),o.jsx(pf,{}),o.jsx(uf,{}),o.jsx(Qm,{})]})})})}const ka=m.createContext(null);ka.displayName="NavigationPanelActorSafeContext";const hf=ka.Provider,ja=()=>{const e=m.useContext(ka);if(e===null)throw new Error("NavigationPanelActorRef is not found in the context");return e};function Hl(e,t=le){const n=ja();return ee.useSelector(n,e,t)}function mf(e,t=le){return Hl(n=>e(n.context),t)}function Sn(){const e=ja();return m.useMemo(()=>({actorRef:e,send:t=>e.send(t),selectFolder:t=>e.send({type:"select.folder",folderPath:t}),selectView:t=>e.send({type:"select.view",viewId:t}),isOpened:()=>e.getSnapshot().hasTag("active"),clearSearch:()=>e.send({type:"searchQuery.change",value:""}),closeDropdown:()=>e.send({type:"dropdown.dismiss"})}),[e])}const ff=m.forwardRef((e,t)=>o.jsxs("svg",{ref:t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 222 56",...e,children:[o.jsx("path",{fill:"#5E98AF",d:"M33.95 33.78V0H2.37A2.37 2.37 0 0 0 0 2.35V33.9h33.95v-.12ZM38.57 33.78H55.6v-14.6c0-1.3-1.06-2.35-2.36-2.35H38.57v16.95ZM33.95 38.37H17.04v14.6c0 1.29 1.06 2.35 2.36 2.35h14.67V38.37h-.12ZM38.57 38.37v16.95h14.67c1.3 0 2.36-1.06 2.36-2.36v-14.6H38.57Z"}),o.jsx("path",{className:x({fill:"[#FCFBF7]",_light:{fill:"[#222221]"}}),d:"M71.61 12.08c-.06 3.61.3 29.95.23 31.87 0 1.8 0 3.6.06 5.41 0 .3.18.58.47.58 4.1.18 8.13-.17 12.22-.11 1.34.05 2.69 0 3.97 0 1.29-.06 1.4-.59 1.35-1.63-.06-1.63-.06-3.08-.06-4.65-.06-.82-.53-1.11-1.23-1.11-2.4.06-4.8-.06-7.19.06-.4.06-.82.06-1.23.06-.7-.06-.87-.24-.93-1v-.86c-.18-4.83.17-9.83.17-14.66-.06-4.07 0-7.73-.06-11.34 0-1.57 0-3.14-.05-4.65-.06-.93 0-1.92-.24-2.85-.11-.35-.29-.81-.7-.81h-5.5c-.93 0-1.22.64-1.28 1.57v4.12ZM103.81 35c-.17-6.63-.1-13.67-.05-20.24 0-2.04-.12-4.25-.12-6.28 0-2.21-.87-2.1-2.04-2.15-1.7-.06-2.46-.06-4.15-.06-1.11-.06-1.58.23-1.58 1.34 0 5.7-.18 21.8-.12 24.13.06 2.33.3 12.91.18 15.24-.06.81 0 1.62.06 2.44.05.29.23.58.7.58 1.93-.12 3.74-.12 5.67-.17.7-.06 1.28-.24 1.58-1 .05-.4-.12-11.04-.12-13.83Zm13.92 4.47c0-2.03-.3-7.56-.23-8.72 0-.17.11-.4.17-.4.12 0 .35.11.41.17 1.87 2.44 10.64 19.36 11.7 19.42.28.06.58.06.87.06 1.99-.12 3.74 0 5.73 0 2.04 0 .7-1.98.35-2.5-.53-.76-7.48-13.14-7.9-13.9-1.16-1.98-2.16-4.13-3.32-6.05-.12-.23-.24-.58-.18-.81.12-.7.3-1.34.59-1.98a93.18 93.18 0 0 1 4.55-8.14c1.88-2.97 2.93-4.83 4.45-7.5.35-.64.58-1.34.82-2.1.05-.29-.18-.58-.53-.58-1.11-.05-5.15 0-6.43 0-.59 0-1.17.12-1.46.64-.76 1.46-8.6 15.7-9.35 16.98-.06.12-.24.18-.41.18 0 0-.12-.18-.12-.3-.06-3.25.53-13.9.4-16.04-.05-1.28-.28-1.4-1.57-1.46-1.4-.05-3.33-.05-4.73-.05-1.3 0-1.4.7-1.58 1.62-.06.18-.06 5.64-.06 8.09 0 3.54-.3 25.76.11 32.8 0 .7.18 1.1.77 1.1 1.57-.12 3.91 0 5.49 0 1.11 0 1.29-.12 1.29-1.98 0-2.5.23-4.77.23-7.85 0-.23-.06-.46-.06-.7Zm25.66-1.4h-.06c0 1.46-.05 2.97 0 4.49.06 1.86.18 3.72.3 5.58 0 .64.17.81.76.93 1.22.29 2.4.35 3.62.35 3.16-.12 6.31.11 9.47 0 1.29-.06 1.87.06 3.16-.18 1.17-.23 1.58-.87 1.58-2.61-.12-1.1-.06-1.57-.06-2.91 0-1.92-1.35-2.56-2.52-2.5-.81.06-4.73-.06-6.31-.06-2.63.06-2.22.4-2.22-2.33 0-2.2.06-5.05.06-7.32 0-1.22.11-1.63 1.28-1.63h7.31c1.17.17 1.99-.64 1.99-1.86 0-1.22.12-1.28.12-2.5l-.18-1.75c-.12-.99-.47-1.33-1.46-1.33-.64 0-1.29.05-1.93.11-2.52.18-3.68-.17-6.14 0-.82 0-.93-.11-1-.87-.23-2.27 0-4.77.24-7.04.06-.93.3-1.1 1.17-1.16l8.24-.06c1.11-.11 1.46-.06 1.4-1.16-.11-1.69.06-3.43-.11-5.12-.12-.93-.41-1.1-1.46-1.1-1.76.05-2.17.05-3.92.17-1.75.06-8.77.06-10.46.06-2.46 0-2.63-.18-2.7 2.8-.1 2.32-.05 4.7-.05 7.09 0 4.07-.23 18.66-.12 21.92Zm47.76-24.82c.06-1.92 0-3.5 0-5.35 0-2.15-3.92-1.92-5.32-1.86a18.95 18.95 0 0 0-15.08 9.77c-.82 1.57-1.4 3.2-1.81 4.88a34 34 0 0 0-.59 12.15c.41 3.78 1.4 7.56 3.74 10.59 4.04 5.3 11.46 7.15 17.83 6.16.3-.06.59-.11.82-.29.18-.11.35-.35.35-.58l.18-3.31c.06-1.05 0-1 0-2.04 0-1.4-2.93-.35-4.74-.35-1.75 0-3.62-.06-5.2-.87-2.8-1.57-4.38-4.71-5.26-7.68-1-3.2-1.23-6.63-.64-9.88.7-4.25 2.74-9.13 7.25-10.59 2.57-.87 5.31-.58 7.89-.29.35.06.58-.17.58-.46Zm26.77 15.3c.06-2.5 0-14.84 0-18.38.06-.82 0-1.63-.11-2.45-.06-.99-.24-1.28-1.29-1.33h-4.44c-.82 0-1.35.4-1.82 1.27-1.34 3.2-10.75 24.02-12.15 26.58-.53.99-1 1.63-1 2.68v4.24c0 .76-.06 1.28 1.23 1.28l11.1-.06c1.47 0 1.47.3 1.47 1.1 0 .88-.12 4.9-.12 5.3 0 .58.12 1.16 1.23 1.16h5.08c1.23 0 1.23-.7 1.23-2.03.06-1.17-.06-3.5-.06-4.66 0-.93.18-.98 1.76-.98 1.22 0 1.75-.12 1.75-.88.06-1.57 0-2.67 0-4.42 0-1.04-.93-.98-2.92-.98-.65 0-.7-.18-.7-1.05-.12-1.8-.24-4.6-.24-6.4Zm-7.25-5.94c-.05.7-.11 10.82-.11 12.27-.06.81-.24 1.05-1 1.1-1.93.06-3.85.06-5.78.06-.47 0-.65-.4-.41-.87.23-.4 4.85-11.57 6.13-14.48.18-.17.24-.35.41-.52.18-.12.41-.18.59-.23.06 0 .23.29.23.46 0 .76-.06 1.51-.06 2.21Z"})]})),xf=m.forwardRef((e,t)=>o.jsx("svg",{ref:t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 56 56",...e,children:o.jsx("path",{fill:"#5E98AF",d:"M33.95 33.78V0H2.37A2.37 2.37 0 0 0 0 2.35V33.9h33.95v-.12ZM38.57 33.78H55.6v-14.6c0-1.3-1.06-2.35-2.36-2.35H38.57v16.95ZM33.95 38.37H17.04v14.6c0 1.29 1.06 2.35 2.36 2.35h14.67V38.37h-.12ZM38.57 38.37v16.95h14.67c1.3 0 2.36-1.06 2.36-2.36v-14.6H38.57Z"})})),yf=()=>{const e=Sn(),{onBurgerMenuClick:t}=at();return o.jsx(ne,{layout:"position",children:o.jsxs(fe,{onMouseEnter:()=>{e.send({type:"breadcrumbs.mouseEnter.root"})},onMouseLeave:()=>{e.send({type:"breadcrumbs.mouseLeave.root"})},onClick:n=>{n.stopPropagation(),t&&e.isOpened()&&setTimeout(()=>{t()},100),e.send({type:"breadcrumbs.click.root"})},className:S("mantine-active",ye({padding:"0.5",width:{base:"[20px]","@/md":"[64px]"}})),children:[o.jsx(ff,{className:x({display:{base:"none","@/md":"block"}})}),o.jsx(xf,{className:x({display:{base:"block","@/md":"none"}})})]})})},bf=()=>{const e=W(),{hasStepBack:t,hasStepForward:n}=Ne(i=>({hasStepBack:i.navigationHistory.currentIndex>0,hasStepForward:i.navigationHistory.currentIndex<i.navigationHistory.history.length-1}));return o.jsxs(ne,{layout:"position",className:ye({gap:"0.5"}),children:[o.jsx(Mt,{disabled:!t,onClick:i=>{i.stopPropagation(),e.navigate("back")},children:o.jsx(hp,{size:14})}),o.jsx(Mt,{disabled:!n,onClick:i=>{i.stopPropagation(),e.navigate("forward")},children:o.jsx(Xt,{size:14})})]})},wf=()=>{const e=Io(),{enableVscode:t}=K(),{onOpenSource:n}=at();return t?o.jsx(Fl,{label:"Open View Source",children:o.jsx(Mt,{onClick:i=>{i.stopPropagation(),n?.({view:e})},children:o.jsx(Ut,{style:{width:"60%",height:"60%"}})})}):null};function vf(){const e=W(),t=Ic();return o.jsxs(fe,{component:He,layout:"position",onClick:n=>{n.stopPropagation(),e.openSearch()},whileTap:{scale:.95,translateY:1},className:S("group",ye({gap:"xxs",paddingInline:"sm",paddingBlock:"xxs",rounded:"sm",userSelect:"none",cursor:"pointer",color:{base:"likec4.panel.action-icon.text",_hover:"likec4.panel.action-icon.text.hover"},backgroundColor:{base:"likec4.panel.action-icon.bg",_hover:"likec4.panel.action-icon.bg.hover"},display:{base:"none","@/md":"flex"}})),children:[o.jsx(la,{size:14,stroke:2.5}),o.jsx(J,{css:{fontSize:"11px",fontWeight:600,lineHeight:1,opacity:.8,whiteSpace:"nowrap"},children:t?" + K":"Ctrl + K"})]})}const kf=e=>({visible:e.features.enableReadOnly!==!0,isReadOnly:e.toggledFeatures.enableReadOnly??e.features.enableReadOnly}),jf=()=>{const{visible:e,isReadOnly:t}=Ne(kf),n=W();return e?o.jsxs(fe,{component:He,layout:"position",onClick:i=>{i.stopPropagation(),n.toggleFeature("ReadOnly")},whileTap:{translateY:1},className:S("group",ye({gap:"0.5",paddingInline:"xxs",paddingBlock:"xxs",rounded:"sm",userSelect:"none",cursor:"pointer",color:{base:"likec4.panel.action-icon.text",_hover:"likec4.panel.action-icon.text.hover"},backgroundColor:{_hover:"likec4.panel.action-icon.bg.hover"}})),children:[t?o.jsx(lg,{size:14,stroke:2}):o.jsx(sg,{size:14,stroke:2}),t&&o.jsx(ne,{className:x({fontSize:"11px",fontWeight:600,lineHeight:1,opacity:.8}),children:"Unlock"})]}):null},ql=vn({base:{transitionDuration:"normal"},variants:{delay:{true:{transitionDelay:{base:"0.2s",_hover:"0s"}}}}});function Cf({data:{hovered:e=!1},icon:t,onClick:n}){const i=Qi(e,e?130:0)[0]&&e;return o.jsx(ne,{initial:!1,animate:{scale:i?1.2:1,x:i?-1:0,y:i?-1:0},whileHover:{scale:1.4,x:-3,y:-1},className:"likec4-compound-navigation compound-action",whileTap:{scale:1},onClick:ie,children:o.jsx(Z,{className:S("nodrag nopan",ql({delay:e&&!i}),Eo({variant:"transparent"})),onClick:n,onDoubleClick:ie,children:t??o.jsx(Ae,{stroke:2})})})}function Xl({data:{hovered:e=!1},icon:t,onClick:n}){const i=Qi(e,e?130:0)[0]&&e;return o.jsx(ne,{initial:!1,animate:{scale:i?1.2:1},whileHover:{scale:1.4},whileTap:{scale:1},className:"likec4-compound-details details-button",children:o.jsx(Z,{className:S("nodrag nopan",ql({delay:e&&!i}),Eo({variant:"transparent"})),onClick:n,onDoubleClick:ie,children:t??o.jsx(sa,{stroke:1.8,style:{width:"75%"}})})})}function _n({nodeProps:{data:{hovered:e=!1,dimmed:t=!1,...n}},className:i,children:a,style:s,...r}){let l=Ve(n.style.opacity??100,{min:0,max:100});const d=l<99,c=65,u=c+Ve((100-c)*(l/100),{min:0,max:100-c}),p=Dm({isTransparent:d,inverseColor:l<60,borderStyle:n.style.border??(d?"dashed":"none")}),g=Ve(n.depth??1,{min:1,max:5});return o.jsx(ne,{className:S(p,i),initial:!1,"data-likec4-hovered":e,"data-likec4-color":n.color,"data-compound-depth":g,...t!==!1&&{"data-likec4-dimmed":t},style:{...s,"--_border-transparency":`${u}%`,"--_compound-transparency":`${l}%`},...r,children:a})}function Pn({data:e}){const t=Co({element:e,className:"likec4-compound-icon"});return o.jsxs("div",{className:"likec4-compound-title-container",children:[t,o.jsx(z,{component:"h3",className:"likec4-compound-title",truncate:"end",children:e.title})]})}function Ro({icon:e,onClick:t}){return o.jsx(Z,{className:S("nodrag nopan",Bm()),onPointerDownCapture:ie,onClick:t,role:"button",onDoubleClick:ie,children:e??o.jsx(Ae,{})})}const Sf=".react-flow__edge.selected",_f=x({_reduceGraphics:{transition:"none"}}),Pf=x({pointerEvents:"none",fill:"none",strokeWidth:"calc(var(--xy-edge-stroke-width) + 2)",strokeOpacity:.08,_noReduceGraphics:{transitionProperty:"stroke-width, stroke-opacity",transitionDuration:"fast",transitionTimingFunction:"inOut"},_whenHovered:{transitionTimingFunction:"out",strokeWidth:"calc(var(--xy-edge-stroke-width) + 4)",strokeOpacity:.2},_whenSelected:{strokeWidth:"calc(var(--xy-edge-stroke-width) + 6)",strokeOpacity:.25,_whenHovered:{strokeOpacity:.4}}}),Mf=x({fill:"[var(--xy-edge-stroke)]",stroke:"[var(--xy-edge-stroke)]"}),Ef=x({fill:"none",strokeDashoffset:0,_noReduceGraphics:{animationStyle:"xyedgeAnimated",animationPlayState:"paused",transition:"stroke 130ms ease-out,stroke-width 130ms ease-out"},":where([data-edge-dir='back']) &":{animationDirection:"reverse"},_whenHovered:{_noReduceGraphics:{animationPlayState:"running",animationDelay:"450ms"}},[`:where(${Sf}, [data-edge-active='true'], [data-edge-animated='true']) &`]:{_noReduceGraphics:{animationPlayState:"running",animationDelay:"0ms"}},_whenDimmed:{animationPlayState:"paused"},_smallZoom:{animationName:"none"},_whenPanning:{strokeDasharray:"none !important",animationPlayState:"paused"}});function fn({className:e,component:t="g",data:{color:n="gray",hovered:i=!1,active:a=!1,dimmed:s=!1,...r},children:l,style:d}){const c={className:S(e,_f,"likec4-edge-container"),"data-likec4-color":n,"data-edge-dir":r.dir??"forward","data-edge-active":a,"data-edge-animated":a,"data-likec4-hovered":i,...s!==!1&&{"data-likec4-dimmed":s}};return t==="svg"?o.jsx("svg",{style:d,...c,children:l}):(T(t==="g",'EdgeContainer: component must be "g" or "svg"'),o.jsx("g",{style:d,...c,children:l}))}const Mn=m.forwardRef(({edgeProps:{id:e,data:{label:t,technology:n,hovered:i=!1},selected:a=!1,selectable:s=!1},className:r,style:l,children:d,...c},u)=>{const p=_o(e)?Ch(e):null,g=qm({isStepEdge:p!==null,cursor:s||p!==null?"pointer":"default"}),f=_e(t)||_e(n);return o.jsxs(ne,{ref:u,className:S(g.root,"likec4-edge-label",r),"data-edge-id":e,animate:{scale:i&&!a?1.06:1},...c,children:[p!==null&&o.jsx(J,{className:g.stepNumber,children:p}),f&&o.jsxs(J,{className:g.labelContents,children:[_e(t)&&o.jsx(J,{className:S(g.labelText,x({lineClamp:5})),children:t}),_e(n)&&o.jsx(J,{className:g.labelTechnology,children:"[ "+n+" ]"}),d]})]})});Mn.displayName="EdgeLabel";const Es=e=>{if(e!==void 0)return Fr(e)?`${Math.round(e)}px`:e};function Do({edgeProps:{id:e,data:{hovered:t=!1,active:n=!1,dimmed:i=!1,labelBBox:a,color:s="gray"}},labelPosition:r,className:l,style:d,children:c,...u}){let p=ua(m.useCallback(b=>b.edgeLookup.get(e)?.zIndex??We.Edge,[e]));(t||n)&&(p+=100);let g=r?.x??a?.x,f=r?.y??a?.y;if(g===void 0||f===void 0)return null;const y=r?.translate;return o.jsx($r,{children:o.jsx("div",{...u,className:S("nodrag nopan","likec4-edge-label-container",l),"data-likec4-hovered":t,"data-likec4-color":s,"data-edge-active":n,"data-edge-animated":n,...i!==!1&&{"data-likec4-dimmed":i},style:{...a&&{maxWidth:a.width+18},zIndex:p,...d,transform:`translate(${Es(g)}, ${Es(f)}) ${y||""}`},children:c},e)})}const Nf=e=>o.jsx("marker",{viewBox:"-4 -4 14 16",refX:5,refY:4,markerWidth:"7",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:o.jsx("path",{d:"M0,0 L7,4 L0,8 L4,4 Z",stroke:"context-stroke",fill:"context-stroke",strokeDasharray:0,strokeWidth:1,strokeLinecap:"round"})}),If=e=>o.jsx("marker",{viewBox:"-1 -1 12 10",refX:4,refY:3,markerWidth:"8",markerHeight:"6",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:o.jsx("path",{d:"M 0 0 L 8 3 L 0 6 L 1 3 z",fill:"context-stroke",strokeWidth:0})}),Rf=e=>o.jsx("marker",{viewBox:"-1 -1 12 12",refX:8,refY:4,markerWidth:"8",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:o.jsx("path",{d:"M 8 0 L 0 4 L 8 8 M 8 4 L 0 4",fill:"none",strokeWidth:1})}),Df=e=>o.jsx("marker",{viewBox:"-1 -1 12 10",refX:4,refY:3,markerWidth:"8",markerHeight:"6",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:o.jsx("path",{d:"M 0 0 L 8 3 L 0 6 L 1 3 z",stroke:"context-stroke",fill:"context-stroke",strokeWidth:1.25,strokeLinejoin:"miter",strokeLinecap:"square"})}),Bf=e=>o.jsx("marker",{viewBox:"-4 -4 16 14",refX:5,refY:4,markerWidth:"10",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:o.jsx("path",{d:"M5,0 L10,4 L5,8 L0,4 Z",fill:"context-stroke",strokeWidth:0,strokeLinecap:"round"})}),Tf=e=>o.jsx("marker",{viewBox:"-4 -4 16 14",refX:6,refY:4,markerWidth:"10",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:o.jsx("path",{d:"M5,0 L10,4 L5,8 L0,4 Z",stroke:"context-stroke",fill:"context-stroke",strokeWidth:1.25,strokeLinecap:"round"})}),Lf=e=>o.jsx("marker",{viewBox:"0 0 10 10",refX:4,refY:4,markerWidth:"6",markerHeight:"6",...e,children:o.jsx("circle",{strokeWidth:0,fill:"context-stroke",cx:4,cy:4,r:3})}),Af=e=>o.jsx("marker",{viewBox:"0 0 10 10",refX:4,refY:4,markerWidth:"6",markerHeight:"6",...e,children:o.jsx("circle",{strokeWidth:1.25,stroke:"context-stroke",fill:"context-stroke",cx:4,cy:4,r:3})}),Ns={Arrow:If,Crow:Rf,OArrow:Df,Open:Nf,Diamond:Bf,ODiamond:Tf,Dot:Lf,ODot:Af};function Is(e){if(!(!e||e==="none"))switch(e){case"normal":return"Arrow";case"crow":return"Crow";case"onormal":return"OArrow";case"diamond":return"Diamond";case"odiamond":return"ODiamond";case"open":case"vee":return"Open";case"dot":return"Dot";case"odot":return"ODot";default:Le(e)}}const En=m.forwardRef(({edgeProps:{id:e,data:{line:t,dir:n,tail:i,head:a},selectable:s=!0,style:r,interactionWidth:l},onEdgePointerDown:d,strokeWidth:c,svgPath:u},p)=>{let g=Is(i),f=Is(a??"normal");n==="back"&&([g,f]=[f,g]);const y=g?Ns[g]:null,b=f?Ns[f]:null,C=t==="dotted",k=C||t==="dashed";let v;return C?v="1,8":k&&(v="8,10"),o.jsxs(o.Fragment,{children:[s&&o.jsx("path",{className:S("react-flow__edge-interaction","hide-on-reduced-graphics",x({fill:"none"})),d:u,style:{strokeWidth:l??10,stroke:"currentcolor",strokeOpacity:0}}),o.jsxs("g",{className:Mf,onPointerDown:d,children:[o.jsxs("defs",{children:[y&&o.jsx(y,{id:"start"+e}),b&&o.jsx(b,{id:"end"+e})]}),o.jsx("path",{className:S("react-flow__edge-path","hide-on-reduced-graphics",Pf),d:u,style:r,strokeLinecap:"round"}),o.jsx("path",{ref:p,className:S("react-flow__edge-path",s&&"react-flow__edge-interaction",Ef),d:u,style:r,strokeWidth:c,strokeLinecap:"round",strokeDasharray:v,markerStart:y?`url(#start${e})`:void 0,markerEnd:b?`url(#end${e})`:void 0})]})]})});En.displayName="EdgePath";const zf=ye({position:"absolute",zIndex:1,justifyContent:"center",alignItems:"center",_smallZoom:{display:"none"}}),$f=ye({gap:"1.5",justifyContent:"center",alignItems:"center"});function Bo({selected:e=!1,data:{hovered:t=!1},buttons:n}){const i=ea();return n.length?o.jsx(J,{className:zf,style:{top:"calc(100% - 30px)",transform:"translateX(-50%)",left:"50%",width:"auto",minHeight:30},children:o.jsx(ne,{layoutRoot:!0,initial:!1,style:{originY:0},animate:{opacity:t||e?1:.75,scale:t?1.1:e?.9:.8,y:t||e?6:0},"data-likec4-hovered":t,className:S("nodrag nopan",$f),children:n.map((a,s)=>o.jsx(Z,{component:He,className:Eo({}),initial:!1,whileTap:{scale:1},whileHover:{scale:1.3},onClick:a.onClick,onDoubleClick:ie,children:a.icon||o.jsx(xp,{})},`${i}-${a.key??s}`))},`${i}-action-buttons`)}):null}const Et=m.forwardRef(({value:e,textScale:t=1,uselikec4palette:n=!1,hideIfEmpty:i=!1,emptyText:a="no content",className:s,style:r,fontSize:l,...d},c)=>{if(e.isEmpty&&i)return null;const u=e.nonEmpty?e.isMarkdown?{dangerouslySetInnerHTML:{__html:e.html}}:{children:o.jsx("p",{children:e.text})}:{children:o.jsx(z,{component:"span",fz:"xs",c:"dimmed",style:{userSelect:"none"},children:a})};return o.jsx(J,{ref:c,...d,className:S(Am({uselikec4palette:n,value:e.isMarkdown?"markdown":"plaintext"}),s),style:{...r,...l&&{"--text-fz":`var(--font-sizes-${l}, var(--font-sizes-md))`},"--mantine-scale":t},...u})});Et.displayName="Markdown";const Yl=m.forwardRef(({className:e,...t},n)=>o.jsx("div",{...t,ref:n,className:S(e,Tm(),"likec4-element")})),Gl=({data:e,...t})=>o.jsx(Co,{element:e,...t}),Zl=m.forwardRef(({className:e,...t},n)=>o.jsx("div",{...t,className:S(e,"likec4-element-node-content"),ref:n})),Kl=m.forwardRef(({data:{title:e,style:t},className:n,...i},a)=>{const{size:s}=Po(t),r=s==="sm"||s==="xs";return o.jsx(z,{component:"div",...i,className:S(n,"likec4-element-title"),"data-likec4-node-title":"",lineClamp:r?2:3,ref:a,children:e})}),Ul=m.forwardRef(({data:e,children:t,className:n,...i},a)=>{const s=e?.technology??t;return _e(s)?o.jsx(z,{component:"div",...i,className:S(n,"likec4-element-technology"),"data-likec4-node-technology":"",ref:a,children:s}):null}),Ql=m.forwardRef(({data:{description:e,style:t},className:n,...i},a)=>{if(!e?.nonEmpty)return null;const{size:s}=Po(t),r=s==="sm"||s==="xs";return o.jsx(Et,{...i,className:S(n,"likec4-element-description"),"data-likec4-node-description":"",value:e,uselikec4palette:!0,hideIfEmpty:!0,maxHeight:e.isMarkdown?"8rem   ":void 0,lineClamp:r?3:5,ref:a})});function Ge({iconSize:e,data:t}){return o.jsxs(Yl,{style:Fr(e)?{"--likec4-icon-size":`${e}px`}:void 0,children:[o.jsx(Gl,{data:t}),o.jsxs(Zl,{children:[o.jsx(Kl,{data:t}),o.jsx(Ul,{data:t}),o.jsx(Ql,{data:t})]})]})}Ge.Root=Yl;Ge.Icon=Gl;Ge.Content=Zl;Ge.Title=Kl;Ge.Technology=Ul;Ge.Description=Ql;const Ff=x({position:"absolute",top:"0.5",right:"0.5",_shapeBrowser:{right:"[5px]"},_shapeCylinder:{top:"[14px]"},_shapeStorage:{top:"[14px]"},_shapeQueue:{top:"[1px]",right:"3"},_smallZoom:{display:"none"}});function Ca({selected:e=!1,data:{hovered:t=!1},icon:n,onClick:i}){const a=ea();return o.jsx(J,{className:S(Ff,"details-button"),children:o.jsx(Z,{className:S("nodrag nopan",Eo({variant:"transparent"})),component:He,initial:!1,style:{originX:.45,originY:.55},animate:t||e?{scale:1.2,opacity:.8}:{scale:1,opacity:.5},whileHover:{scale:1.4,opacity:1},whileTap:{scale:1.15},onClick:i,onDoubleClick:ie,children:n??o.jsx(sa,{stroke:1.8,style:{width:"75%"}})},a)})}const Vf=x({position:"relative",width:"100%",height:"100%",padding:"0",margin:"0",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",_before:{content:'" "',position:"absolute",top:"[calc(100% - 4px)]",left:"0",width:"100%",height:"24px",background:"[transparent]",pointerEvents:"all"},_focusVisible:{outline:"none"},_reduceGraphicsOnPan:{_before:{display:"none"}},":where(.react-flow__node.selectable:not(.dragging)) &":{cursor:"pointer"}}),tn=m.forwardRef(({nodeProps:{selected:e=!1,selectable:t=!1,data:{hovered:n=!1,dimmed:i=!1,...a}},className:s,style:r,children:l,...d},c)=>{let u=1;switch(!0){case n:u=1.05;break;case e:u=1.02;break}const{size:p,padding:g,textSize:f}=Po(a.style??{});return o.jsx(ne,{ref:c,className:S(Vf,"group","likec4-element-node",s),initial:!1,...t&&{animate:{scale:u},whileTap:{scale:.98}},"data-likec4-hovered":n,"data-likec4-color":a.color,"data-likec4-shape":a.shape,"data-likec4-shape-size":p,"data-likec4-spacing":g,"data-likec4-text-size":f,...i!==!1&&{"data-likec4-dimmed":i},style:{...r},...d,children:l})});tn.displayName="ElementNodeContainer";class ve{constructor(t,n){this.x=t,this.y=n}static create(t){return new ve(t.x,t.y)}static add(t,n){return{x:t.x+n.x,y:t.y+n.y}}static sub(t,n){return{x:t.x-n.x,y:t.y-n.y}}static mul(t,n){return{x:t.x*n,y:t.y*n}}static dot(t,n){return t.x*n.x+t.y*n.y}static cross(t,n){return new ve(t.y*n.x-t.x*n.y,t.x*n.y-t.y*n.x)}static setLength(t,n){return Ct(t).setLength(n)}add(t){return new ve(this.x+t.x,this.y+t.y)}sub(t){return new ve(this.x-t.x,this.y-t.y)}mul(t){return new ve(this.x*t,this.y*t)}dot(t){return this.x*t.x+this.y*t.y}cross(t){return new ve(this.y*t.x-this.x*t.y,this.x*t.y-this.y*t.x)}abs(){return Math.sqrt(this.x*this.x+this.y*this.y)}setLength(t){return this.mul(t/this.abs())}}function Ct(e){return ve.create(e)}function Of(e,t){if(e._type==="dynamic")try{if(t??=e.variant,t==="sequence")return e.sequenceLayout.bounds}catch{}return e.bounds}function Jl(e,t,n=.065){const i=Math.round(e/2),a=i,s=Be(n*i),r=t-2*s;return{path:`  M ${e},${s}
        a ${a},${s} 0,0,0 ${-e} 0
        l 0,${r}
        a ${a},${s} 0,0,0 ${e} 0
        l 0,${-r}
        z
        `.replace(/\s+/g," ").trim(),ry:s,rx:a}}function ed(e,t,n=.185){const i=t,a=Math.round(i/2),s=Be(i/2*n),r=e-2*s;return{path:`
    M ${s},0
    a ${s},${a} 0,0,0 0 ${i}
    l ${r},0
    a ${s},${a} 0,0,0 0 ${-i}
    z`.replace(/\s+/g," ").trim(),ry:a,rx:s}}const yt={width:115,height:120,path:"M57.9197 0C10.9124 0 33.5766 54.75 33.5766 54.75C38.6131 62.25 45.3285 60.75 45.3285 66C45.3285 70.5 39.4526 72 33.5766 72.75C24.3431 72.75 15.9489 71.25 7.55474 84.75C2.51825 93 0 120 0 120H115C115 120 112.482 93 108.285 84.75C99.8905 70.5 91.4963 72.75 82.2628 72C76.3869 71.25 70.5109 69.75 70.5109 65.25C70.5109 60.75 77.2263 62.25 82.2628 54C82.2628 54.75 104.927 0 57.9197 0V0Z"};function Rs({shape:e,w:t,h:n}){switch(e){case"mobile":return o.jsxs(o.Fragment,{children:[o.jsx("rect",{width:t,height:n,rx:6,"data-likec4-fill":"mix-stroke",strokeWidth:0}),o.jsxs("g",{"data-likec4-fill":"fill",strokeWidth:0,children:[o.jsx("circle",{cx:17,cy:n/2,r:12}),o.jsx("rect",{x:33,y:12,width:t-44,height:n-24,rx:5})]})]});case"browser":return o.jsxs(o.Fragment,{children:[o.jsx("rect",{width:t,height:n,rx:6,"data-likec4-fill":"mix-stroke",strokeWidth:0}),o.jsxs("g",{"data-likec4-fill":"fill",strokeWidth:0,children:[o.jsx("circle",{cx:16,cy:17,r:7}),o.jsx("circle",{cx:36,cy:17,r:7}),o.jsx("circle",{cx:56,cy:17,r:7}),o.jsx("rect",{x:70,y:8,width:t-80,height:17,rx:4}),o.jsx("rect",{x:10,y:32,width:t-20,height:n-42,rx:4})]})]});case"person":return o.jsxs(o.Fragment,{children:[o.jsx("rect",{width:t,height:n,rx:6,strokeWidth:0}),o.jsx("svg",{x:t-yt.width-6,y:n-yt.height,width:yt.width,height:yt.height,viewBox:`0 0 ${yt.width} ${yt.height}`,"data-likec4-fill":"mix-stroke",children:o.jsx("path",{strokeWidth:0,d:yt.path})})]});case"queue":{const{path:i,rx:a,ry:s}=ed(t,n);return o.jsxs(o.Fragment,{children:[o.jsx("path",{d:i,strokeWidth:2}),o.jsx("ellipse",{cx:a,cy:s,ry:s-.75,rx:a,"data-likec4-fill":"mix-stroke",strokeWidth:2})]})}case"storage":case"cylinder":{const{path:i,rx:a,ry:s}=Jl(t,n);return o.jsxs(o.Fragment,{children:[o.jsx("path",{d:i,strokeWidth:2}),o.jsx("ellipse",{cx:a,cy:s,ry:s,rx:a-.75,"data-likec4-fill":"mix-stroke",strokeWidth:2})]})}default:return Le(e)}}function Wf({shape:e,w:t,h:n}){let i;switch(e){case"queue":i=o.jsx("path",{d:ed(t,n).path});break;case"storage":case"cylinder":{i=o.jsx("path",{d:Jl(t,n).path});break}default:{i=o.jsx("rect",{x:-1,y:-1,width:t+2,height:n+2,rx:6});break}}return o.jsx("g",{className:"likec4-shape-outline",children:i})}function Hf({multiple:e,withOutLine:t}){return o.jsxs("div",{className:Dl({shapetype:"html"}),children:[e&&o.jsx("div",{className:"likec4-shape-multiple"}),t&&o.jsx("div",{className:"likec4-shape-outline"})]})}function nn({data:e,width:t,height:n,showSeletionOutline:i=!0}){let a=t&&t>10?t:e.width,s=n&&n>10?n:e.height;const r=e.style?.multiple??!1;if(e.shape==="rectangle")return o.jsx(Hf,{multiple:r,withOutLine:i});const l=Dl({shapetype:"svg"});return o.jsxs(o.Fragment,{children:[r&&o.jsx("svg",{className:l,"data-likec4-shape-multiple":"true",viewBox:`0 0 ${a} ${s}`,children:o.jsx(Rs,{shape:e.shape,w:a,h:s})}),o.jsxs("svg",{className:l,viewBox:`0 0 ${a} ${s}`,children:[i&&o.jsx(Wf,{shape:e.shape,w:a,h:s}),o.jsx(Rs,{shape:e.shape,w:a,h:s})]})]})}const To=m.forwardRef(({tag:e,cursor:t,className:n,style:i,...a},s)=>{const r=dm(e);return o.jsxs(J,{ref:s,"data-likec4-tag":e,className:S(Lm({autoTextColor:cl(r)}),n),...a,style:{cursor:t,...i},children:[o.jsx("span",{children:"#"}),o.jsx("span",{children:e})]})}),qf=(e,t)=>e.data.width===t.data.width&&I(e.data.tags,t.data.tags)&&(e.data.hovered??!1)===(t.data.hovered??!1),Nn=m.memo(({id:e,data:{tags:t,width:n,hovered:i=!1}})=>{const{hovered:a,ref:s}=hi(),{hovered:r,ref:l}=hi(),[d,c]=Hd(!1,i?120:300);m.useEffect(()=>{c(C=>C?i||a||r:i&&(a||r))},[a,r,i]);const u=Gg(),p=u>1.2,g=W(),f=C=>{g.send({type:"tag.highlight",tag:C})},y=m.useCallback(()=>{g.send({type:"tag.unhighlight"})},[]);if(!t||t.length===0)return null;const b=Math.max(Math.round(n*u)-10,200);return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:s,className:S("likec4-element-tags",ye({pointerEvents:"all",gap:"1",alignItems:"flex-end",justifyItems:"stretch",position:"absolute",width:"100%",bottom:"0",left:"0",padding:"1",_shapeCylinder:{bottom:"[5px]"},_shapeStorage:{bottom:"[5px]"},_shapeQueue:{bottom:"0",paddingLeft:"[14px]"}})),onClick:ie,children:t.map(C=>o.jsx(J,{"data-likec4-tag":C,className:x({layerStyle:"likec4.tag",flex:"1",display:"flex",alignItems:"center",justifyContent:"center",maxWidth:50,height:5,_whenHovered:{height:12,borderRadius:4,transitionDelay:".08s"},transition:"fast"})},e+"#"+C))}),o.jsx(fr,{isVisible:d,align:"start",position:pe.Bottom,children:o.jsx(ae,{ref:l,css:{gap:"0.5",alignItems:"baseline",flexWrap:"wrap",pb:"sm",translate:"auto",x:"[-8px]",maxWidth:b},children:t.map(C=>o.jsx(To,{tag:C,cursor:"pointer",className:x({userSelect:"none",...p&&{fontSize:"lg",borderRadius:"[4px]",px:"1.5"}}),onClick:k=>{k.stopPropagation(),g.openSearch(`#${C}`)},onMouseEnter:()=>f(C),onMouseLeave:y},C))})})]})},qf);Nn.displayName="ElementTags";const $n=(e,t)=>Math.abs(e-t)<2.5,Xf=(e,t)=>e.id===t.id&&I(e.selected??!1,t.selected??!1)&&I(e.animated??!1,t.animated??!1)&&I(e.source,t.source)&&I(e.sourceHandleId??null,t.sourceHandleId??null)&&I(e.sourcePosition,t.sourcePosition)&&I(e.target,t.target)&&I(e.targetHandleId??null,t.targetHandleId??null)&&I(e.targetPosition,t.targetPosition)&&$n(e.sourceX,t.sourceX)&&$n(e.sourceY,t.sourceY)&&$n(e.targetX,t.targetX)&&$n(e.targetY,t.targetY)&&I(e.data,t.data);function Sa(e){return m.memo(e,Xf)}function Yf(e,t){return e.id===t.id&&I(e.selected??!1,t.selected??!1)&&I(e.dragging??!1,t.dragging??!1)&&I(e.width??0,t.width??0)&&I(e.height??0,t.height??0)&&I(e.zIndex??0,t.zIndex??0)&&I(e.data,t.data)}const Ds=Symbol.for("isMemoized");function et(e){if(e.hasOwnProperty(Ds))return e;const t=m.memo(e,Yf);return t.displayName="Node",Object.defineProperty(t,Ds,{enumerable:!1,writable:!1,value:!0}),t}const Fn={top:"50%",left:"50%",right:"unset",bottom:"unset",visibility:"hidden",width:5,height:5,transform:"translate(-50%, -50%)"},In=()=>o.jsxs(o.Fragment,{children:[o.jsx(Pe,{type:"target",position:pe.Top,style:Fn}),o.jsx(Pe,{type:"target",position:pe.Left,style:Fn}),o.jsx(Pe,{type:"source",position:pe.Right,style:Fn}),o.jsx(Pe,{type:"source",position:pe.Bottom,style:Fn})]}),Gf=m.forwardRef((e,t)=>o.jsx("svg",{height:"24",width:"24",fill:"currentColor",...e,viewBox:"0 0 24 24",ref:t,children:o.jsx("path",{d:"M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"})})),Bs="https://github.com/",_a=m.forwardRef(({value:e,className:t,...n},i)=>{const a=e.url.includes("://")?e.url:new window.URL(e.url,window.location.href).toString();let s=a.startsWith(Bs);return o.jsx(St,{ref:i,variant:"default",radius:"sm",size:"sm",tt:"none",leftSection:e.title?o.jsx(o.Fragment,{children:e.title}):null,rightSection:o.jsx(qd,{value:a,timeout:1500,children:({copy:r,copied:l})=>o.jsx(Z,{className:x({opacity:l?1:.45,transition:"fast",_hover:{opacity:1}}),tabIndex:-1,size:"20",variant:l?"light":"transparent",color:l?"teal":"gray","data-active":l,onClick:d=>{d.stopPropagation(),d.preventDefault(),r()},children:l?o.jsx(ol,{}):o.jsx(_p,{stroke:2.5})})}),...n,className:S(t,"group"),classNames:{root:x({flexWrap:"nowrap",minHeight:24,maxWidth:500,userSelect:"all",pr:"0",backgroundColor:{base:"transparent",_hover:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]"}}}),section:x({'&:is([data-position="left"])':{color:"mantine.colors.dimmed",userSelect:"none",pointerEvents:"none",_groupHover:{color:"[var(--badge-color)]",opacity:.7}}})},children:o.jsxs(st.a,{href:a,target:"_blank",style:{color:"var(--badge-color)",cursor:"pointer"},css:{transition:"fast",opacity:{base:.7,_hover:1},textDecoration:{base:"none",_hover:"underline"}},children:[s&&o.jsx(Gf,{height:"12",width:"12",style:{verticalAlign:"middle",marginRight:"4px"}}),s?a.replace(Bs,""):a]})})}),Zf=({context:e})=>{const t=e.viewModel;return{id:t.id,title:t.titleOrUntitled,description:t.description,tags:t.tags,links:t.links}},Kf=e=>{const[t,n]=m.useState(!1),i=Hl(Zf),a=en();return o.jsxs(ot,{position:"bottom-end",shadow:"xl",clickOutsideEvents:["pointerdown","mousedown","click"],offset:{mainAxis:4},opened:t,onChange:n,...a,...e,children:[o.jsx(Uf,{linksCount:i.links.length,onOpen:()=>n(!0)}),t&&o.jsx(Qf,{data:i,onClose:()=>n(!1)})]})},Uf=({linksCount:e,onOpen:t})=>o.jsx(ot.Target,{children:o.jsxs(fe,{component:He,layout:"position",whileTap:{scale:.95,translateY:1},onClick:n=>{n.stopPropagation(),t()},className:S("group",ye({gap:"2",paddingInline:"2",paddingBlock:"1",rounded:"sm",userSelect:"none",cursor:"pointer",color:{base:"likec4.panel.action-icon.text",_hover:"likec4.panel.action-icon.text.hover"},backgroundColor:{_hover:"likec4.panel.action-icon.bg.hover"},display:{base:"none","@/xs":"flex"}}),""),children:[o.jsx(sa,{size:16,stroke:1.8}),e>0&&o.jsxs(ae,{gap:"[1px]",children:[o.jsx(ig,{size:14,stroke:2}),o.jsx(J,{css:{fontSize:"11px",fontWeight:600,lineHeight:1,opacity:.8},children:e})]})]})}),Ts=st("div",{base:{fontSize:"xs",color:"mantine.colors.dimmed",fontWeight:500,userSelect:"none",mb:"xxs"}}),Qf=({data:{id:e,title:t,description:n,tags:i,links:a},onClose:s})=>{const r=W();return $e("paneClick",s),$e("nodeClick",s),o.jsxs(ot.Dropdown,{className:S("nowheel nopan nodrag",Cn({margin:"xs",layerStyle:"likec4.dropdown",gap:"md",padding:"md",paddingBottom:"lg",pointerEvents:"all",maxWidth:"calc(100cqw - 52px)",minWidth:"200px",maxHeight:"calc(100cqh - 100px)",width:"max-content",cursor:"default",overflow:"auto",overscrollBehavior:"contain","@/sm":{minWidth:400,maxWidth:550},"@/lg":{maxWidth:700}})),children:[o.jsxs("section",{children:[o.jsx(z,{component:"div",fw:500,size:"xl",lh:"sm",children:t}),o.jsxs(ae,{alignItems:"flex-start",mt:"1",children:[o.jsx(Jf,{label:"id",value:e}),o.jsx(ae,{gap:"xs",flexWrap:"wrap",children:i.map(l=>o.jsx(To,{tag:l,cursor:"pointer",onClick:d=>{d.stopPropagation(),r.openSearch(`#${l}`)}},l))})]})]}),a.length>0&&o.jsxs("section",{className:ye({alignItems:"baseline"}),children:[o.jsx(Ts,{children:"Links"}),o.jsx(ae,{gap:"xs",flexWrap:"wrap",children:a.map((l,d)=>o.jsx(_a,{value:l},`${d}-${l.url}`))})]}),n.isEmpty&&o.jsx(z,{component:"div",fw:500,size:"xs",c:"dimmed",style:{userSelect:"none"},children:"No description"}),n.nonEmpty&&o.jsxs("section",{children:[o.jsx(Ts,{children:"Description"}),o.jsx(Et,{value:n,fontSize:"sm",emptyText:"No description",className:x({userSelect:"all"})})]})]})},Jf=({label:e,value:t})=>o.jsxs(ae,{gap:"0.5",children:[o.jsx(ex,{children:e}),o.jsx(St,{size:"sm",radius:"sm",variant:"light",color:"gray",tt:"none",fw:500,classNames:{root:x({width:"max-content",overflow:"visible",px:"1",color:{_dark:"mantine.colors.gray[4]",_light:"mantine.colors.gray[8]"}}),label:x({overflow:"visible"}),section:x({opacity:.5,userSelect:"none",marginInlineEnd:"0.5"})},children:t})]}),ex=st("div",{base:{color:"mantine.colors.dimmed",fontWeight:500,fontSize:"xxs",userSelect:"none"}}),co=vn({base:{fontSize:"sm",fontWeight:"500",transition:"fast",color:{base:"mantine.colors.text/90",_hover:"[var(--mantine-color-bright)]"}},variants:{truncate:{true:{truncate:!0}},dimmed:{true:{color:{base:"mantine.colors.dimmed",_hover:"mantine.colors.text"}}}}}),td=m.forwardRef((e,t)=>o.jsx(ke,{variant:"filled",size:"xs",fw:"500",...e,ref:t,component:He,layoutId:"trigger-dynamic-walkthrough",className:x({flexShrink:0})}));function tx(){const e=W(),t=Sn();return o.jsx(Fl,{label:"Start Dynamic View Walkthrough",children:o.jsx(td,{onClick:n=>{n.stopPropagation(),t.closeDropdown(),e.startWalkthrough()},size:"compact-xs",h:26,classNames:{label:x({display:{base:"none","@/md":"[inherit]"}}),section:x({marginInlineStart:{base:"0","@/md":"2"}})},rightSection:o.jsx(Dg,{size:10}),children:"Start"})})}function nx({value:e,onChange:t}){return o.jsx(ne,{layout:"position",children:o.jsx(Wi,{size:"xs",value:e,component:ne,onChange:n=>{T(n==="diagram"||n==="sequence","Invalid dynamic view variant"),t(n)},classNames:{label:x({fontSize:"xxs"})},data:[{value:"diagram",label:"Diagram"},{value:"sequence",label:"Sequence"}]})})}function ox(){const e=Ne(n=>n.dynamicViewVariant),t=W();return o.jsxs(o.Fragment,{children:[o.jsx(nx,{value:e,onChange:n=>{t.switchDynamicViewVariant(n)}},"dynamic-view-mode-switcher"),o.jsx(tx,{},"trigger-dynamic-walkthrough")]})}const Ls=ke.withProps({component:He,variant:"light",size:"xs",fw:"500"}),ix=()=>{const{portalProps:e}=en();return o.jsx(Er,{...e,children:o.jsx(J,{css:{position:"absolute",margin:"0",padding:"0",top:"0",left:"0",width:"100%",height:"100%",border:"2px solid",borderColor:"mantine.colors.orange[6]",pointerEvents:"none",md:{borderWidth:4}}})})};function ax(){const e=W(),{isParallel:t,hasNext:n,hasPrevious:i,currentStep:a,totalSteps:s}=Ne(r=>{const l=r.xyedges.findIndex(d=>d.id===r.activeWalkthrough?.stepId);return{isParallel:_e(r.activeWalkthrough?.parallelPrefix),hasNext:l<r.xyedges.length-1,hasPrevious:l>0,currentStep:l+1,totalSteps:r.xyedges.length}});return o.jsxs(Ee,{propagate:!0,children:[o.jsx(td,{variant:"light",size:"xs",color:"orange",mr:"sm",onClick:r=>{r.stopPropagation(),e.stopWalkthrough()},rightSection:o.jsx($g,{size:10}),children:"Stop"},"stop-walkthrough"),o.jsx(Ls,{disabled:!i,onClick:()=>e.walkthroughStep("previous"),leftSection:o.jsx(Tg,{size:10}),children:"Previous"},"prev"),o.jsx(St,{component:ne,size:"md",radius:"sm",variant:t?"gradient":"transparent",gradient:{from:"red",to:"orange",deg:90},rightSection:o.jsx(ne,{className:x({fontSize:"xxs",display:t?"block":"none"}),children:"parallel"}),className:x({alignItems:"baseline"}),children:o.jsxs(hc,{children:[a," / ",s]})},"step-badge"),o.jsx(Ls,{disabled:!n,onClick:()=>e.walkthroughStep("next"),rightSection:o.jsx(Ag,{size:10}),children:"Next"},"next"),t&&o.jsx(ix,{},"parallel-frame")]})}const sx=({context:e})=>{const t=e.viewModel.folder;return{folders:t.isRoot?[]:t.breadcrumbs.map(n=>({folderPath:n.path,title:n.title})),viewId:e.viewModel.id,viewTitle:e.viewModel.titleOrUntitled,isDynamicView:e.viewModel.isDynamicView()}},rx=()=>{const e=Sn(),{enableSearch:t,enableNavigationButtons:n,enableDynamicViewWalkthrough:i}=K(),{folders:a,viewTitle:s,isDynamicView:r}=ee.useSelector(e.actorRef,sx,I),l=a.flatMap(({folderPath:c,title:u},p)=>[o.jsx(fe,{component:He,className:S(co({dimmed:!0,truncate:!0}),"mantine-active",x({userSelect:"none",maxWidth:"200px",display:{base:"none","@/md":"block"}})),title:u,onMouseEnter:()=>e.send({type:"breadcrumbs.mouseEnter.folder",folderPath:c}),onMouseLeave:()=>e.send({type:"breadcrumbs.mouseLeave.folder",folderPath:c}),onClick:g=>{g.stopPropagation(),e.send({type:"breadcrumbs.click.folder",folderPath:c})},children:u},c),o.jsx(Vl,{},`separator-${p}`)]),d=o.jsx(fe,{component:He,className:S("mantine-active",co({truncate:!0}),x({userSelect:"none"})),title:s,onMouseEnter:()=>e.send({type:"breadcrumbs.mouseEnter.viewtitle"}),onMouseLeave:()=>e.send({type:"breadcrumbs.mouseLeave.viewtitle"}),onClick:c=>{c.stopPropagation(),e.send({type:"breadcrumbs.click.viewtitle"})},children:s},"view-title");return o.jsxs(Ee,{propagate:!0,children:[o.jsx(yf,{},"burger-button"),n&&o.jsx(bf,{},"nav-buttons"),o.jsxs(ne,{layout:"position",className:ye({gap:"1",flexShrink:1,flexGrow:1,overflow:"hidden"}),children:[l,d]},"breadcrumbs"),o.jsxs(ne,{layout:"position",className:ye({gap:"0.5",flexGrow:0,_empty:{display:"none"}}),children:[o.jsx(Kf,{onOpen:()=>e.closeDropdown()}),o.jsx(wf,{}),o.jsx(jf,{})]},"actions"),i&&r&&o.jsx(ox,{},"dynamic-view-controls"),t&&o.jsx(vf,{},"search-control")]})},Gt="/",lx=e=>{if(T(!e.includes(`
`),"View title cannot contain newlines"),e.includes(Gt)){const t=e.split(Gt).map(n=>n.trim()).filter(n=>n.length>0);return de(t,1)?t:[""]}return[e.trim()]},nd=e=>lx(e).join(Gt),dx=Symbol.for("nodejs.util.inspect.custom");function As(e,t){return n=>e.source===n.source&&e.target===n.target}function od(e,t,n="directed"){if(e===t)return[];if(rl(e,t))return[];const i=Si(e.allOutgoing,t.allIncoming),a=i.size>0?new Re(e,t,i):null;if(n==="directed")return a?[a]:[];const s=Si(e.allIncoming,t.allOutgoing),r=s.size>0?new Re(t,e,s):null;return a&&r?[a,r]:a?[a]:r?[r]:[]}class Re{constructor(t,n,i=new Set){this.source=t,this.target=n,this.relations=i,this.id=ph(`model:${t.id}:${n.id}`)}id;_boundary;get boundary(){return this._boundary??=this.source.commonAncestor(this.target)}get expression(){return`${this.source.id} -> ${this.target.id}`}get isDirect(){return this.nonEmpty()&&!this.isImplicit}get isImplicit(){return this.nonEmpty()&&ah(this.relations,qr(As(this)))}get directRelations(){return new Set(Vt(this.relations,As(this)))}nonEmpty(){return this.relations.size>0}mergeWith(t){return T(this.source.id===t.source.id,"Cannot merge connections with different sources"),T(this.target.id===t.target.id,"Cannot merge connections with different targets"),new Re(this.source,this.target,dh(this.relations,t.relations))}difference(t){return new Re(this.source,this.target,ch(this.relations,t.relations))}intersect(t){return T(t instanceof Re,"Cannot intersect connection with different type"),new Re(this.source,this.target,Si(this.relations,t.relations))}equals(t){T(t instanceof Re,"Cannot merge connection with different type");const n=t;return this.id===n.id&&this.source.id===n.source.id&&this.target.id===n.target.id&&uh(this.relations,n.relations)}update(t){return new Re(this.source,this.target,t)}[dx](t,n,i){const a=this.toString();return Object.defineProperty(a,"constructor",{value:Re,enumerable:!1}),a}toString(){return[this.expression,this.relations.size?"  relations:":"  relations: [ ]",...[...this.relations].map(t=>"    "+t.expression)].join(`
`)}reversed(t=!1){if(!t)return new Re(this.target,this.source);const[n]=od(this.target,this.source,"directed");return n??new Re(this.target,this.source,new Set)}}const Ri=m.forwardRef(({className:e,truncateLabel:t=!0,...n},i)=>o.jsx(Xd,{...n,component:"button",classNames:Um({truncateLabel:t}),className:S("group","mantine-active",e),ref:i}));Ri.displayName="NavigationLink";const id=e=>{const{enableNavigateTo:t}=K(),n=W(),{navigateTo:i}=e.data;return i&&t?o.jsx(Cf,{onClick:a=>{a.stopPropagation(),n.navigateTo(i,e.id)},...e}):null},ad=({extraButtons:e,...t})=>{const{enableNavigateTo:n,enableRelationshipBrowser:i}=K(),a=W(),{navigateTo:s,modelFqn:r}=t.data;let l=m.useMemo(()=>{const d=[];return s&&n&&d.push({key:"navigate",icon:o.jsx(Ae,{}),onClick:c=>{c.stopPropagation(),a.navigateTo(s,t.data.id)}}),i&&d.push({key:"relationships",icon:o.jsx(kn,{}),onClick:c=>{c.stopPropagation(),a.openRelationshipsBrowser(r)}}),d},[n,i,a,r,s,t.data.id]);return e&&de(e,1)&&(l=[...l,...e]),o.jsx(Bo,{...t,buttons:l})},cx=({extraButtons:e,...t})=>{const{enableNavigateTo:n,enableRelationshipBrowser:i}=K(),a=W(),{id:s,navigateTo:r,modelFqn:l}=t.data;let d=m.useMemo(()=>{const c=[];return r&&n&&c.push({key:"navigate",icon:o.jsx(Ae,{}),onClick:u=>{u.stopPropagation(),a.navigateTo(r,s)}}),i&&l&&c.push({key:"relationships",icon:o.jsx(kn,{}),onClick:u=>{u.stopPropagation(),a.openRelationshipsBrowser(l)}}),c},[n,i,a,l,r,s]);return e&&de(e,1)&&(d=[...d,...e]),o.jsx(Bo,{...t,buttons:d})},zs=["primary","secondary","muted"],sd=Me.withProps({color:"dark",fz:"xs",openDelay:400,closeDelay:150,label:"",children:null,offset:4,withinPortal:!1});function Lo(e,t){const{onChange:n}=at(),i=W(),[a,s]=m.useState(null),r=B(d=>{if(d===null){T(a,"originalColor is null"),s(null),i.updateNodeData(t.data.id,{color:a});return}s(c=>c??t.data.color),i.updateNodeData(t.data.id,{color:d})}),l=B(d=>{n?.({change:{op:"change-element-style",style:d,targets:[e]}});const{shape:c,color:u,...p}=d;i.updateNodeData(t.data.id,{...c&&{shape:c},...u&&{color:u},style:p})});return{elementColor:a??t.data.color,onColorPreview:r,onChange:l}}function Ao({fqn:e}){const t=W();return o.jsx(sd,{label:"Browse relationships",children:o.jsx(Z,{size:"sm",variant:"subtle",color:"gray",onClick:n=>{n.stopPropagation(),t.openRelationshipsBrowser(e)},children:o.jsx(kn,{stroke:2,style:{width:"72%",height:"72%"}})})})}function zo(e){const{onOpenSource:t}=at();return t?o.jsx(sd,{label:"Open source",children:o.jsx(Z,{size:"sm",variant:"subtle",color:"gray",onClick:n=>{n.stopPropagation(),e.elementId?t?.({element:e.elementId}):e.deploymentId&&t?.({deployment:e.deploymentId})},children:o.jsx(Ut,{stroke:1.8,style:{width:"70%"}})})}):null}function $o({elementColor:e,elementOpacity:t,onColorPreview:n,isOpacityEditable:i=!1,onChange:a,...s}){const{theme:r}=Wl();return o.jsxs(ot,{clickOutsideEvents:["pointerdown","mousedown","click"],position:"right-end",offset:2,withinPortal:!1,...s,children:[o.jsx(Zt,{children:o.jsx(ke,{variant:"subtle",color:"gray",size:"compact-xs",px:3,children:o.jsx(wi,{color:r.colors[e].elements.fill,size:14,withShadow:!0,style:{color:"#fff",cursor:"pointer"}})})}),o.jsxs(Kt,{p:"xs",children:[o.jsx(ux,{theme:r,elementColor:e,onColorPreview:n,onChange:l=>a({color:l})}),i&&o.jsxs(o.Fragment,{children:[o.jsx(Ha,{h:"xs"}),o.jsx(wo,{label:"opacity",labelPosition:"left"}),o.jsx(Ha,{h:"xs"}),o.jsx(px,{elementOpacity:t,onOpacityChange:l=>{a({opacity:l})}})]})]})]})}function ux({theme:e,elementColor:t,onColorPreview:n,onChange:i}){const a=r=>l=>{l.stopPropagation(),n(null),t!==r&&i(r)},s=$i(e.colors).filter(r=>!zs.includes(r));return o.jsx(Te,{gap:2,onMouseLeave:()=>n(null),children:o.jsxs(vo,{openDelay:1e3,closeDelay:300,children:[o.jsx(oo,{maw:120,gap:"6",justify:"flex-start",align:"flex-start",direction:"row",wrap:"wrap",children:zs.map(r=>o.jsx(Me,{label:r,fz:"xs",color:"dark",offset:2,withinPortal:!1,transitionProps:{duration:140,transition:"slide-up"},children:o.jsx(wi,{color:e.colors[r].elements.fill,size:18,withShadow:!0,onMouseEnter:()=>n(r),onClick:a(r),style:{color:"#fff",cursor:"pointer"},children:t===r&&o.jsx(qa,{style:{width:tt(10),height:tt(10)}})})},r))}),o.jsx(oo,{mt:"sm",maw:110,gap:"6",justify:"flex-start",align:"flex-start",direction:"row",wrap:"wrap",children:s.map(r=>o.jsx(Me,{label:r,fz:"xs",color:"dark",offset:2,transitionProps:{duration:140,transition:"slide-up"},children:o.jsx(wi,{color:e.colors[r].elements.fill,size:18,onMouseEnter:()=>n(r),onClick:a(r),style:{color:"#fff",cursor:"pointer"},children:t===r&&o.jsx(qa,{style:{width:tt(10),height:tt(10)}})})},r))})]})})}function px({elementOpacity:e=100,onOpacityChange:t}){const[n,i]=m.useState(e);return yr(()=>{i(e)},[e]),o.jsx(mu,{size:"sm",color:"dark",value:n,onChange:i,onChangeEnd:t})}const gx=x({color:"mantine.colors.dimmed",fontSize:"10px",fontWeight:600,maxWidth:"220px",cursor:"default",userSelect:"all",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),hx=()=>Ne(e=>e.xynodes.filter(t=>t.selected).length);function Fo({title:e,children:t,nodeProps:n,...i}){const a=hx(),{selected:s=!1,dragging:r=!1,data:{hovered:l=!1}}=n,d=l&&a===0||s&&a===1;let c=150;d?s?c=100:c=1e3:a>0&&(c=50);const[u]=Qi(d,c);return u?o.jsx(fr,{isVisible:!r,offset:4,...i,children:o.jsx(qi,{className:S("nodrag","nopan"),px:5,pb:8,pt:4,radius:"sm",shadow:"xl",onDoubleClickCapture:ie,onPointerDown:ie,onClick:ie,onDoubleClick:ie,withBorder:!0,children:o.jsxs(Te,{gap:"6px",children:[o.jsx(X,{px:"4px",children:o.jsx(z,{className:gx,children:e})}),o.jsx(oe,{gap:4,children:t})]})})}):null}function mx(e){const{enableVscode:t,enableRelationshipBrowser:n}=K(),{data:{style:i,modelFqn:a}}=e,{elementColor:s,onColorPreview:r,onChange:l}=Lo(a,e),d=i?.opacity??100;return o.jsxs(Fo,{nodeProps:e,title:a,align:"start",children:[o.jsx($o,{elementColor:s,onColorPreview:r,isOpacityEditable:!0,elementOpacity:d,onChange:l,position:"left-start"}),o.jsx(rd,{elementBorderStyle:i?.border??(d<99?"dashed":"none"),onChange:l}),t&&o.jsx(zo,{elementId:a}),n&&o.jsx(Ao,{fqn:a})]})}function fx(e){const{enableVscode:t,enableRelationshipBrowser:n}=K(),{data:{deploymentFqn:i,style:a,modelFqn:s}}=e,{elementColor:r,onColorPreview:l,onChange:d}=Lo(i,e);return o.jsxs(Fo,{nodeProps:e,title:i,align:"start",children:[o.jsx($o,{elementColor:r,onColorPreview:l,isOpacityEditable:!0,elementOpacity:a?.opacity,onChange:d,position:"left-start"}),o.jsx(rd,{elementBorderStyle:a?.border,onChange:d}),t&&o.jsx(zo,{deploymentId:i}),n&&s&&o.jsx(Ao,{fqn:s})]})}function rd({elementBorderStyle:e="dashed",onChange:t}){const[n,i]=m.useState(e);return m.useEffect(()=>{i(e)},[e]),o.jsx(X,{children:o.jsx(Wi,{size:"xs",fullWidth:!0,withItemsBorders:!1,value:n,onChange:a=>{const s=a;i(s),t({border:s})},styles:{label:{paddingTop:"0.5",paddingBottom:"0.5"}},data:[{label:"Solid",value:"solid"},{label:"Dashed",value:"dashed"},{label:"Dotted",value:"dotted"},{label:"None",value:"none"}]})})}function xx(e){const{enableVscode:t,enableRelationshipBrowser:n}=K(),{data:{shape:i,modelFqn:a}}=e,{elementColor:s,onColorPreview:r,onChange:l}=Lo(a,e);return o.jsxs(Fo,{nodeProps:e,title:a,align:"start",children:[o.jsx(ld,{elementShape:i,onChange:l}),o.jsx($o,{elementColor:s,onColorPreview:r,onChange:l,position:"right-end"}),t&&o.jsx(zo,{elementId:a}),n&&o.jsx(Ao,{fqn:a})]})}function yx(e){const{enableVscode:t,enableRelationshipBrowser:n}=K(),{data:{shape:i,deploymentFqn:a,modelFqn:s}}=e,{elementColor:r,onColorPreview:l,onChange:d}=Lo(a,e);return o.jsxs(Fo,{nodeProps:e,title:a,align:"start",children:[o.jsx(ld,{elementShape:i,onChange:d}),o.jsx($o,{elementColor:r,onColorPreview:l,onChange:d,position:"right-end"}),t&&o.jsx(zo,{deploymentId:a}),n&&s&&o.jsx(Ao,{fqn:s})]})}function ld({elementShape:e,onChange:t}){return o.jsxs(zt,{openDelay:300,closeDelay:450,floatingStrategy:"fixed",closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],closeOnEscape:!0,closeOnItemClick:!1,position:"top-start",offset:2,styles:{item:{padding:"calc(var(--mantine-spacing-xs) / 1.5) var(--mantine-spacing-xs)"}},withinPortal:!1,children:[o.jsx(Lr,{children:o.jsx(ke,{variant:"light",color:"gray",size:"compact-xs",rightSection:o.jsx(da,{size:12}),children:e})}),o.jsx(Ar,{onDoubleClick:ie,onClick:ie,children:vh.map(n=>o.jsx(zr,{fz:12,fw:500,value:n,rightSection:e===n?o.jsx(ol,{size:12}):void 0,onClick:i=>{i.stopPropagation(),t({shape:n})},children:n},n))})]})}function Pa(e){const{enableElementDetails:t}=K(),n=W(),i=e.data.modelFqn;return!t||!i?null:o.jsx(Ca,{...e,onClick:a=>{a.stopPropagation(),n.openElementDetails(i,e.id)}})}function dd(e){const{enableElementDetails:t}=K(),n=W(),i=e.data.modelFqn;return!t||!i?null:o.jsx(Xl,{...e,onClick:a=>{a.stopPropagation(),n.openElementDetails(i,e.id)}})}function bx(e){const{enableElementTags:t,enableReadOnly:n}=K();return o.jsxs(tn,{nodeProps:e,children:[o.jsx(nn,{...e}),o.jsx(Ge,{...e}),t&&o.jsx(Nn,{...e}),o.jsx(ad,{...e}),o.jsx(Pa,{...e}),!n&&o.jsx(xx,{...e}),o.jsx(In,{})]})}function wx(e){const{enableElementTags:t,enableReadOnly:n}=K();return o.jsxs(tn,{nodeProps:e,children:[o.jsx(nn,{...e}),o.jsx(Ge,{...e}),t&&o.jsx(Nn,{...e}),o.jsx(cx,{...e}),o.jsx(Pa,{...e}),!n&&o.jsx(yx,{...e}),o.jsx(In,{})]})}function vx(e){const{enableElementDetails:t,enableReadOnly:n}=K();return o.jsxs(_n,{nodeProps:e,children:[o.jsx(Pn,{...e}),o.jsx(id,{...e}),t&&o.jsx(dd,{...e}),!n&&o.jsx(mx,{...e}),o.jsx(In,{})]})}function kx(e){const{enableElementDetails:t,enableReadOnly:n}=K();return o.jsxs(_n,{nodeProps:e,children:[o.jsx(Pn,{...e}),o.jsx(id,{...e}),t&&o.jsx(dd,{...e}),!n&&o.jsx(fx,{...e}),o.jsx(In,{})]})}function jx(e){return o.jsxs(_n,{nodeProps:e,children:[o.jsx(Pn,{...e}),o.jsx(In,{})]})}const Cx={left:pe.Left,right:pe.Right,top:pe.Top,bottom:pe.Bottom},Sx=({data:e,port:t})=>o.jsxs(o.Fragment,{children:[o.jsx(J,{"data-likec4-color":e.color,className:x({position:"absolute",backgroundColor:"var(--likec4-palette-fill)",rounded:"xs",width:{base:"5px",_whenHovered:"7px",_whenSelected:"7px"},transition:"fast",translateX:"-1/2",translateY:"-1/2",translate:"auto"}),style:{top:t.cy,left:t.cx,height:t.height}}),o.jsx(Pe,{id:t.id,type:t.type,position:Cx[t.position],style:{top:t.cy-3,left:t.cx-3,width:6,height:6,right:"unset",bottom:"unset",visibility:"hidden",transform:t.position==="left"?"translate(-150%, 0)":"translate(100%, 0)"}})]}),_x=e=>_e(e.modelFqn);function Px(e){const t=e.data,{positionAbsoluteY:n,data:{viewHeight:i,hovered:a=!1,ports:s}}=e;return o.jsxs(o.Fragment,{children:[o.jsx(J,{"data-likec4-color":"gray",className:x({position:"absolute",rounded:"xs",top:"1",pointerEvents:"none",transition:"fast",translateX:"-1/2",translate:"auto"}),style:{backgroundColor:"var(--likec4-palette-stroke)",opacity:a?.6:.4,left:"50%",width:a?3:2,height:i-n,zIndex:-1,pointerEvents:"none"}}),o.jsxs(tn,{nodeProps:e,children:[o.jsx(nn,{...e}),o.jsx(Ge,{...e}),_x(t)&&o.jsxs(o.Fragment,{children:[o.jsx(ad,{...e,data:t}),o.jsx(Pa,{...e,data:t})]})]}),s.map(r=>o.jsx(Sx,{port:r,data:e.data},r.id))]})}function Mx(e){return o.jsx(J,{"data-likec4-color":e.data.color,css:{width:"100%",height:"100%",border:"default",rounded:"sm",borderWidth:1,"--_color":{base:"var(--likec4-palette-stroke)",_dark:"[color-mix(in srgb, var(--likec4-palette-hiContrast) 40%, var(--likec4-palette-fill))]"},borderColor:"[var(--_color)/30]",backgroundColor:"var(--likec4-palette-fill)/15",pointerEvents:"none",paddingLeft:"2",paddingTop:"0.5",fontSize:"xs",fontWeight:"bold",letterSpacing:".75px",color:"[var(--_color)/75]"},children:"PARALLEL"})}const Vn="--_blur",On="--_opacity",Ex="--_level",uo=m.forwardRef(({onClose:e,className:t,classes:n,overlayLevel:i=0,children:a,fullscreen:s=!1,withBackdrop:r=!0,backdrop:l,openDelay:d=130,...c},u)=>{const[p,g]=m.useState(d===0),f=Yd(p),y=m.useRef(null),b=m.useRef(!1),C=xr()!==!0,k=m.useRef(e);k.current=e;const v=Vi(()=>{b.current||(b.current=!0,k.current())},[],50);m.useLayoutEffect(()=>{y.current?.open||y.current?.showModal()},[]),Jn(()=>{g(!0)},d>0?d:void 0);const M=$m({fullscreen:s,withBackdrop:r});let w=i>0?"50%":"60%";return l?.opacity!==void 0&&(w=`${l.opacity*100}%`),o.jsx(Oe.dialog,{ref:Oi(y,f,u),className:S(n?.dialog,t,M,s&&eo.classNames.fullWidth),layout:!0,style:{[Ex]:i},...C?{initial:{[Vn]:"0px",[On]:"0%",scale:.95,originY:0,translateY:-20,opacity:0},animate:{[Vn]:i>0?"4px":"8px",[On]:w,scale:1,opacity:1,translateY:0,transition:{delay:.075}},exit:{opacity:0,scale:.98,translateY:-20,transition:{duration:.1},[Vn]:"0px",[On]:"0%"}}:{initial:{[Vn]:"8px",[On]:w}},onClick:j=>{if(j.stopPropagation(),j.target?.nodeName?.toUpperCase()==="DIALOG"){y.current?.close();return}},onCancel:j=>{j.preventDefault(),j.stopPropagation(),v()},onDoubleClick:ie,onPointerDown:ie,onClose:j=>{j.stopPropagation(),v()},...c,children:o.jsx(eo,{forwardProps:!0,children:o.jsx("div",{className:S(n?.body,"likec4-overlay-body"),children:p&&o.jsx(o.Fragment,{children:a})})})})});uo.displayName="Overlay";function Nx({children:e}){const t=m.useContext(ma);if(!t)throw new Error("PortalToContainer must be used within RootContainer");return o.jsx(Er,{target:t.ref.current??`#${t.id}`,children:e})}function Ix(e){const{projects:t,onProjectChange:n}=df(),i=cf();return t.length<=1?null:o.jsxs(ae,{gap:"0.5",alignItems:"baseline",children:[o.jsx(J,{css:{fontWeight:"400",fontSize:"xxs",color:"mantine.colors.dimmed",userSelect:"none"},children:"Project"}),o.jsxs(zt,{withinPortal:!1,shadow:"md",position:"bottom-start",offset:{mainAxis:2},children:[o.jsx(Lr,{children:o.jsx(ke,{tabIndex:-1,autoFocus:!1,variant:"subtle",size:"compact-xs",color:"gray",classNames:{root:x({fontWeight:"400",fontSize:"xxs",height:"auto",lineHeight:1.1,color:{_light:"mantine.colors.gray[9]"}}),section:x({'&:is([data-position="right"])':{marginInlineStart:"1"}})},rightSection:o.jsx(kp,{opacity:.5,size:12,stroke:1.5}),...e,children:i})}),o.jsx(Ar,{children:t.map(({id:a,title:s})=>o.jsx(zr,{onClick:r=>{if(i===a){r.stopPropagation();return}n(a)},children:s??a},a))})]})]})}const cd=kr({siblingSelector:"[data-likec4-focusable]",parentSelector:"[data-likec4-breadcrumbs-dropdown]",activateOnFocus:!1,loop:!0,orientation:"vertical"});function Rx(){const e=Sn(),t=ee.useSelector(e.actorRef,a=>a.context.searchQuery);$e("paneClick",()=>{e.closeDropdown()}),$e("nodeClick",()=>{e.closeDropdown()});const n=gc(a=>{e.send({type:"searchQuery.change",value:a})},250),i=t.trim().length>=2;return o.jsxs(Kt,{className:S("nowheel",Cn({layerStyle:"likec4.dropdown",gap:"xs",pointerEvents:"all"})),"data-likec4-breadcrumbs-dropdown":!0,onMouseLeave:()=>e.send({type:"dropdown.mouseLeave"}),onMouseEnter:()=>e.send({type:"dropdown.mouseEnter"}),children:[o.jsx(Ix,{}),o.jsx(ae,{gap:"xs",children:o.jsx(Wx,{value:t,onChange:n,"data-likec4-focusable":!0,onKeyDown:cd})}),o.jsx(Xe,{scrollbars:"x",type:"auto",offsetScrollbars:"present",classNames:{root:x({maxWidth:["calc(100vw - 50px)","calc(100cqw - 50px)"]})},styles:{viewport:{overscrollBehavior:"none"}},children:i?o.jsx(Bx,{searchQuery:nd(t).toLowerCase()}):o.jsx(Fx,{})})]})}const Dx=Jg(Gt);function Bx({searchQuery:e}){const t=be(),n=Sn(),i=e.includes(Gt),a=re(t.views(),Vt(r=>i&&r.$view.title?nd(r.$view.title).toLowerCase().includes(e):r.id.toLowerCase().includes(e)||!!r.title?.toLowerCase().includes(e)),oh(20),mn(),Nc((r,l)=>Dx(r.folder.path,l.folder.path)));if(a.length===0)return o.jsx("div",{children:"no results"});const s=i?e.split(Gt):e;return o.jsx(Xe,{scrollbars:"xy",offsetScrollbars:!1,className:x({width:"100%",maxWidth:["calc(100vw - 250px)","calc(100cqw - 250px)"],maxHeight:["calc(100vh - 200px)","calc(100cqh - 200px)"]}),children:o.jsx(Qt,{gap:"0.5",children:a.map(r=>o.jsx(Lx,{view:r,highlight:s,onClick:l=>{l.stopPropagation(),n.selectView(r.id)},"data-likec4-focusable":!0,onKeyDown:cd},r.id))})})}const Tx=ye({gap:"xxs",rounded:"sm",px:"xs",py:"xxs",_hover:{backgroundColor:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]"}},_focus:{outline:"none",color:"mantine.colors.primary.lightColor!",backgroundColor:"mantine.colors.primary.lightHover!"}}),$s=x({_groupFocus:{color:"[inherit!]",transition:"none"}});function Lx({view:e,highlight:t,...n}){const i=e.folder,a=pd[e.id==="index"?"index":e._type],s=o.jsx(jt,{component:"div",className:S($s,co({truncate:!0}),x({"& > mark":{backgroundColor:{base:"mantine.colors.yellow[2]/90",_dark:"mantine.colors.yellow[5]/80",_groupFocus:"[transparent]"},color:{_groupFocus:"[inherit!]"}}})),maw:350,highlight:t,children:e.title??e.id},e.id),r=S(n.className,"group",Tx);if(i.isRoot)return o.jsxs(fe,{...n,className:r,children:[a,s]});const l=i.breadcrumbs.map(d=>o.jsx(jt,{component:"div",className:S(x({_groupHover:{color:"mantine.colors.dimmed"}}),$s,co({dimmed:!0,truncate:!0})),maw:170,highlight:bi(t)?t:[],children:d.title},d.path));return l.push(o.jsxs(ae,{gap:"[4px]",children:[a,s]})),o.jsxs(fe,{...n,className:r,children:[ud,o.jsx(hr,{separator:o.jsx(It,{size:12,stroke:1.5}),separatorMargin:3,children:l})]})}const Ax=o.jsx(It,{size:12,stroke:1.5,className:"mantine-rotate-rtl"}),ud=o.jsx(Ig,{size:16,className:x({opacity:{base:.3,_groupHover:.5,_groupActive:.5,_groupFocus:.5}})}),Wn=x({opacity:{base:.3,_dark:.5,_groupHover:.8,_groupActive:.8,_groupFocus:.8}}),pd={index:o.jsx(Vg,{size:16,className:Wn}),element:o.jsx(Ae,{size:18,stroke:2,className:Wn}),deployment:o.jsx(ca,{size:16,stroke:1.5,className:Wn}),dynamic:o.jsx(Eg,{size:18,className:Wn})},zx=Xe.withProps({scrollbars:"y",className:x({maxHeight:["calc(100vh - 160px)","calc(100cqh - 160px)"]})});function Fs(e,t){return{folderPath:e.path,items:[...e.folders.map(n=>({type:"folder",folderPath:n.path,title:n.title,selected:t.selectedFolder.startsWith(n.path)})),...e.views.map(n=>({type:"view",viewType:n.id==="index"?"index":n._type,viewId:n.id,title:n.title??n.id,description:n.description.nonEmpty&&n.description.text||null,selected:n.id===t.viewModel.id}))]}}const $x=e=>{const t=e.viewModel.$model,n=[Fs(t.rootViewFolder,e)],i=t.viewFolder(e.selectedFolder);if(!i.isRoot)for(const a of i.breadcrumbs)n.push(Fs(a,e));return n};function Fx(){const e=mf($x,I);return o.jsx(ae,{gap:"xs",alignItems:"stretch",children:e.flatMap((t,n)=>[n>0&&o.jsx(wo,{orientation:"vertical"},"divider"+n),o.jsx(Vx,{data:t,isLast:n==e.length-1},t.folderPath)])})}function Vx({data:e,isLast:t}){const n=m.useRef(null),i=ja(),a=s=>r=>{r.stopPropagation(),s.type==="folder"?i.send({type:"select.folder",folderPath:s.folderPath}):i.send({type:"select.view",viewId:s.viewId})};return Vc(()=>{t&&n.current&&n.current.scrollIntoView({inline:"nearest",behavior:"smooth"})}),o.jsx(J,{mb:"1",ref:n,children:o.jsx(zx,{children:o.jsx(Qt,{gap:"0.5",children:e.items.map((s,r)=>o.jsx(Ox,{columnItem:s,onClick:a(s)},`${e.folderPath}/${s.type}/${r}`))})})})}function Ox({columnItem:e,...t}){switch(e.type){case"folder":return o.jsx(Ri,{variant:"light",active:e.selected,label:e.title,leftSection:ud,rightSection:Ax,maw:"300px",miw:"200px",...t},e.folderPath);case"view":return o.jsx(Ri,{variant:"filled",active:e.selected,label:e.title,description:e.description,leftSection:pd[e.viewType],maw:"300px",miw:"200px",...t},e.viewId);default:Le(e)}}function Wx({onKeyDown:e,...t}){const[n,i]=mr({...t,finalValue:""});return o.jsx(mi,{size:"xs",placeholder:"Search by title or id",variant:"unstyled",height:tt(26),value:n,onKeyDown:e,onChange:a=>i(a.currentTarget.value),classNames:{wrapper:x({flexGrow:1,backgroundColor:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]/80",_hover:{base:"mantine.colors.gray[2]",_dark:"mantine.colors.dark[4]"},_focus:{base:"mantine.colors.gray[2]",_dark:"mantine.colors.dark[4]"}},rounded:"sm"}),input:x({_placeholder:{color:"mantine.colors.dimmed"},_focus:{outline:"none"}})},style:{"--input-fz":"var(--mantine-font-size-sm)"},leftSection:o.jsx(la,{size:14}),rightSectionPointerEvents:"all",rightSectionWidth:"min-content",rightSection:!t.value||ut(t.value)?null:o.jsx(ke,{variant:"subtle",h:"100%",size:"compact-xs",color:"gray",onClick:a=>{a.stopPropagation(),i("")},children:"clear"})})}const Hx=st("div",{base:{fontSize:"xs",color:"mantine.colors.dimmed",fontWeight:500,userSelect:"none",mb:"xxs"}});function qx(e){const t=Fc(e.activeWalkthrough),n=t?e.xyedges.findIndex(i=>i.id===e.activeWalkthrough?.stepId):-1;return{isActive:t,isParallel:t&&_e(e.activeWalkthrough?.parallelPrefix),hasNext:t&&n<e.xyedges.length-1,hasPrevious:t&&n>0,notes:t?e.xyedges[n]?.data?.notes??te.EMPTY:null}}const Xx=()=>{const{notes:e}=Ne(qx);return!e||e.isEmpty?null:o.jsx(st.div,{position:"relative",children:o.jsxs(Xe,{className:S("nowheel nopan nodrag",Cn({position:"absolute",layerStyle:"likec4.dropdown",gap:"sm",padding:"md",paddingTop:"xxs",pointerEvents:"all",maxWidth:"calc(100cqw - 32px)",minWidth:"calc(100cqw - 50px)",maxHeight:"calc(100cqh - 100px)",width:"max-content",cursor:"default",overflow:"auto",overscrollBehavior:"contain","@/sm":{minWidth:400,maxWidth:550},"@/lg":{maxWidth:700}})),type:"scroll",children:[o.jsx(Hx,{children:"Notes"}),o.jsx(Et,{value:e,fontSize:"sm",emptyText:"No description",className:x({userSelect:"all"})})]})})},gd=m.memo(()=>{const e=Jt(),t=Pl(),n=ee.useActorRef(Rm,{input:{viewModel:t}});return m.useEffect(()=>{const i=n.on("navigateTo",a=>{e.getSnapshot().context.view.id!==a.viewId&&e.send({type:"navigate.to",viewId:a.viewId})});return()=>i.unsubscribe()},[n,e]),yr(()=>{n.send({type:"update.inputs",inputs:{viewModel:t}})},[t]),o.jsx(Qt,{css:{alignItems:"flex-start",pointerEvents:"none",position:"absolute",top:"0",left:"0",margin:"0",width:"100%",gap:"xxs",maxWidth:["calc(100vw)","calc(100cqw)"],"@/sm":{margin:"xs",gap:"xs",width:"max-content",maxWidth:["calc(100vw - 2 * {spacing.md})","calc(100cqw - 2 * {spacing.md})"]}},children:o.jsxs(hf,{value:n,children:[o.jsx(Yx,{actor:n}),o.jsx(gf,{}),o.jsx(Xx,{})]})})});gd.displayName="NavigationPanel";const Yx=({actor:e})=>{const t=ee.useSelector(e,i=>i.hasTag("active")),n=en();return o.jsxs(ot,{offset:{mainAxis:4},opened:t,position:"bottom-start",trapFocus:!0,...n,clickOutsideEvents:["pointerdown","mousedown","click"],onDismiss:()=>e.send({type:"dropdown.dismiss"}),children:[o.jsx(Gx,{actor:e}),t&&o.jsx(Rx,{})]})},Gx=({actor:e})=>{const t=Ne(n=>n.activeWalkthrough!==null);return o.jsx(Wt,{children:o.jsx(Zt,{children:o.jsx(ne,{layout:!0,className:ye({layerStyle:"likec4.panel",position:"relative",gap:"xs",cursor:"pointer",paddingRight:"md",pointerEvents:"all",width:"100%"}),onMouseLeave:()=>e.send({type:"breadcrumbs.mouseLeave"}),children:o.jsx(Ee,{mode:"popLayout",children:t?o.jsx(ax,{}):o.jsx(rx,{})})})})})},Ma=m.createContext(null);Ma.displayName="ElementDetailsActorContext";const Zx=()=>{const e=m.useContext(Ma);if(e===null)throw new Error("ElementDetailsActorRef is not provided");return e},Kn="--_blur",Un="--_opacity",Kx=x({boxSizing:"border-box",margin:"0",padding:"0",position:"fixed",inset:"0",width:"100vw",height:"100vh",maxWidth:"100vw",maxHeight:"100vh",background:"transparent",border:"transparent",_backdrop:{backdropFilter:"auto",backdropBlur:`var(${Kn})`,backgroundColor:`[rgb(36 36 36 / var(${Un}, 5%))]`}}),Ux=x({position:"absolute",pointerEvents:"all",display:"flex",flexDirection:"column",padding:"4",gap:"lg",justifyContent:"stretch",color:"mantine.colors.text",backgroundColor:{base:"mantine.colors.body",_dark:"mantine.colors.dark[6]"},boxShadow:"md",overflow:"hidden",border:"none",backgroundImage:`
    linear-gradient(180deg,
      color-mix(in srgb, var(--likec4-palette-fill) 60%, transparent),
      color-mix(in srgb, var(--likec4-palette-fill) 20%, transparent) 8px,
      color-mix(in srgb, var(--likec4-palette-fill) 14%, transparent) 20px,
      transparent 80px
    ),
    linear-gradient(180deg, var(--likec4-palette-fill), var(--likec4-palette-fill) 4px, transparent 4px)
  `,"& .react-flow__attribution":{display:"none"}}),Qx=x({flex:0,cursor:"move"}),Jx=x({display:"block",fontFamily:"likec4.element",fontOpticalSizing:"auto",fontStyle:"normal",fontWeight:600,fontSize:"24px",lineHeight:"xs"}),ii="40px",ey=x({flex:`0 0 ${ii}`,height:ii,width:ii,display:"flex",alignItems:"center",justifyContent:"center",alignSelf:"flex-start",cursor:"move",_dark:{mixBlendMode:"hard-light"},"& :where(svg, img)":{width:"100%",height:"auto",maxHeight:"100%",pointerEvents:"none",filter:`
    drop-shadow(0 0 3px rgb(0 0 0 / 10%))
    drop-shadow(0 1px 8px rgb(0 0 0 / 5%))
    drop-shadow(1px 1px 16px rgb(0 0 0 / 2%))
  `},"& img":{objectFit:"contain"}}),Qn="--view-title-color",Hn="--icon-color",ty=x({width:"100%",background:"mantine.colors.body",borderRadius:"sm",padding:"[10px 8px]",transition:"fast",border:"1px dashed",borderColor:"mantine.colors.defaultBorder",[Qn]:"{colors.mantine.colors.dark[1]}",_hover:{background:"mantine.colors.defaultHover",[Hn]:"{colors.mantine.colors.dark[1]}",[Qn]:"{colors.mantine.colors.defaultColor}"},_dark:{background:"mantine.colors.dark[6]"},_light:{[Hn]:"{colors.mantine.colors.gray[6]}",[Qn]:"{colors.mantine.colors.gray[7]}",_hover:{[Hn]:"{colors.mantine.colors.gray[7]}"}},"& .mantine-ThemeIcon-root":{transition:"fast",color:`[var(${Hn}, {colors.mantine.colors.dark[2]})]`,"--ti-size":"22px",_hover:{color:"mantine.colors.defaultColor"}},"& > *":{transition:"all 130ms {easings.inOut}"},"&:hover > *":{transitionTimingFunction:"out",transform:"translateX(1.6px)"}}),ny=x({transition:"fast",color:`[var(${Qn}, {colors.mantine.colors.gray[7]})]`,fontSize:"15px",fontWeight:500,lineHeight:"1.4"}),oy=x({flex:1,display:"flex",flexDirection:"column",justifyContent:"stretch",overflow:"hidden",gap:"sm"}),iy=x({background:"mantine.colors.gray[1]",borderRadius:"sm",flexWrap:"nowrap",gap:"1.5",padding:"1",_dark:{background:"mantine.colors.dark[7]"}}),ay=x({fontSize:"xs",fontWeight:500,flexGrow:1,padding:"[6px 8px]",transition:"fast",borderRadius:"sm",color:"mantine.colors.gray[7]",_hover:{transitionTimingFunction:"out",color:"mantine.colors.defaultColor",background:"mantine.colors.gray[3]"},"&[data-active]":{transition:"none",background:"mantine.colors.white",shadow:"xs",color:"mantine.colors.defaultColor"},_dark:{color:"mantine.colors.dark[1]",_hover:{color:"mantine.colors.white",background:"mantine.colors.dark[6]"},"&:is([data-active])":{color:"mantine.colors.white",background:"mantine.colors.dark[5]"}}}),sy=x({flex:1,overflow:"hidden",position:"relative","&:not(:has(.mantine-ScrollArea-root))":{paddingLeft:"1",paddingRight:"1"},"& .mantine-ScrollArea-root":{width:"100%",height:"100%","& > div":{paddingLeft:"1",paddingRight:"1"}}}),ry=x({flex:1,display:"grid",gridTemplateColumns:"min-content 1fr",gridAutoRows:"min-content max-content",gap:"[24px 20px]",alignItems:"baseline",justifyItems:"stretch"}),ly=x({justifySelf:"end",textAlign:"right",userSelect:"none"}),dy=x({position:"absolute",width:"14px",height:"14px",border:"3.5px solid",borderColor:"mantine.colors.dark[3]",borderTop:"none",borderLeft:"none",borderRadius:"2px",bottom:"0.5",right:"0.5",transition:"fast",cursor:"se-resize",_hover:{borderWidth:"4px",borderColor:"mantine.colors.dark[1]"}}),cy=x({"&[data-level='1']":{marginBottom:"sm"}}),uy=x({cursor:"default",marginTop:"0",marginBottom:"0"}),hd=x({transition:"fast",color:"mantine.colors.gray[7]",_dark:{color:"mantine.colors.dark[1]"},"& > *":{transition:"fast"},_hover:{transitionTimingFunction:"out","& > :not([data-no-transform])":{transitionTimingFunction:"out",transform:"translateX(1px)"}}}),py=S(hd),gy=S(hd,x({cursor:"pointer",width:"100%",justifyContent:"stretch",flexWrap:"nowrap",height:"36px",paddingInlineStart:"[16px]",paddingInlineEnd:"2.5",borderRadius:"sm",alignItems:"center",color:"mantine.colors.gray[7]",_dark:{color:"mantine.colors.gray.lightColor"},_hover:{background:"mantine.colors.gray.lightHover"},"& .tabler-icon":{transition:"fast",width:"90%",opacity:.65}})),hy=({node:e})=>o.jsxs(oe,{className:py,gap:6,align:"baseline",wrap:"nowrap",children:[o.jsxs(z,{component:"div",fz:11,c:"dimmed",children:[e.kind,":"]}),o.jsx(z,{component:"div",fz:"sm",fw:"500",children:e.title})]}),my=({instance:e})=>{const t=W(),n=t.currentView.id,i=[...e.views()];return o.jsxs(oe,{className:gy,gap:4,children:[o.jsx(Ke,{color:"gray",variant:"transparent",size:"xs",flex:0,children:o.jsx(kg,{stroke:1.2})}),o.jsx(z,{component:"div",fz:"sm",fw:"500",flex:"1 1 100%",children:e.title}),o.jsxs(X,{onClick:ie,pos:"relative","data-no-transform":!0,flex:0,children:[i.length===0&&o.jsx(ke,{size:"compact-xs",variant:"transparent",color:"gray",disabled:!0,children:"no views"}),i.length>0&&o.jsxs(zt,{shadow:"md",withinPortal:!1,position:"bottom-start",offset:0,closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],closeOnEscape:!0,trapFocus:!0,children:[o.jsx(zt.Target,{children:o.jsxs(ke,{size:"compact-xs",variant:"subtle",color:"gray",children:[i.length," view",i.length>1?"s":""]})}),o.jsx(zt.Dropdown,{children:i.map(a=>o.jsx(zt.Item,{px:"xs",py:4,disabled:a.id===n,leftSection:o.jsx(Ke,{size:"sm",variant:"transparent",color:"gray",children:o.jsx(Ae,{stroke:1.8,opacity:.65})}),styles:{itemSection:{marginInlineEnd:tt(8)}},onClick:s=>{s.stopPropagation(),t.navigateTo(a.id)},children:a.title},a.id))})]})]})]})},fy=()=>{},xy=m.memo(({elementFqn:e})=>{const t=be().element(e),n=[...t.deployments()],i=fo({multiple:!1});i.setHoveredNode=fy;const a=m.useMemo(()=>{let s=[],r=new Map;for(const l of t.deployments()){let d={label:o.jsx(my,{instance:l}),value:l.id,type:"instance",children:[]};r.set(l.id,d);let c=l.parent;for(;c;){let u=r.get(c.id);if(u){u.children.push(d);break}u={label:o.jsx(hy,{node:c}),value:c.id,type:"node",children:[d]},r.set(c.id,u),d=u,c=c.parent}!c&&!s.includes(d)&&s.push(d)}return s},[t]);return m.useEffect(()=>{i.expandAllNodes()},[a]),n.length===0?o.jsx(br,{variant:"light",color:"gray",icon:o.jsx(ra,{}),children:"This element does not have any deployments"}):o.jsx(xo,{levelOffset:"sm",allowRangeSelection:!1,classNames:{node:cy,label:uy},styles:{root:{position:"relative",width:"min-content",minWidth:300}},data:a,tree:i,renderNode:({node:s,selected:r,elementProps:l,hasChildren:d})=>o.jsx(X,{...l,style:{...!d&&{marginBottom:tt(4)}},children:d?o.jsx(ke,{fullWidth:!0,color:"gray",variant:r?"transparent":"subtle",size:"xs",justify:"flex-start",styles:{root:{position:"unset",paddingInlineStart:tt(16)}},children:s.label}):s.label})})}),md=m.createContext(null);function fd(){return F(m.useContext(md),"No RelationshipsBrowserActorContext")}function Vo(e,t=le){const n=fd();return ee.useSelector(n,B(e),t)}function Rn(){const e=fd();return m.useMemo(()=>({actor:e,get rootElementId(){return`relationships-browser-${e.sessionId.replaceAll(":","_")}`},getState:()=>e.getSnapshot().context,send:e.send,updateView:t=>{e.send({type:"update.view",layouted:t})},changeScope:t=>{e.send({type:"change.scope",scope:t})},navigateTo:(t,n)=>{e.send({type:"navigate.to",subject:t,fromNode:n})},fitDiagram:()=>{e.send({type:"fitDiagram"})},close:()=>{e._parent?e._parent?.send({type:"close",actorId:e.id}):e.send({type:"close"})}}),[e])}const yy=Sa(e=>{const t=Rn(),{enableNavigateTo:n}=K(),{data:{navigateTo:i,relations:a,existsInCurrentView:s}}=e,[r,l,d]=Pr(e),c=W(),u=a.length>1||!s,p=u?{...e,data:{...e.data,line:"solid",color:"amber"}}:e;let g=o.jsx(Mn,{edgeProps:p,className:x({transition:"fast"}),children:n&&i&&o.jsx(Ro,{...e,onClick:f=>{f.stopPropagation(),c.navigateTo(i)}})});return s||(g=o.jsx(Me,{color:"orange",c:"black",label:"This relationship is not included in the current view",portalProps:{target:`#${t.rootElementId}`},openDelay:800,children:g})),o.jsxs(fn,{...p,children:[o.jsx(En,{edgeProps:p,svgPath:r,...u&&{strokeWidth:5}}),o.jsx(Do,{edgeProps:p,labelPosition:{x:l,y:d,translate:"translate(-50%, 0)"},style:{maxWidth:Math.min(Math.abs(e.targetX-e.sourceX-70),250)},children:g})]})}),by=x({width:"100%",height:"100%",border:"3px dashed",borderColor:"mantine.colors.defaultBorder",borderRadius:"md",display:"flex",justifyContent:"center",alignItems:"center"});function wy({data:{column:e}}){return o.jsx(X,{className:by,children:o.jsxs(z,{c:"dimmed",fz:"lg",fw:500,children:["No ",e==="incomers"?"incoming":"outgoing"]})})}const vy=e=>{const{enableNavigateTo:t,enableVscode:n}=K(),i=W(),a=Io(),s=Rn(),r=Vo(u=>u.context.subject),l=[],{navigateTo:d,fqn:c}=e.data;return d&&t&&a!==d&&l.push({key:"navigate",icon:o.jsx(Ae,{}),onClick:u=>{u.stopPropagation(),i.navigateTo(d)}}),c!==r&&l.push({key:"relationships",icon:o.jsx(kn,{}),onClick:u=>{u.stopPropagation(),s.navigateTo(c,e.id)}}),n&&l.push({key:"goToSource",icon:o.jsx(Ut,{}),onClick:u=>{u.stopPropagation(),i.openSource({element:c})}}),o.jsx(Bo,{buttons:l,...e})},ky=e=>{const t=W();return o.jsx(Ca,{...e,onClick:n=>{n.stopPropagation(),t.openElementDetails(e.data.fqn)}})};function jy(e){const{enableElementTags:t}=K();return o.jsxs(tn,{layoutId:e.id,nodeProps:e,children:[o.jsx(nn,{...e}),o.jsx(Ge,{...e}),t&&o.jsx(Nn,{...e}),o.jsx(ky,{...e}),o.jsx(vy,{...e}),o.jsx(Sy,{...e})]},e.id)}function Cy(e){const t=W();return o.jsxs(_n,{layoutId:e.id,nodeProps:e,children:[o.jsx(Pn,{...e}),o.jsx(Xl,{...e,onClick:n=>{n.stopPropagation(),t.openElementDetails(e.data.fqn)}}),o.jsx(_y,{...e})]},e.id)}const Sy=({data:{ports:e,height:t}})=>o.jsxs(o.Fragment,{children:[e.in.map((n,i)=>o.jsx(Pe,{id:n,type:"target",position:pe.Left,style:{visibility:"hidden",top:`${15+(i+1)*((t-30)/(e.in.length+1))}px`}},n)),e.out.map((n,i)=>o.jsx(Pe,{id:n,type:"source",position:pe.Right,style:{visibility:"hidden",top:`${15+(i+1)*((t-30)/(e.out.length+1))}px`}},n))]}),_y=({data:e})=>o.jsxs(o.Fragment,{children:[e.ports.in.map((t,n)=>o.jsx(Pe,{id:t,type:"target",position:pe.Left,style:{visibility:"hidden",top:`${20*(n+1)}px`}},t)),e.ports.out.map((t,n)=>o.jsx(Pe,{id:t,type:"source",position:pe.Right,style:{visibility:"hidden",top:`${20*(n+1)}px`}},t))]});function Oo(e){const t=Yt([...e]),n=new Set(t),i=new Map(t.map(r=>[r._literalId,r])),a=new io(()=>null),s=t.reduce((r,l,d,c)=>(r.set(l,c.slice(d+1).filter(ll(l)).map(u=>(n.delete(u),u)).reduce((u,p)=>(u.some(pt(p))||(u.push(p),a.set(p,l)),u),[])),r),new io(()=>[]));return{sorted:t,byId:r=>F(i.get(r),`Element not found by id: ${r}`),root:n,parent:r=>a.get(r),children:r=>s.get(r),flatten:()=>new Set([...n,...t.reduce((r,l)=>{const d=s.get(l);return d.length===0?(r.push(l),r):(d.length>1&&r.push(...d),r)},[])])}}const ai=(e,t)=>e.size>2&&t.size!==e.size?new Set(Yt([...Oo(e).flatten(),...t])):e.size>1?new Set(Yt([...e])):e;function xd(e,t,n){const i=d=>t.has(d);let a=new Set([e]);const s={incomers:new Set,subjects:new Set([e]),outgoers:new Set};let r=new Set(n.incoming.flatMap(d=>{if(s.subjects.add(d.target),s.incomers.add(d.source),a.add(d.target),d.target!==e){let p=d.target.parent;for(;p&&p!==e;)a.add(p),p=p.parent}let c=d.source;const u=[];for(;u.push(c),!(i(c)||!c.parent);)c=c.parent;return u})),l=new Set(n.outgoing.flatMap(d=>{if(s.subjects.add(d.source),s.outgoers.add(d.target),a.add(d.source),d.source!==e){let p=d.source.parent;for(;p&&p!==e;)a.add(p),p=p.parent}let c=d.target;const u=[];for(;u.push(c),!(i(c)||!c.parent);)c=c.parent;return u}));return{incomers:ai(r,s.incomers),incoming:new Set(n.incoming),subjects:ai(a,s.subjects),outgoing:new Set(n.outgoing),outgoers:ai(l,s.outgoers)}}function Vs(e,t,n,i="global"){const a=n?t.findView(n):null;if(i==="view")return T(a,'Scope view id is required when scope is "view"'),Py(e,a,t);const s=t.element(e),r=sh(s.ascendingSiblings());return xd(s,r,{incoming:[...s.incoming()],outgoing:[...s.outgoing()]})}function Py(e,t,n){const i=n.element(e);let a={incoming:mn(Vt(i.incoming(),l=>t.includesRelation(l.id))),outgoing:mn(Vt(i.outgoing(),l=>t.includesRelation(l.id)))};const s=ll(i),r=new Set([...i.ascendingSiblings(),...re(t.elements(),ih(l=>l.element),Vt(l=>l!==i&&s(l)))]);return xd(i,r,a)}const ue={dagre:{ranksep:60,nodesep:35,edgesep:25},edgeLabel:{width:140,height:10,minlen:1,weight:1},emptyNodeOffset:120,nodeWidth:330,nodeHeight:180,compound:{labelHeight:2,paddingTop:50,paddingBottom:32}};function My(){const e=new jo.graphlib.Graph({directed:!0,compound:!0,multigraph:!0});return e.setGraph({...ue.dagre,rankdir:"LR"}),e.setDefaultEdgeLabel(()=>({...ue.edgeLabel})),e.setDefaultNodeLabel(()=>({})),e}const Di="-port";function si(e,t,n){const i=new io(s=>({id:`${e}-${s}`,portId:`${e}-${s}`})),a=Oo(t);for(const s of a.sorted){const r=a.children(s).length>0,l=s.id,d=`${e}-${l}`,c=r?`${d}${Di}`:d;i.set(l,{id:d,portId:c}),n.setNode(d,{column:e,element:s,isCompound:r,portId:c,inPorts:[],outPorts:[],width:ue.nodeWidth,height:ue.nodeHeight}),r&&(n.setNode(c,{element:s,portId:c,isCompound:r,inPorts:[],outPorts:[],width:ue.nodeWidth-ue.dagre.ranksep,height:ue.compound.labelHeight}),n.setParent(c,d));const u=a.parent(s);u&&n.setParent(d,`${e}-${u.id}`)}return{...a,byId:s=>{const r=a.byId(s),l=i.get(r.id);return{element:r,graph:l}},graphNodes:i}}function Ey(e){return jo.layout(e,{}),t=>{const n=e.node(t),{x:i,y:a,width:s,height:r}=n;return{position:{x:i-Math.round(s/2),y:a-Math.round(r/2)},width:s,height:r}}}var po;(e=>{e.Empty="@empty"})(po||(po={}));function Ny(e,t){const n=My(),i=si("incomers",e.incomers,n),a=si("subjects",e.subjects,n),s=si("outgoers",e.outgoers,n),r=[];re(Bc(re(mn(e.incoming),me(w=>({id:w.source.id,sourceFqn:w.source.id,targetFqn:w.target.id,source:i.byId(w.source.id).graph,target:a.byId(w.target.id).graph,relation:w}))),re(mn(e.outgoing),me(w=>({id:w.target.id,sourceFqn:w.source.id,targetFqn:w.target.id,source:a.byId(w.source.id).graph,target:s.byId(w.target.id).graph,relation:w})))),me(w=>({...w,expr:`${w.source.id}->${w.target.id}`})),Dc(Se("expr")),Rc(w=>{const j=w[0].source,_=w[0].target,L=w[0].expr;n.node(j.id).outPorts.push(_.id),n.node(_.id).inPorts.push(j.id),n.setEdge(j.portId,_.portId,{...ue.edgeLabel},L),r.push({name:L,sourceFqn:w[0].sourceFqn,targetFqn:w[0].targetFqn,source:j.id,sourceHandle:j.id+"_out"+(n.node(j.id).outPorts.length-1),target:_.id,targetHandle:_.id+"_in"+(n.node(_.id).inPorts.length-1),relations:me(w,Se("relation"))})}));for(const w of a.graphNodes.values()){const j=w.id,_=n.node(j);if(_.isCompound)continue;const L=Math.max(n.inEdges(j)?.length??0,n.outEdges(j)?.length??0);L>2&&(_.height=_.height+(L-3)*14)}const l=[...i.graphNodes.values(),...a.graphNodes.values(),...s.graphNodes.values()];if(i.graphNodes.size==0){const w="incomers-empty";n.setNode(w,{column:"incomers",element:null,isCompound:!1,portId:w,inPorts:[],outPorts:[],width:ue.nodeWidth,height:ue.nodeHeight});for(const j of a.graphNodes.values())n.setEdge(w,j.portId);l.push({id:w,portId:w})}if(s.graphNodes.size==0){const w="outgoers-empty";n.setNode(w,{column:"outgoers",element:null,isCompound:!1,portId:w,inPorts:[],outPorts:[],width:ue.nodeWidth,height:ue.nodeHeight});for(const j of a.graphNodes.values())n.setEdge(j.portId,w);l.push({id:w,portId:w})}const d=n.edgeCount();if(d>10)for(const w of n.edges())n.setEdge(w,{...ue.edgeLabel,width:d>25?800:400});const c=Ey(n),u=re(l,qt(w=>w.id===w.portId),yn(w=>[w.id,c(w.id)]));function p(w){return u[w]??=re(n.children(w)??[],qt(j=>!j.endsWith(Di)),me(j=>p(j)),Vr(j=>{T(j.length>0,`Node ${w} has no nested nodes`)}),Ht((j,_)=>({minY:Math.min(j.minY,_.position.y),maxY:Math.max(j.maxY,_.position.y+_.height)}),{minY:1/0,maxY:-1/0}),({minY:j,maxY:_})=>{const{position:{x:L},width:P}=c(w);return j=j-ue.compound.paddingTop,_=_+ue.compound.paddingBottom,{position:{x:L,y:j},width:P,height:_-j}})}function g(w){const j=n.parent(w);return j?g(j)+1:0}function f(w){const j=n.children(w)??[];return j.length===0?0:1+Math.max(...j.map(f))}const y=(w,j,_)=>re(_,me((L,P)=>({port:w+"_"+j+P,topY:p(L).position.y})),ao(Se("topY")),me(Se("port")));let b=0,C=0;const[k]=[...a.root];T(k,"Subjects should not be empty");let v=p(a.graphNodes.get(k.id).id);const M=l.map(({id:w})=>{const{element:j,inPorts:_,outPorts:L,column:P}=n.node(w);let{position:V,width:O,height:D}=p(w);if(!j){if(D=Math.min(v.height,300),V.y=v.position.y+v.height/2-D/2,P==="incomers")O=v.position.x-ue.emptyNodeOffset-V.x;else{const he=V.x+O;V.x=v.position.x+v.width+ue.emptyNodeOffset,O=he-V.x}return{id:w,parent:null,x:V.x,y:V.y,title:"empty node",description:te.EMPTY,technology:null,tags:[],links:[],color:"muted",shape:"rectangle",style:{border:"dashed",opacity:50},kind:po.Empty,level:0,labelBBox:{x:V.x,y:V.y,width:O,height:D},children:[],width:O,height:D,column:P,ports:{in:[],out:[]},existsInCurrentView:!1}}const $=n.parent(w),H=(n.children(w)??[]).filter(he=>!he.endsWith(Di));b=Math.min(b,V.x),C=Math.min(C,V.y);const E=t?ro(j.scopedViews(),he=>he.id!==t.id)?.id??null:null,N=t?.findNodeWithElement(j.id),Q=t&&!N?ro(j.ancestors(),he=>!!t.findNodeWithElement(he.id))?.id:null,je=N??(Q&&t?.findNodeWithElement(Q));return{id:w,parent:$??null,x:V.x,y:V.y,title:j.title,description:j.summary,technology:j.technology,tags:[...j.tags],links:null,color:je?.color??j.color,shape:N?.shape??j.shape,icon:N?.icon??j.icon??"none",modelRef:j.id,kind:j.kind,level:g(w),labelBBox:{x:V.x,y:V.y,width:O,height:D},style:_t({...(N??je)?.style,...j.$element.style},["color","shape","icon"]),navigateTo:E,...H.length>0&&{depth:f(w)},children:H,width:O,height:D,column:P,ports:{in:y(w,"in",_),out:y(w,"out",L)},existsInCurrentView:!!N}});return{subjectExistsInScope:!t||t.includesElement(k.id),bounds:{x:Math.min(b,0),y:Math.min(C,0),width:n.graph().width??100,height:n.graph().height??100},nodes:M,edges:n.edges().reduce((w,j)=>{const _=n.edge(j),L=j.name;if(!L)return w;const{name:P,source:V,sourceFqn:O,target:D,targetFqn:$,relations:H,sourceHandle:E,targetHandle:N}=F(to(r,se=>se.name===L)),Q=no(H),je=Q?.title??"untitled",he=H.length>1,lt=no(yi(H.flatMap(se=>se.navigateTo?.id?se.navigateTo.id:[])));return w.push(dl({id:P,sourceFqn:O,source:V,sourceHandle:E,targetFqn:$,target:D,targetHandle:N,label:he?`${H.length} relationships`:je,navigateTo:lt,color:Q?.color??"gray",existsInCurrentView:!t||H.every(se=>t.includesRelation(se.id)),points:_.points.map(se=>[se.x,se.y]),line:Q?.line??"dashed",head:Q?.head,tail:Q?.tail,relations:H.map(se=>se.id),parent:null})),w},[])}}function Iy(e,t,n){const i=be();return m.useMemo(()=>{const a=t?i.findView(t):null,s=Ny(Vs(e,i,t,n),n==="view"?a:null);return a&&(n==="global"||!s.subjectExistsInScope)&&(s.edges=s.edges.map(r=>(r.existsInCurrentView=r.relations.every(l=>a.includesRelation(l)),r))),Object.assign(s,{subject:e})},[i,e,t,n,Vs])}const xn=(e,t)=>Qg(e.label,t.label);function Bi(e){return{label:e.title,value:e.id,children:[...e.children()].map(Bi).sort(xn)}}function Ry(e){const t=be();return m.useMemo(()=>e?[...t.view(e).roots()].map(Bi).sort(xn):[...t.roots()].map(Bi).sort(xn),[t,e??null])}const Dy=x({margin:"0"}),By=x({_hover:{backgroundColor:"mantine.colors.gray[0]",_dark:{backgroundColor:"mantine.colors.defaultHover",color:"mantine.colors.white"}}}),yd=x({maxHeight:["70vh","calc(100cqh - 70px)"]}),Ty=Object.freeze(Object.defineProperty({__proto__:null,label:By,node:Dy,scrollArea:yd},Symbol.toStringTag,{value:"Module"})),Ly=e=>{const t=e.context.layouted?.subjectExistsInScope??!1;return{subjectId:e.context.subject,viewId:e.context.viewId,scope:e.context.scope,subjectExistsInScope:t,enableSelectSubject:e.context.enableSelectSubject,enableChangeScope:e.context.enableChangeScope}},Ay=()=>{},zy=m.memo(()=>{const e=Rn(),{subjectId:t,viewId:n,scope:i,subjectExistsInScope:a,enableSelectSubject:s,enableChangeScope:r}=Vo(Ly),l=m.useRef(null),d=m.useRef(null),c=be().findElement(t),u=Ry(i==="view"&&n?n:void 0),p=fo({multiple:!1});return p.setHoveredNode=Ay,m.useEffect(()=>{th(t).reverse().forEach(g=>{p.expand(g)}),p.select(t)},[t]),o.jsxs(oe,{ref:l,gap:"xs",pos:"relative",children:[s&&o.jsxs(oe,{gap:4,wrap:"nowrap",children:[o.jsx(X,{fz:"xs",fw:"500",style:{whiteSpace:"nowrap",userSelect:"none"},children:"Relationships of"}),o.jsx(X,{pos:"relative",children:o.jsxs(ot,{position:"bottom-start",shadow:"md",keepMounted:!1,withinPortal:!1,closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],offset:4,onOpen:()=>{setTimeout(()=>{d.current?.querySelector(`[data-value="${t}"]`)?.scrollIntoView({behavior:"instant",block:"nearest"})},100)},children:[o.jsx(Zt,{children:o.jsx(ke,{size:"xs",variant:"default",maw:250,rightSection:o.jsx(da,{size:16}),children:o.jsx(z,{fz:"xs",fw:"500",truncate:!0,children:c?.title??"???"})})}),o.jsx(Kt,{p:0,miw:250,maw:400,children:o.jsx(Xe,{scrollbars:"y",type:"never",viewportRef:d,className:yd,children:o.jsx(xo,{allowRangeSelection:!1,selectOnClick:!1,tree:p,data:u,classNames:Ty,levelOffset:8,styles:{root:{maxWidth:400,overflow:"hidden"},label:{paddingTop:5,paddingBottom:6}},renderNode:({node:g,selected:f,expanded:y,elementProps:b,hasChildren:C})=>o.jsxs(oe,{gap:2,wrap:"nowrap",...b,py:"3",children:[o.jsx(Z,{variant:"subtle",size:18,c:"dimmed",style:{visibility:C?"visible":"hidden"},children:o.jsx(It,{stroke:3.5,style:{transition:"transform 150ms ease",transform:`rotate(${y?"90deg":"0"})`,width:"80%"}})}),o.jsx(X,{flex:"1 1 100%",w:"100%",onClick:k=>{k.stopPropagation(),p.select(g.value),p.expand(g.value),e.navigateTo(g.value)},children:o.jsx(z,{fz:"sm",fw:f?"600":"400",truncate:"end",children:g.label})})]})})})})]})})]}),r&&o.jsxs(oe,{gap:4,wrap:"nowrap",children:[s&&o.jsx(X,{fz:"xs",fw:"500",...!a&&{c:"dimmed"},style:{whiteSpace:"nowrap",userSelect:"none"},children:"Scope"}),o.jsx("div",{children:o.jsx(Me,{color:"orange",label:o.jsxs(o.Fragment,{children:["This element does not exist in the current view",i==="view"&&o.jsxs(o.Fragment,{children:[o.jsx("br",{}),"Scope is set to global"]})]}),position:"bottom-start",disabled:a,portalProps:{target:l.current},children:o.jsx(Wi,{flex:"1 0 auto",size:"xs",withItemsBorders:!1,value:i,styles:{label:{paddingLeft:8,paddingRight:8}},onChange:g=>{e.changeScope(g)},data:[{label:"Global",value:"global"},{label:o.jsx("span",{children:"Current view"}),value:"view",disabled:!a}]})})})]})]})}),$y={element:jy,compound:Cy,empty:wy},Fy={relationship:yy};function bd({actorRef:e}){const t=m.useRef(null);return t.current==null&&(t.current={initialNodes:[],initialEdges:[]}),o.jsx(md.Provider,{value:e,children:o.jsx(Ji,{...t.current,children:o.jsx(Wt,{id:e.sessionId,inherit:!1,children:o.jsx(Ee,{children:o.jsx(Wy,{})})})})})}const Vy=e=>({isActive:e.hasTag("active"),nodes:e.context.xynodes,edges:e.context.xyedges}),Oy=(e,t)=>e.isActive===t.isActive&&le(e.nodes,t.nodes)&&le(e.edges,t.edges),Wy=m.memo(()=>{const e=Rn(),{isActive:t,nodes:n,edges:i}=Vo(Vy,Oy);return o.jsx(ha,{id:e.rootElementId,nodes:n,edges:i,className:S(t?"initialized":"not-initialized","relationships-browser"),nodeTypes:$y,edgeTypes:Fy,fitView:!1,onNodeClick:B((a,s)=>{a.stopPropagation(),e.send({type:"xyflow.nodeClick",node:s})}),onEdgeClick:B((a,s)=>{a.stopPropagation(),e.send({type:"xyflow.edgeClick",edge:s})}),onPaneClick:B(a=>{a.stopPropagation(),e.send({type:"xyflow.paneClick"})}),onDoubleClick:B(a=>{e.send({type:"xyflow.paneDblClick"})}),onViewportResize:B(()=>{e.send({type:"xyflow.resized"})}),onNodesChange:B(a=>{e.send({type:"xyflow.applyNodeChanges",changes:a})}),onEdgesChange:B(a=>{e.send({type:"xyflow.applyEdgeChanges",changes:a})}),onEdgeMouseEnter:B((a,s)=>{s.data.hovered||e.send({type:"xyflow.edgeMouseEnter",edge:s})}),onEdgeMouseLeave:B((a,s)=>{s.data.hovered&&e.send({type:"xyflow.edgeMouseLeave",edge:s})}),onSelectionChange:B(a=>{e.send({type:"xyflow.selectionChange",...a})}),nodesDraggable:!1,pannable:!0,zoomable:!0,children:o.jsx(qy,{})})}),Hy=e=>({subjectId:e.context.subject,viewId:e.context.viewId,scope:e.context.scope,closeable:e.context.closeable}),qy=m.memo(()=>{const e=Rn(),{subjectId:t,viewId:n,scope:i,closeable:a}=Vo(Hy),s=yo(),r=Hi();m.useEffect(()=>{r.viewportInitialized&&e.send({type:"xyflow.init",instance:r,store:s})},[s,r.viewportInitialized,e]);const l=Iy(t,n,i),[d,c,{history:u,current:p}]=wr(t);m.useEffect(()=>{d!==t&&c.set(t)},[t]),m.useEffect(()=>{d!==t&&e.navigateTo(d)},[d,e]),vr(()=>{e.updateView(l)},[l,e]);const g=p>0,f=p+1<u.length;return o.jsxs(o.Fragment,{children:[o.jsx(Xy,{hasStepBack:g,hasStepForward:f,onStepBack:()=>c.back(),onStepForward:()=>c.forward()}),a&&o.jsx(bo,{position:"top-right",children:o.jsx(Z,{variant:"default",color:"gray",onClick:y=>{y.stopPropagation(),e.close()},children:o.jsx(jn,{})})})]})}),Xy=({hasStepBack:e,hasStepForward:t,onStepBack:n,onStepForward:i})=>o.jsx(bo,{position:"top-left",children:o.jsxs(oe,{gap:4,wrap:"nowrap",children:[o.jsxs(Ee,{mode:"popLayout",children:[e&&o.jsx(Oe.div,{layout:!0,initial:{opacity:.05,transform:"translateX(-5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:.05,transform:"translateX(-10px)"},children:o.jsx(Z,{variant:"default",color:"gray",onClick:a=>{a.stopPropagation(),n()},children:o.jsx(il,{})})},"back"),t&&o.jsx(Oe.div,{layout:!0,initial:{opacity:.05,transform:"translateX(5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:0,transform:"translateX(5px)"},children:o.jsx(Z,{variant:"default",color:"gray",onClick:a=>{a.stopPropagation(),i()},children:o.jsx(It,{})})},"forward")]}),o.jsx(zy,{})]})}),Yy=x({display:"inline-block",fontSize:"sm",fontWeight:500,whiteSpace:"nowrap",padding:"[3px 6px]",borderRadius:3,background:"var(--likec4-palette-fill)/75",lineHeight:1.2,color:"var(--likec4-palette-hiContrast)"}),Gy=x({_light:{background:"mantine.colors.gray[1]","&[data-missing":{}},"&[data-missing]":{color:"mantine.colors.orange[4]",background:"mantine.colors.orange[8]/15",borderColor:"mantine.colors.orange[5]/20",_light:{color:"mantine.colors.orange[8]"}}}),Zy=x({flex:"1 1 100%",position:"relative",width:"100%",height:"100%",background:"mantine.colors.body",border:"1px solid {colors.mantine.colors.defaultBorder}",borderRadius:"sm",_light:{borderColor:"mantine.colors.gray[3]",background:"mantine.colors.gray[1]"}});x({_before:{content:'"scope:"',position:"absolute",top:"0",left:"2",fontSize:"xxs",fontWeight:500,lineHeight:"1",color:"mantine.colors.dimmed",opacity:.85,transform:"translateY(-100%) translateY(-2px)"},_light:{"& .mantine-SegmentedControl-root":{background:"mantine.colors.gray[3]"}}});x({display:"inline-block",fontSize:"xl",fontWeight:600,padding:"[1px 5px]",minWidth:24,textAlign:"center",borderRadius:"sm",background:"mantine.colors.dark[7]",color:"mantine.colors.defaultColor","&[data-zero]":{color:"mantine.colors.dimmed"},"&[data-missing]":{color:"mantine.colors.orange[4]",background:"mantine.colors.orange[8]/20"}});const Ky=Me.withProps({color:"dark",fz:"xs",openDelay:600,closeDelay:120,label:"",children:null,offset:8,withinPortal:!1});function Uy({node:e,element:t}){const n=_l(),i=Zx(),a=ee.useSelector(i,u=>u.children[`${i.id}-relationships`]),s=[...t.incoming()].map(u=>u.id),r=[...t.outgoing()].map(u=>u.id),l=e?yi([...e.incoming()].flatMap(u=>u.$edge.relations)):[],d=e?yi([...e.outgoing()].flatMap(u=>u.$edge.relations)):[],c=[...s,...r].filter(u=>!l.includes(u)&&!d.includes(u)).length;return o.jsxs(Te,{gap:"xs",pos:"relative",w:"100%",h:"100%",children:[s.length+r.length>0&&o.jsxs(oe,{gap:"xs",wrap:"nowrap",align:"center",children:[o.jsx(X,{children:o.jsxs(oe,{gap:8,mb:4,wrap:"nowrap",children:[o.jsx(Os,{title:"incoming",total:s.length,included:l.length}),o.jsx(Ke,{size:"sm",variant:"transparent",c:"dimmed",children:o.jsx(Xt,{style:{width:16}})}),o.jsx(z,{className:Yy,children:ga(t.id)}),o.jsx(Ke,{size:"sm",variant:"transparent",c:"dimmed",children:o.jsx(Xt,{style:{width:16}})}),o.jsx(Os,{title:"outgoing",total:r.length,included:d.length})]})}),c>0&&o.jsx(Ky,{label:"Current view does not include some relationships",children:o.jsxs(oe,{mt:"xs",gap:6,c:"orange",style:{cursor:"pointer"},children:[o.jsx(ra,{style:{width:14}}),o.jsxs(z,{fz:"sm",children:[c," relationship",c>1?"s are":" is"," hidden"]})]})})]}),o.jsx(X,{className:Zy,children:a&&o.jsxs(o.Fragment,{children:[o.jsx(bd,{actorRef:a}),o.jsx(X,{pos:"absolute",top:12,right:12,children:o.jsx(Z,{size:"md",variant:"default",radius:"sm",onClick:u=>{u.stopPropagation();const{subject:p,scope:g,viewId:f}=a.getSnapshot().context;n.send({type:"open.relationshipsBrowser",subject:p,scope:g,viewId:f})},children:o.jsx(al,{stroke:1.6,style:{width:"70%"}})})})]})})]})}function Os({title:e,total:t,included:n}){return o.jsx(qi,{withBorder:!0,shadow:"none",className:Gy,px:"md",py:"xs",radius:"md",mod:{zero:t===0,missing:t!==n},children:o.jsxs(Te,{gap:4,align:"flex-end",children:[o.jsx(z,{component:"div",c:t!==n?"orange":"dimmed",tt:"uppercase",fw:600,fz:10,lh:1,children:e}),o.jsx(z,{fw:600,fz:"xl",component:"div",lh:1,children:t!==n?o.jsxs(o.Fragment,{children:[n," / ",t]}):o.jsx(o.Fragment,{children:t})})]})})}const Qy=x({marginTop:"sm",marginBottom:"sm"}),Jy=x({display:"inline-flex",transition:"fast",border:"1px dashed",borderColor:"mantine.colors.defaultBorder",borderRadius:"sm",px:"md",py:"xs",alignItems:"center",cursor:"pointer",color:"mantine.colors.gray[7]",_dark:{color:"mantine.colors.dark[1]"},"& > *":{transition:"fast"},_hover:{transitionTimingFunction:"out",borderStyle:"solid",color:"mantine.colors.defaultColor",background:"mantine.colors.defaultHover","& > *":{transitionTimingFunction:"out",transform:"translateX(1px)"}}}),ri=({element:e})=>o.jsx(X,{className:Jy,children:o.jsx(z,{component:"div",fz:"sm",fw:"500",children:e.title})}),e0=()=>{};function t0({element:e}){const t=fo({multiple:!1});t.setHoveredNode=e0;const n=m.useMemo(()=>{let i=1;const a=r=>({label:r,value:`msg${i++}`,type:"message",children:[]}),s={label:o.jsx(ri,{type:"current",element:e}),value:e.id,element:e,type:"current",children:[...e.children()].map(r=>({label:o.jsx(ri,{type:"descedant",element:r}),value:r.id,element:r,type:"descedant",children:[]}))};return s.children.length===0&&s.children.push(a(o.jsx(Uc,{radius:"sm",children:"no nested"}))),[[...e.ancestors()].reduce((r,l)=>({label:o.jsx(ri,{type:"ancestor",element:l}),value:l.id,element:l,type:"ancestor",children:[r]}),s)]},[e]);return m.useEffect(()=>{t.expandAllNodes()},[n]),o.jsxs(o.Fragment,{children:[o.jsxs(br,{variant:"light",color:"orange",title:"In development",icon:o.jsx(ra,{}),children:["We need your feedback. Share your thoughts and ideas -"," ",o.jsx(Kc,{fz:"sm",fw:500,underline:"hover",c:"orange",href:"https://github.com/likec4/likec4/discussions/",target:"_blank",children:"GitHub discussions"})]}),o.jsx(xo,{levelOffset:"xl",allowRangeSelection:!1,expandOnClick:!1,expandOnSpace:!1,classNames:{label:Qy},data:n,tree:t})]})}const Ws=wo.withProps({mb:8,labelPosition:"left",variant:"dashed"}),Hs=Me.withProps({color:"dark",fz:"xs",openDelay:400,closeDelay:150,label:"",children:null,offset:4}),qs=z.withProps({component:"div",fz:11,fw:500,c:"dimmed",lh:1}),pn=z.withProps({component:"div",fz:"xs",c:"dimmed",className:ly}),Dt=24,n0=["Properties","Relationships","Views","Structure","Deployments"];function o0({viewId:e,fromNode:t,rectFromNode:n,fqn:i,onClose:a}){const[s,r]=m.useState(!1),l=Hc(),d=l.width||window.innerWidth||1200,c=l.height||window.innerHeight||800,[u,p]=qc({key:"likec4:element-details:active-tab",defaultValue:"Properties"}),g=W(),f=Pl(),y=t?f.findNode(t):f.findNodeWithElement(i),b=f.$model.element(i),[C,k]=re([...b.views()],me(A=>A.$view),Cr(A=>A._type==="element"&&A.viewOf===i));let v=y?.navigateTo?.$view??b.defaultView?.$view??null;v?.id===e&&(v=null);const M=no(b.links),w=Xc(),j=(y?.$node.children?.length??0)>0,_=Math.min(700,d-Dt*2),L=Math.min(650,c-Dt*2),P=n?{x:n.x+(j?n.width-_/2:n.width/2),y:n.y+(j?0:n.height/2)}:{x:d/2,y:c/2},V=n?Math.min(n.width/_,n.height/L,.9):1,O=Math.round(Ve(P.x-_/2,{min:Dt,max:d-_-Dt})),D=Math.round(Ve(P.y-(j?0:60),{min:Dt,max:c-L-Dt})),$=Ve((P.x-O)/_,{min:.1,max:.9}),H=Ve((P.y-D)/L,{min:.1,max:.9}),E=Va(_),N=Va(L);So(()=>{E.set(_),N.set(L)},[_,L]);const Q=m.useCallback((A,xe)=>{E.set(Math.max(E.get()+xe.delta.x,320)),N.set(Math.max(N.get()+xe.delta.y,300))},[]),je=m.useRef(null),he=Hr(a),lt=Vi(()=>{he.current()},[],50),se=y?.$node.notation??null,on=Co({element:{id:i,title:b.title,icon:y?.icon??b.icon},className:ey});return Jn(()=>{je.current?.open||je.current?.showModal()},20),Jn(()=>{r(!0)},220),o.jsx(Oe.dialog,{ref:je,className:S(Kx,eo.classNames.fullWidth),layout:!0,initial:{[Kn]:"0px",[Un]:"5%"},animate:{[Kn]:"3px",[Un]:"60%"},exit:{[Kn]:"0px",[Un]:"0%",transition:{duration:.1}},onClick:A=>{A.stopPropagation(),A.target?.nodeName?.toUpperCase()==="DIALOG"&&je.current?.close()},onDoubleClick:ie,onPointerDown:ie,onClose:A=>{A.stopPropagation(),lt()},children:o.jsx(eo,{forwardProps:!0,removeScrollBar:!1,children:o.jsxs(Oe.div,{layout:!0,layoutRoot:!0,drag:!0,dragControls:w,dragElastic:0,dragMomentum:!1,dragListener:!1,"data-likec4-color":y?.color??b.color,className:Ux,initial:{top:D,left:O,width:_,height:L,opacity:0,originX:$,originY:H,scale:Math.max(V,.65)},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9,translateY:-10,transition:{duration:.1}},style:{width:E,height:N},children:[o.jsxs("div",{className:Qx,onPointerDown:A=>w.start(A),children:[o.jsxs(ae,{alignItems:"start",justify:"space-between",gap:"sm",mb:"sm",flexWrap:"nowrap",children:[o.jsxs(ae,{alignItems:"start",gap:"sm",style:{cursor:"default"},flexWrap:"nowrap",children:[on,o.jsxs("div",{children:[o.jsx(z,{component:"div",className:Jx,children:b.title}),se&&o.jsx(z,{component:"div",c:"dimmed",fz:"sm",fw:500,lh:1.3,lineClamp:1,children:se})]})]}),o.jsx(Yc,{size:"lg",onClick:A=>{A.stopPropagation(),lt()}})]}),o.jsxs(ae,{alignItems:"baseline",gap:"sm",flexWrap:"nowrap",children:[o.jsxs("div",{children:[o.jsx(qs,{children:"kind"}),o.jsx(St,{radius:"sm",size:"sm",fw:600,color:"gray",style:{cursor:"pointer"},onClick:A=>{A.stopPropagation(),g.openSearch(`kind:${b.kind}`)},children:b.kind})]}),o.jsxs("div",{style:{flex:1},children:[o.jsx(qs,{children:"tags"}),o.jsxs(oo,{gap:4,flex:1,mt:6,wrap:"wrap",children:[b.tags.map(A=>o.jsx(To,{tag:A,cursor:"pointer",onClick:xe=>{xe.stopPropagation(),g.openSearch(`#${A}`)}},A)),b.tags.length===0&&o.jsx(St,{radius:"sm",size:"sm",fw:600,color:"gray",children:""})]})]}),o.jsxs(Gc,{style:{alignSelf:"flex-start"},children:[M&&o.jsx(Z,{component:"a",href:M.url,target:"_blank",size:"lg",variant:"default",radius:"sm",children:o.jsx(al,{stroke:1.6,style:{width:"65%"}})}),o.jsx(em,{feature:"Vscode",children:o.jsx(Hs,{label:"Open source",children:o.jsx(Z,{size:"lg",variant:"default",radius:"sm",onClick:A=>{A.stopPropagation(),g.openSource({element:b.id})},children:o.jsx(Ut,{stroke:1.8,style:{width:"62%"}})})})}),v&&o.jsx(Hs,{label:"Open default view",children:o.jsx(Z,{size:"lg",variant:"default",radius:"sm",onClick:A=>{A.stopPropagation(),g.navigateTo(v.id,t??void 0)},children:o.jsx(Ae,{style:{width:"70%"}})})})]})]})]}),o.jsxs(Sr,{value:u,onChange:A=>p(A),variant:"none",classNames:{root:oy,list:iy,tab:ay,panel:sy},children:[o.jsx(_r,{children:n0.map(A=>o.jsx(fi,{value:A,children:A},A))}),o.jsx(Lt,{value:"Properties",children:o.jsx(vt,{scrollbars:"y",type:"scroll",offsetScrollbars:!0,children:o.jsxs(X,{className:ry,pt:"xs",children:[b.hasSummary&&o.jsxs(o.Fragment,{children:[o.jsx(pn,{children:"summary"}),o.jsx(Et,{value:b.summary})]}),o.jsxs(o.Fragment,{children:[o.jsx(pn,{children:"description"}),o.jsx(Et,{value:b.description,emptyText:"no description"})]}),b.technology&&o.jsx(i0,{title:"technology",children:b.technology}),b.links.length>0&&o.jsxs(o.Fragment,{children:[o.jsx(pn,{children:"links"}),o.jsx(ae,{gap:"xs",flexWrap:"wrap",children:b.links.map((A,xe)=>o.jsx(_a,{value:A},xe))})]}),b.$element.metadata&&o.jsx(a0,{value:b.$element.metadata})]})})}),o.jsx(Lt,{value:"Relationships",children:o.jsx(Pt,{overrides:{enableRelationshipBrowser:!1,enableNavigateTo:!1},children:s&&u==="Relationships"&&o.jsx(Uy,{element:b,node:y??null})})}),o.jsx(Lt,{value:"Views",children:o.jsx(vt,{scrollbars:"y",type:"auto",children:o.jsxs(Te,{gap:"lg",children:[C.length>0&&o.jsxs(X,{children:[o.jsx(Ws,{label:"views of the element (scoped)"}),o.jsx(Te,{gap:"sm",children:C.map(A=>o.jsx(Xs,{view:A,onNavigateTo:xe=>g.navigateTo(xe,t??void 0)},A.id))})]}),k.length>0&&o.jsxs(X,{children:[o.jsx(Ws,{label:"views including this element"}),o.jsx(Te,{gap:"sm",children:k.map(A=>o.jsx(Xs,{view:A,onNavigateTo:xe=>g.navigateTo(xe,t??void 0)},A.id))})]})]})})}),o.jsx(Lt,{value:"Structure",children:o.jsx(vt,{scrollbars:"y",type:"auto",children:o.jsx(t0,{element:b})})}),o.jsx(Lt,{value:"Deployments",children:o.jsx(vt,{scrollbars:"y",type:"auto",children:o.jsx(xy,{elementFqn:b.id})})})]}),o.jsx(Oe.div,{className:dy,drag:!0,dragElastic:0,dragMomentum:!1,onDrag:Q,dragConstraints:{top:0,left:0,right:0,bottom:0}})]})})})}const Xs=({view:e,onNavigateTo:t})=>o.jsx(fe,{className:ty,onClick:n=>t(e.id,n),children:o.jsxs(oe,{gap:6,align:"start",wrap:"nowrap",children:[o.jsx(Ke,{size:"sm",variant:"transparent",children:e._type==="deployment"?o.jsx(ca,{stroke:1.8}):o.jsx(Ae,{stroke:1.8})}),o.jsx(X,{children:o.jsx(z,{component:"div",className:ny,lineClamp:1,children:e.title||"untitled"})})]})});function i0({title:e,emptyValue:t="undefined",children:n,style:i,...a}){return o.jsxs(o.Fragment,{children:[o.jsx(pn,{children:e}),o.jsx(z,{component:"div",...Ki(n)&&{c:"dimmed"},fz:"md",style:{whiteSpace:"preserve-breaks",userSelect:"all",...i},...a,children:n||t})]})}function a0({value:e}){return o.jsxs(o.Fragment,{children:[o.jsx(pn,{children:"metadata"}),o.jsx(X,{className:x({flex:1,display:"grid",gridTemplateColumns:"min-content 1fr",gridAutoRows:"min-content max-content",gap:"[4px 4px]",alignItems:"baseline",justifyItems:"stretch",paddingRight:"xxs"}),children:Ui(e).map(([t,n])=>o.jsxs("div",{style:{display:"contents"},className:"group",children:[o.jsxs("div",{className:x({fontSize:"sm",fontWeight:500,justifySelf:"end",whiteSpace:"nowrap"}),children:[t,":"]}),o.jsx("div",{className:x({}),children:o.jsx(vt.Autosize,{type:"auto",mah:200,classNames:{root:x({transitionProperty:"all",transitionDuration:"fast",transitionTimingFunction:"inOut",rounded:"sm",color:"mantine.colors.gray[8]",_dark:{color:"mantine.colors.dark[1]"},_groupHover:{transitionTimingFunction:"out",color:"mantine.colors.defaultColor",background:"mantine.colors.defaultHover"}}),viewport:x({overscrollBehavior:"none"})},children:o.jsx("div",{className:x({fontSize:"sm",padding:"xxs",whiteSpace:"pre",fontFamily:"mono",userSelect:"all"}),children:n})})})]},t))})]})}function s0({actorRef:e,onClose:t}){const n=ee.useSelector(e,B(i=>({viewId:i.context.currentView.id,fromNode:i.context.initiatedFrom.node,rectFromNode:i.context.initiatedFrom.clientRect,fqn:i.context.subject})),le);return o.jsx(Ma.Provider,{value:e,children:o.jsx(o0,{onClose:t,...n})})}const go=(e,t)=>e.size>2&&t.size!==e.size?new Set(Yt([...Oo(e).flatten(),...t])):e.size>1?new Set(Yt([...e])):e;function r0(e,t){const n=new Set,i=new Set,a=new Set,s={sources:new Set,targets:new Set},r=(l,d)=>{d==="source"?(n.add(l),s.sources.add(l)):(a.add(l),s.targets.add(l))};for(const l of e){const d=t.findEdge(l),c=d?[...d.relationships("model")]:[];if(!d||!de(c,1)||!d.source.hasElement()||!d.target.hasElement())continue;const u=d.source.element,p=d.target.element;r(u,"source"),r(p,"target");for(const g of c){if(i.add(g),g.source!==u){r(g.source,"source");for(const f of g.source.ancestors()){if(f===u)break;n.add(f)}}if(g.target!==p){r(g.target,"target");for(const f of g.target.ancestors()){if(f===p)break;a.add(f)}}}}return{sources:go(n,s.sources),targets:go(a,s.targets),relationships:i}}function l0({source:e,target:t}){const n=new Set,i=new Set,a=new Set,s={sources:new Set,targets:new Set},r=(d,c)=>{c==="source"?(n.add(d),s.sources.add(d)):(a.add(d),s.targets.add(d))};e&&r(e,"source"),t&&r(t,"target");const[l]=od(e,t,"directed");if(!l)return{sources:n,targets:a,relationships:i};for(const d of l.relations){const c=d.source,u=d.target;if(r(c,"source"),r(u,"target"),i.add(d),e!==c){T(pt(e,c),`${e.id} is not an ancestor of ${c.id}`);for(const p of c.ancestors()){if(p===e)break;n.add(p)}}if(t!==u){T(pt(t,u),`${t.id} is not an ancestor of ${u.id}`);for(const p of u.ancestors()){if(p===t)break;a.add(p)}}}return{sources:go(n,s.sources),targets:go(a,s.targets),relationships:i}}const d0=Sa(e=>{const{enableNavigateTo:t}=K(),{data:{navigateTo:n}}=e,[i,a,s]=Pr(e),r=W();return o.jsxs(fn,{...e,children:[o.jsx(En,{edgeProps:e,svgPath:i}),o.jsx(Do,{edgeProps:e,labelPosition:{x:a,y:s,translate:"translate(-50%, 0)"},style:{maxWidth:Math.abs(e.targetX-e.sourceX-100)},children:o.jsx(Mn,{edgeProps:e,children:t&&n&&o.jsx(Ro,{...e,onClick:l=>{l.stopPropagation(),r.navigateTo(n)}})})})]})}),c0=e=>{const{enableNavigateTo:t,enableVscode:n}=K(),i=W(),a=Io(),s=[],{navigateTo:r,fqn:l}=e.data;return r&&t&&a!==r&&s.push({key:"navigate",icon:o.jsx(Ae,{}),onClick:d=>{d.stopPropagation(),i.navigateTo(r)}}),l&&s.push({key:"relationships",icon:o.jsx(kn,{}),onClick:d=>{d.stopPropagation(),i.openRelationshipsBrowser(l)}}),l&&n&&s.push({key:"goToSource",icon:o.jsx(Ut,{}),onClick:d=>{d.stopPropagation(),i.openSource({element:l})}}),o.jsx(Bo,{buttons:s,...e})},wd=e=>{const t=W();return o.jsx(Ca,{...e,onClick:n=>{n.stopPropagation(),t.openElementDetails(e.data.fqn)}})},u0=et(e=>{const{enableElementTags:t}=K();return o.jsxs(tn,{nodeProps:e,children:[o.jsx(nn,{...e}),o.jsx(Ge,{...e}),t&&o.jsx(Nn,{...e}),o.jsx(wd,{...e}),o.jsx(c0,{...e}),o.jsx(g0,{...e})]})}),p0=et(e=>o.jsxs(_n,{nodeProps:e,children:[o.jsx(wd,{...e}),o.jsx(Pn,{...e}),o.jsx(h0,{...e})]})),g0=({data:{ports:e,height:t}})=>o.jsxs(o.Fragment,{children:[e.in.map((n,i)=>o.jsx(Pe,{id:n,type:"target",position:pe.Left,style:{visibility:"hidden",top:`${15+(i+1)*((t-30)/(e.in.length+1))}px`}},n)),e.out.map((n,i)=>o.jsx(Pe,{id:n,type:"source",position:pe.Right,style:{visibility:"hidden",top:`${15+(i+1)*((t-30)/(e.out.length+1))}px`}},n))]}),h0=({data:e})=>o.jsxs(o.Fragment,{children:[e.ports.in.map((t,n)=>o.jsx(Pe,{id:t,type:"target",position:pe.Left,style:{visibility:"hidden",top:`${20*(n+1)}px`}},t)),e.ports.out.map((t,n)=>o.jsx(Pe,{id:t,type:"source",position:pe.Right,style:{visibility:"hidden",top:`${20*(n+1)}px`}},t))]}),vd=m.createContext(null);function Ea(){return F(m.useContext(vd),"No RelationshipDetailsActorContext")}function kd(e,t=le){const n=B(e),i=Ea();return ee.useSelector(i,n,t)}function Na(){const e=Ea();return m.useMemo(()=>({actor:e,get rootElementId(){return`relationship-details-${e.sessionId.replaceAll(":","_")}`},getState:()=>e.getSnapshot().context,send:e.send,navigateTo:(...t)=>{t.length===1?e.send({type:"navigate.to",params:{edgeId:t[0]}}):e.send({type:"navigate.to",params:{source:t[0],target:t[1]}})},fitDiagram:()=>{e.send({type:"fitDiagram"})},close:()=>{e._parent?e._parent?.send({type:"close",actorId:e.id}):e.send({type:"close"})}}),[e])}const Fe={dagre:{ranksep:60,nodesep:35,edgesep:25},edgeLabel:{width:220,height:14},nodeWidth:330,nodeHeight:180,compound:{labelHeight:2,paddingTop:50,paddingBottom:32}};function m0(){const e=new jo.graphlib.Graph({directed:!0,compound:!0,multigraph:!0});return e.setGraph({...Fe.dagre,rankdir:"LR"}),e.setDefaultEdgeLabel(()=>({...Fe.edgeLabel})),e.setDefaultNodeLabel(()=>({})),e}const Ti="-port";function Ys(e,t,n){const i=new io(s=>({id:`${e}-${s}`,portId:`${e}-${s}`})),a=Oo(t);for(const s of a.sorted){const r=a.children(s).length>0,l=s.id,d=`${e}-${l}`,c=r?`${d}${Ti}`:d;i.set(l,{id:d,portId:c}),n.setNode(d,{column:e,element:s,isCompound:r,portId:c,inPorts:[],outPorts:[],width:Fe.nodeWidth,height:Fe.nodeHeight}),r&&(n.setNode(c,{element:s,portId:c,isCompound:r,inPorts:[],outPorts:[],width:Fe.nodeWidth-Fe.dagre.ranksep,height:Fe.compound.labelHeight}),n.setParent(c,d));const u=a.parent(s);u&&n.setParent(d,`${e}-${u.id}`)}return{...a,byId:s=>{const r=a.byId(s),l=i.get(r.id);return{element:r,graph:l}},graphNodes:i}}function f0(e){return jo.layout(e,{}),t=>{const n=e.node(t),{x:i,y:a,width:s,height:r}=n;return{position:{x:i-Math.round(s/2),y:a-Math.round(r/2)},width:s,height:r}}}function x0(e,t){const n=m0(),i=Ys("sources",e.sources,n),a=Ys("targets",e.targets,n),s=Array.from(e.relationships).map(k=>{const v=i.byId(k.source.id).graph,M=a.byId(k.target.id).graph,w=k.id;return n.node(v.id).outPorts.push(M.id),n.node(M.id).inPorts.push(v.id),n.setEdge(v.portId,M.portId,{...Fe.edgeLabel},w),{name:w,source:v.id,sourceHandle:v.id+"_out"+(n.node(v.id).outPorts.length-1),target:M.id,targetHandle:M.id+"_in"+(n.node(M.id).inPorts.length-1),relationship:k}}),r=[...i.graphNodes.values(),...a.graphNodes.values()];for(const{id:k}of r){const v=n.node(k);if(v.isCompound)continue;const M=Math.max(n.inEdges(k)?.length??0,n.outEdges(k)?.length??0);M>3&&(v.height=v.height+(M-4)*14)}const l=n.edgeCount();if(l>5)for(const k of n.edges())n.setEdge(k,{...Fe.edgeLabel,width:l>10?800:400});const d=f0(n),c=re(r,qt(k=>k.id===k.portId),yn(k=>[k.id,d(k.id)]));function u(k){return c[k]??=re(n.children(k)??[],qt(v=>!v.endsWith(Ti)),me(v=>u(v)),Vr(v=>{T(v.length>0,`Node ${k} has no nested nodes`)}),Ht((v,M)=>({minY:Math.min(v.minY,M.position.y),maxY:Math.max(v.maxY,M.position.y+M.height)}),{minY:1/0,maxY:-1/0}),({minY:v,maxY:M})=>{const{position:{x:w},width:j}=d(k);return v=v-Fe.compound.paddingTop,M=M+Fe.compound.paddingBottom,{position:{x:w,y:v},width:j,height:M-v}})}function p(k){const v=n.parent(k);return v?p(v)+1:0}function g(k){const v=n.children(k)??[];return v.length===0?0:1+Math.max(...v.map(g))}const f=(k,v,M)=>re(M,me((w,j)=>({port:k+"_"+v+j,topY:u(w).position.y})),ao(Se("topY")),me(Se("port")));let y=0,b=0;const C=r.map(({id:k})=>{const{element:v,inPorts:M,outPorts:w,column:j}=n.node(k);let{position:_,width:L,height:P}=u(k);const V=n.parent(k),O=(n.children(k)??[]).filter(N=>!N.endsWith(Ti));y=Math.min(y,_.x),b=Math.min(b,_.y);const D=t?ro(v.scopedViews(),N=>N.id!==t.id)?.id??null:null,$=t?.findNodeWithElement(v.id),H=t&&!$?ro(v.ancestors(),N=>!!t.findNodeWithElement(N.id))?.id:null,E=$??(H&&t?.findNodeWithElement(H));return dl({id:k,parent:V??null,x:_.x,y:_.y,title:v.title,description:v.summary,technology:v.technology,tags:[...v.tags],links:null,color:E?.color??v.color,shape:$?.shape??v.shape,icon:$?.icon??v.icon??"none",modelRef:v.id,kind:v.kind,level:p(k),labelBBox:{x:_.x,y:_.y,width:L,height:P},style:_t({...($??E)?.style,...v.$element.style},["shape","color","icon"]),navigateTo:D,...O.length>0&&{depth:g(k)},children:O,width:L,height:P,column:j,ports:{in:f(k,"in",M),out:f(k,"out",w)}})});return{bounds:{x:Math.min(y,0),y:Math.min(b,0),width:n.graph().width??100,height:n.graph().height??100},nodes:C,edges:n.edges().reduce((k,v)=>{const M=n.edge(v),w=v.name;if(!w)return k;const{name:j,source:_,target:L,relationship:P,sourceHandle:V,targetHandle:O}=to(s,N=>N.name===w),D=P.title??"untitled",$=P.navigateTo?.id??null,H=P.description??null,E=P.technology??null;return k.push({id:j,source:_,sourceHandle:V,target:L,targetHandle:O,label:D,color:P.color,...$&&{navigateTo:$},...H&&{description:H},...E&&{technology:E},points:M.points.map(N=>[N.x,N.y]),line:P.line,relationId:P.id,parent:null}),k},[])}}const Ia=x.raw({display:"inline-flex",alignItems:"center",padding:"[6px 2px 0 2px]","& .mantine-Text-root":{color:"mantine.colors.text/90",fontSize:"xs",fontWeight:500,lineHeight:"1.2"}}),Gs=x({paddingLeft:"1",gridColumn:1},Ia),y0=x({gridColumn:2},Ia),Zs=x({gridColumn:3,paddingRight:"1"},Ia),jd="likec4-edge-label",b0=S(jd,x({display:"grid",gridColumnStart:1,gridColumnEnd:4,borderBottom:"1px solid",borderBottomColor:"mantine.colors.defaultBorder",marginBottom:"0",padding:"[0 4px 5px 4px]",width:"100%","& .mantine-Text-root":{fontSize:"xxs",fontWeight:400,lineHeight:"xs",color:"mantine.colors.dimmed"}})),w0=x({display:"contents",[`&:last-child .${jd}`]:{borderBottom:"none",marginBottom:"0"},"& > *":{transition:"all 0.15s ease-in"},"&:is(:hover, [data-selected=true]) > *":{transition:"all 0.15s ease-out",cursor:"pointer",backgroundColor:"mantine.colors.defaultHover"}}),v0=x({display:"grid",gridTemplateColumns:"1fr 30px 1fr",gridAutoRows:"min-content max-content",gap:"0",alignItems:"stretch"});x({display:"grid",gridTemplateColumns:"min-content 1fr",gridAutoRows:"min-content max-content",gap:"[10px 12px]",alignItems:"baseline",justifyItems:"start"});const k0=x({maxHeight:["70vh","calc(100cqh - 70px)"]}),j0=({edge:e,view:t})=>{const n=Na(),i=m.useRef(null),a=t.nodes.find(l=>l.id===e.source),s=t.nodes.find(l=>l.id===e.target),r=t.edges.flatMap(l=>{const d=t.nodes.find(u=>u.id===l.source),c=t.nodes.find(u=>u.id===l.target);return d&&c?{id:l.id,source:d,target:c,label:l.label}:[]});return!a||!s||r.length===0?null:o.jsxs(ot,{position:"bottom-start",shadow:"md",keepMounted:!0,withinPortal:!1,closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],onOpen:()=>{setTimeout(()=>{i.current?.querySelector(`[data-edge-id="${e.id}"]`)?.scrollIntoView({behavior:"instant",block:"nearest"})},100)},children:[o.jsx(Zt,{children:o.jsxs(ke,{size:"xs",variant:"default",fw:"500",style:{padding:"0.25rem 0.75rem"},rightSection:o.jsx(da,{size:16}),children:[o.jsx(X,{className:Gs,maw:160,p:0,mod:{"likec4-color":a.color},children:o.jsx(z,{component:"span",truncate:!0,children:a.title})}),o.jsx(Ke,{color:"dark",variant:"transparent",size:"xs",children:o.jsx(Xt,{style:{width:"80%"}})}),o.jsx(X,{className:Zs,maw:160,p:0,mod:{"likec4-color":s.color},children:o.jsx(z,{component:"span",truncate:!0,children:s.title})})]})}),o.jsx(Kt,{p:0,miw:250,maw:400,children:o.jsx(Xe,{className:k0,scrollbars:"y",type:"never",viewportRef:i,children:o.jsx(X,{className:v0,p:"xs",maw:400,children:r.map(l=>o.jsxs("div",{className:w0,"data-selected":l.id===e.id,onClick:d=>{d.stopPropagation(),n.navigateTo(l.id)},children:[o.jsx(X,{className:Gs,mod:{"edge-id":l.id,"likec4-color":l.source.color},children:o.jsx(z,{component:"span",truncate:!0,children:l.source.title})}),o.jsx(X,{className:y0,children:o.jsx(Ke,{color:"dark",variant:"transparent",size:"xs",children:o.jsx(Xt,{style:{width:"80%"}})})}),o.jsx(X,{className:Zs,mod:{"likec4-color":l.target.color},children:o.jsx(z,{component:"span",truncate:!0,children:l.target.title})}),o.jsx(X,{className:b0,children:o.jsx(z,{component:"span",truncate:!0,children:l.label||"untitled"})})]},l.id))})})})]})},C0={element:u0,compound:p0},S0={relationship:d0};function _0({actorRef:e}){const t=m.useRef(null);return t.current==null&&(t.current={defaultNodes:[],defaultEdges:[]}),o.jsx(vd.Provider,{value:e,children:o.jsx(Ji,{...t.current,children:o.jsx(Wt,{id:e.sessionId,inherit:!1,children:o.jsxs(Ee,{children:[o.jsx(N0,{},"xyflow"),o.jsx(M0,{},"sync")]})})})})}const P0=e=>({...e.context.subject,viewId:e.context.viewId}),M0=m.memo(()=>{const e=Ea(),t=ee.useSelector(e,P0,I),n=be(),i=n.findView(t.viewId)??null,a=m.useMemo(()=>{let l;if("edgeId"in t&&_e(t.edgeId)){T(i,`view ${t.viewId} not found`);const d=F(i.findEdge(t.edgeId),`edge ${t.edgeId} not found in ${t.viewId}`);l=r0([d.id],i)}else if(t.source&&t.target)l=l0({source:n.element(t.source),target:n.element(t.target)});else return null;return x0(l,i)},[t,i,n]),s=yo(),r=Hi();return m.useEffect(()=>{r.viewportInitialized&&e.send({type:"xyflow.init",instance:r,store:s})},[s,r.viewportInitialized,e]),m.useEffect(()=>{a!==null&&e.send({type:"update.layoutData",data:a})},[a,e]),null}),E0=({context:e})=>({initialized:e.initialized.xydata&&e.initialized.xyflow,nodes:e.xynodes,edges:e.xyedges}),N0=m.memo(()=>{const e=Na(),{initialized:t,nodes:n,edges:i}=kd(E0,I);return o.jsxs(ha,{id:e.rootElementId,nodes:n,edges:i,className:S(t?"initialized":"not-initialized","likec4-relationship-details"),nodeTypes:C0,edgeTypes:S0,onNodesChange:B(a=>{e.send({type:"xyflow.applyNodeChanges",changes:a})}),onEdgesChange:B(a=>{e.send({type:"xyflow.applyEdgeChanges",changes:a})}),fitViewPadding:.05,onNodeClick:B((a,s)=>{a.stopPropagation(),e.send({type:"xyflow.nodeClick",node:s})}),onEdgeClick:B((a,s)=>{a.stopPropagation(),e.send({type:"xyflow.edgeClick",edge:s})}),onPaneClick:B(()=>{e.send({type:"xyflow.paneClick"})}),onDoubleClick:B(()=>{e.send({type:"xyflow.paneDblClick"})}),onViewportResize:B(()=>{e.send({type:"xyflow.resized"})}),onEdgeMouseEnter:B((a,s)=>{s.data.hovered||e.send({type:"xyflow.edgeMouseEnter",edge:s})}),onEdgeMouseLeave:B((a,s)=>{s.data.hovered&&e.send({type:"xyflow.edgeMouseLeave",edge:s})}),onSelectionChange:B(a=>{e.send({type:"xyflow.selectionChange",...a})}),nodesDraggable:!1,fitView:!1,pannable:!0,zoomable:!0,children:[o.jsx(R0,{}),o.jsx(bo,{position:"top-right",children:o.jsx(Z,{variant:"default",color:"gray",onClick:a=>{a.stopPropagation(),e.close()},children:o.jsx(jn,{})})})]})}),I0=({context:e})=>({subject:e.subject,viewId:e.viewId}),R0=m.memo(()=>{const{subject:e,viewId:t}=kd(I0,I),n=be().findView(t);if(!n||!n.isDiagram())return null;const i=[...n.edges()];let a="edgeId"in e&&_e(e.edgeId)?i.find(s=>s.id===e.edgeId):to(i,s=>s.source.element?.id===e.source&&s.target.element?.id===e.target)||to(i,s=>(s.source.element?.id===e.source||pt(s.source.element?.id??"__",e.source??"__"))&&(s.target.element?.id===e.target||pt(s.target.element?.id??"__",e.target??"__")));return a?o.jsx(D0,{edge:a.$edge,view:n.$view}):null}),D0=({edge:e,view:t})=>{const n=Na(),i=e.id,[a,s,{history:r,current:l}]=wr(e.id);m.useEffect(()=>{a!==i&&s.set(i)},[i]),m.useEffect(()=>{a!==i&&n.navigateTo(a)},[a]);const d=l>0,c=l+1<r.length;return o.jsx(bo,{position:"top-left",children:o.jsx(oe,{gap:4,wrap:"nowrap",children:o.jsxs(Ee,{mode:"popLayout",children:[d&&o.jsx(Oe.div,{layout:!0,initial:{opacity:.05,transform:"translateX(-5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:.05,transform:"translateX(-10px)"},children:o.jsx(Z,{variant:"default",color:"gray",onClick:u=>{u.stopPropagation(),s.back()},children:o.jsx(il,{})})},"back"),c&&o.jsx(Oe.div,{layout:!0,initial:{opacity:.05,transform:"translateX(5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:0,transform:"translateX(5px)"},children:o.jsx(Z,{variant:"default",color:"gray",onClick:u=>{u.stopPropagation(),s.forward()},children:o.jsx(It,{})})},"forward"),o.jsx(oe,{gap:"xs",wrap:"nowrap",ml:"sm",children:o.jsx(j0,{edge:e,view:t})})]})})})},B0=e=>e.context.overlays.map(t=>{switch(t.type){case"relationshipsBrowser":return e.children[t.id]?{type:t.type,actorRef:e.children[t.id]}:null;case"relationshipDetails":return e.children[t.id]?{type:t.type,actorRef:e.children[t.id]}:null;case"elementDetails":return e.children[t.id]?{type:t.type,actorRef:e.children[t.id]}:null;default:Le(t)}}).filter(Nr),T0=(e,t)=>e.length===t.length&&e.every((n,i)=>n.actorRef===t[i].actorRef);function L0({overlaysActorRef:e}){const t=ua(d=>d.domNode),n=m.useMemo(()=>t?.querySelector(".react-flow__renderer")??null,[t]),i=ee.useSelector(e,B0,T0),a=xr()??!1,s=i.some(d=>d.type==="elementDetails");m.useEffect(()=>{!n||a||bc(n,{opacity:s?.7:1,filter:s?"grayscale(1)":"grayscale(0)",transform:s?"perspective(400px) translateZ(-12px) translateY(3px)":"translateY(0)"},{duration:s?.35:.17})},[s,n]);const r=d=>{e.send({type:"close",actorId:d.id})},l=i.map((d,c)=>{switch(d.type){case"relationshipsBrowser":return o.jsx(uo,{overlayLevel:c,onClose:()=>r(d.actorRef),children:o.jsx(bd,{actorRef:d.actorRef})},d.actorRef.sessionId);case"relationshipDetails":return o.jsx(uo,{overlayLevel:c,onClose:()=>r(d.actorRef),children:o.jsx(_0,{actorRef:d.actorRef})},d.actorRef.sessionId);case"elementDetails":return o.jsx(s0,{actorRef:d.actorRef,onClose:()=>r(d.actorRef)},d.actorRef.sessionId);default:Le(d)}});return o.jsx(Pt.Overlays,{children:o.jsx(Gi,{FallbackComponent:ba,onReset:()=>e.send({type:"close.all"}),children:o.jsx(Wt,{children:o.jsx(Ee,{children:l})})})})}const[A0,ht]=gr("SearchActorContext"),z0=e=>e.context.searchValue;function $0(){const e=ht(),t=ee.useSelector(e,z0),n=m.useCallback(i=>{e.send({type:"change.search",search:i})},[e]);return[t,n]}const F0=e=>{const t=e.context.searchValue.trim().toLowerCase();return t.length>1?t:""};function Ra(){const e=ht();return m.useDeferredValue(ee.useSelector(e,F0))}function V0(){const e=ht();return m.useCallback(t=>{e.send({type:"change.search",search:t})},[e])}const O0=e=>e.context.pickViewFor;function W0(){const e=ht();return ee.useSelector(e,O0)}const li=x.raw({outline:"none",background:"mantine.colors.primary[8]",borderColor:"mantine.colors.primary[9]"}),Wo=".mantine-Tree-node:focus > .mantine-Tree-label &",H0=x.raw({display:"flex",width:"100%",background:"mantine.colors.body",rounded:"sm",padding:"[12px 8px 12px 14px]",minHeight:"60px",gap:"2",border:"1px solid",borderColor:"mantine.colors.defaultBorder",_hover:{...li,borderColor:"mantine.colors.primary[9]",background:"mantine.colors.primary[8]/60"},_focus:li,[Wo]:li,_dark:{borderColor:"transparent",background:"mantine.colors.dark[6]/80"},_light:{background:"mantine.colors.white/80",_hover:{borderColor:"mantine.colors.primary[6]",backgroundColor:"mantine.colors.primary[5]"}}}),Ho="likec4-focusable",qn={ref:"var(--likec4-icon-size, 24px)"},q0=x.raw({color:{base:"mantine.colors.dimmed",_light:"mantine.colors.gray[5]",_groupHover:"mantine.colors.primary[0]",_groupFocus:"mantine.colors.primary[0]"},[Wo]:{color:"mantine.colors.primary[0]"},flex:`0 0 ${qn.ref}`,height:qn.ref,width:qn.ref,display:"flex",alignItems:"center",justifyContent:"center",alignSelf:"flex-start","--ti-size":qn.ref,"& svg, & img":{width:"100%",height:"auto",maxHeight:"100%",pointerEvents:"none"},"& img":{objectFit:"contain"},"&.likec4-shape-icon svg":{strokeWidth:1.5}}),X0=x.raw({fontSize:"16px",fontWeight:500,lineHeight:"1.1",":where([data-disabled]) &":{opacity:.4},color:{base:"mantine.colors.dark[1]",_light:"mantine.colors.gray[7]",_groupHover:{base:"mantine.colors.primary[1]",_light:"mantine.colors.white"},_groupFocus:{base:"mantine.colors.primary[1]",_light:"mantine.colors.white"}},[Wo]:{color:{base:"mantine.colors.primary[1]",_light:"mantine.colors.white"}}}),Cd=x.raw({color:{base:"mantine.colors.dimmed",_groupHover:{base:"mantine.colors.primary[1]",_light:"mantine.colors.primary[0]"},_groupFocus:"mantine.colors.primary[0]"},[Wo]:{color:"mantine.colors.primary[0]"}}),Y0=x.raw(Cd,{marginTop:"1",fontSize:"12px",lineHeight:"1.4",":where([data-disabled]) &":{opacity:.85}}),G0=x({width:"100%",height:"100%",border:"2px dashed",borderColor:"mantine.colors.defaultBorder",rounded:"md",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"md",color:"mantine.colors.dimmed",padding:"md",paddingBlock:"xl"}),Sd=lp({slots:["root","icon","title","description","descriptionColor"],className:"search-button",base:{root:H0,icon:q0,title:X0,description:Y0,descriptionColor:Cd}}),Da="@container likec4-tree (max-width: 450px)",Z0=x({outline:"none",marginBottom:"2"}),K0=x(vl.raw({containerName:"likec4-tree"}),{containerType:"inline-size",height:"100%"}),U0=x({display:"flex",alignItems:"baseline",outline:"none !important",gap:"1"}),Q0=x({marginTop:"2"}),J0=x({color:"mantine.colors.dimmed"}),e1=x({[Da]:{flexDirection:"column-reverse",alignItems:"flex-start",gap:"0.5"}}),t1=x({fontSize:"10px",lineHeight:"1.3",display:"block",fontWeight:500,whiteSpace:"nowrap",padding:"[1px 5px]",borderRadius:"4px",background:"mantine.colors.dark[9]/30",_light:{background:"mantine.colors.gray[3]/20"}}),n1=x({"--likec4-icon-size":"24px",[Da]:{"--likec4-icon-size":"18px"}}),o1=x({flex:0,fontSize:"10px",fontWeight:500,whiteSpace:"nowrap",lineHeight:"1.1",[Da]:{display:"none"}});function De(e){e.stopPropagation(),e.preventDefault()}function _d(e){const t=e.getBoundingClientRect();return t.y+Math.floor(t.height/2)}function Dn(e){if(!e){console.error("moveFocusToSearchInput: from is null or undefined");return}const t=e.getRootNode();if(!gt(t.querySelector)){console.error("moveFocusToSearchInput: root.querySelector is not a function");return}let n=t.querySelector("[data-likec4-search-input]");if(n){const i=n.value.length;n.focus(),n.setSelectionRange(i,i)}}function ho(e){if(!e){console.error("focusToFirstFoundElement: from is null or undefined");return}const t=e.getRootNode();if(!gt(t.querySelector)){console.error("focusToFirstFoundElement: root.querySelector is not a function");return}t.querySelector(`[data-likec4-search] .${Ho}`)?.focus()}function Pd(e,t,n=`.${Ho}`){if(!e)return console.error("queryAllFocusable: from is null or undefined"),[];const i=e.getRootNode();return gt(i.querySelectorAll)?[...i.querySelectorAll(`[data-likec4-search-${t}] ${n}`)]:(console.error("queryAllFocusable: root.querySelectorAll is not a function"),[])}const i1="likec4-view-btn",a1=S(x({flexWrap:"nowrap",display:"flex","&[data-disabled] .mantine-ThemeIcon-root":{opacity:.45}}),i1);x({marginTop:"1",fontSize:"13px",lineHeight:"1.4",":where(.likec4-view-btn[data-disabled]) &":{opacity:.85}});const Md=()=>o.jsx(J,{className:G0,children:"Nothing found"}),s1=m.memo(()=>{const e=m.useRef(null);let t=[...be().views()],n=Ra();return n&&(n.startsWith("kind:")?t=[]:t=t.filter(i=>n.startsWith("#")?i.tags.some(a=>a.toLocaleLowerCase().includes(n.slice(1))):`${i.id} ${i.title} ${i.description.text}`.toLocaleLowerCase().includes(n))),o.jsxs(Te,{ref:e,renderRoot:i=>o.jsx(ne,{layout:!0,...i}),gap:8,"data-likec4-search-views":!0,onKeyDown:i=>{if(i.key==="ArrowLeft"||i.key==="ArrowRight"){const a=i.target.getBoundingClientRect().y,s=Pd(e.current,"elements",".likec4-element-button");let r=s.length>1?s.find((l,d,c)=>_d(l)>a||d===c.length-1):null;r??=gn(s),r&&(i.stopPropagation(),r.focus());return}},children:[t.length===0&&o.jsx(Md,{}),t.length>0&&o.jsx(Gd,{children:o.jsx(fe,{"data-likec4-view":!0,tabIndex:-1,onFocus:i=>{i.stopPropagation(),Dn(e.current)}})}),t.map((i,a)=>o.jsx(ne,{layoutId:`@view${i.id}`,children:o.jsx(Li,{view:i,search:n,tabIndex:a===0?0:-1})},i.id))]})}),Xn=Sd();function Li({className:e,view:t,loop:n=!1,search:i,...a}){const s=ht(),r=W(),l=Io(),d=t.id===l,c=()=>{s.send({type:"close"}),setTimeout(()=>{r.navigateTo(t.id)},100)};return o.jsxs(fe,{...a,className:S(Xn.root,"group",Ho,a1,e),"data-likec4-view":t.id,...d&&{"data-disabled":!0},onClick:u=>{u.stopPropagation(),c()},onKeyDown:kr({siblingSelector:"[data-likec4-view]",parentSelector:"[data-likec4-search-views]",activateOnFocus:!1,loop:n,orientation:"vertical",onKeyDown:u=>{u.nativeEvent.code==="Space"&&(u.stopPropagation(),c())}}),children:[o.jsx(Ke,{variant:"transparent",className:Xn.icon,children:t.isDeploymentView()?o.jsx(ca,{stroke:1.8}):o.jsx(Ae,{stroke:1.8})}),o.jsxs(J,{style:{flexGrow:1},children:[o.jsxs(oe,{gap:"xs",wrap:"nowrap",align:"center",children:[o.jsx(jt,{component:"div",highlight:i,className:Xn.title,children:t.title||"untitled"}),d&&o.jsx(St,{size:"xs",fz:9,radius:"sm",children:"current"})]}),o.jsx(jt,{highlight:t.description.nonEmpty?i:"",component:"div",className:Xn.description,lineClamp:1,children:t.description.text||"No description"})]})]})}const Bt=Sd(),r1=m.memo(()=>{const e=be(),t=Ra(),n=m.useMemo(()=>{const a=t.split(".");let s;ut(a)||a[0]==="kind:"?s=e.elements():s=Vt(e.elements(),c=>t.startsWith("kind:")?c.kind.toLocaleLowerCase().startsWith(t.slice(5)):t.startsWith("#")?c.tags.some(u=>u.toLocaleLowerCase().includes(t.slice(1))):(c.title+" "+c.id+" "+c.summary.text).toLocaleLowerCase().includes(t));const r={},{all:l,roots:d}=re([...s],Yt,Ht((c,u)=>{const p={label:u.title,value:u.id,element:u,searchTerms:a,children:[]};r[p.value]=p;const g=c.all.findLast(f=>pt(f.value,p.value));return g?(g.children.push(p),g.children.length>1&&g.children.sort(xn)):c.roots.push(p),c.all.push(p),c},{all:[],roots:[]}));return{all:l,byid:r,roots:d.sort(xn)}},[e,t]),i=Ed();return n.all.length===0?o.jsx(Md,{}):o.jsx(d1,{data:n,handleClick:i})}),l1=()=>{};function d1({data:{all:e,byid:t,roots:n},handleClick:i}){const a=fo({multiple:!1});a.setHoveredNode=l1,m.useEffect(()=>{a.collapseAllNodes();for(const r of e)r.children.length>0&&a.expand(r.value)},[e]);const s=B(r=>{const l=r.target,d=l.getAttribute("data-value"),c=!!d&&t[d];if(c){if(r.key==="ArrowUp"){d===n[0]?.value&&(De(r),Dn(l));return}if(r.key==="ArrowRight"){if(c.children.length>0&&a.expandedState[d]===!1)return;const u=(r.target.querySelector(".mantine-Tree-label")??l).getBoundingClientRect().y,p=Pd(l,"views");let g=p.length>1?p.find((f,y,b)=>_d(f)>u||y===b.length-1):null;g??=gn(p),g&&(De(r),g.focus());return}if(r.key===" "||r.key==="Enter"){De(r),i(c.element);return}}});return o.jsx(xo,{"data-likec4-search-elements":!0,allowRangeSelection:!1,clearSelectionOnOutsideClick:!0,selectOnClick:!1,tree:a,data:n,levelOffset:"lg",classNames:{root:K0,node:S(Ho,Z0),label:U0,subtree:Q0},onKeyDownCapture:s,renderNode:c1})}function c1({node:e,elementProps:t,hasChildren:n,expanded:i}){const{element:a,searchTerms:s}=e,r=Hg({element:{id:a.id,title:a.title,shape:a.shape,icon:a.icon},className:S(Bt.icon,n1)}),l=[...a.views()],d=Ed(),c=`@tree.${e.value}`;return o.jsxs(ne,{layoutId:c,...t,children:[o.jsx(Z,{variant:"transparent",size:16,tabIndex:-1,className:S(J0),style:{visibility:n?"visible":"hidden"},children:o.jsx(It,{stroke:3.5,style:{transition:"transform 150ms ease",transform:`rotate(${i?"90deg":"0"})`,width:"100%"}})}),o.jsxs(fe,{component:He,layout:!0,tabIndex:-1,"data-value":a.id,className:S(Bt.root,"group","likec4-element-button"),...l.length>0&&{onClick:u=>{(!n||i)&&(u.stopPropagation(),d(a))}},children:[r,o.jsxs(X,{style:{flexGrow:1},children:[o.jsxs(oe,{gap:"xs",wrap:"nowrap",align:"center",className:e1,children:[o.jsx(jt,{component:"div",highlight:s,className:Bt.title,children:e.label}),o.jsx(Me,{label:a.id,withinPortal:!1,fz:"xs",disabled:!a.id.includes("."),children:o.jsx(jt,{component:"div",highlight:s,className:S(t1,Bt.descriptionColor),children:ga(a.id)})})]}),o.jsx(jt,{component:"div",highlight:s,className:Bt.description,lineClamp:1,children:a.summary.text||"No description"})]}),o.jsx(z,{component:"div",className:S(o1,Bt.descriptionColor),fz:"xs",children:l.length===0?"No views":o.jsxs(o.Fragment,{children:[l.length," view",l.length>1?"s":""]})})]})]})}function Ed(){const e=W(),t=ht();return B(n=>{const i=[...n.views()];if(i.length===0)return;const a=no(i);if(a){t.send({type:"close"}),a.id!==e.currentView.id&&setTimeout(()=>{e.navigateTo(a.id)},100);return}t.send({type:"pickview.open",elementFqn:n.id})})}const u1=x({border:"transparent",background:{base:"transparent",_focusWithin:{base:"mantine.colors.gray[4]/55 !important",_dark:"mantine.colors.dark[5]/55 !important"},_groupHover:{base:"mantine.colors.gray[3]/35",_dark:"mantine.colors.dark[5]/35"}}}),p1=x({position:"absolute",inset:"0",width:"100%",height:"100%",backgroundColor:"[rgb(34 34 34 / 0.7)]",zIndex:902,backdropFilter:"auto",backdropBlur:"10px",_light:{backgroundColor:"[rgb(255 255 255 / 0.6)]"}}),g1=x({position:"absolute",top:"[2rem]",left:"[50%]",width:"100%",maxWidth:"600px",minWidth:"200px",transform:"translateX(-50%)",zIndex:903}),Ks=x({marginTop:"2","& + &":{marginTop:"[32px]"}});x({height:["100%","100cqh"],"& .mantine-ScrollArea-viewport":{minHeight:"100%","& > div":{minHeight:"100%",height:"100%"}}});function h1({elementFqn:e}){const t=ht(),n=be().element(e),i=[],a=[];for(const r of n.views())r.viewOf===n?i.push(r):a.push(r);const s=()=>{t.send({type:"pickview.close"})};return jr("keydown",r=>{try{r.key==="Escape"&&(r.stopPropagation(),r.preventDefault(),s())}catch(l){console.warn(l)}},{capture:!0}),o.jsxs(o.Fragment,{children:[o.jsx(ne,{className:p1,onClick:r=>{r.stopPropagation(),s()}},"pickview-backdrop"),o.jsx(Zc,{children:o.jsxs(ne,{initial:{opacity:0,scale:.95,originY:0,translateX:"-50%",translateY:-20},animate:{opacity:1,scale:1,translateY:0},exit:{opacity:0,scale:.98,translateY:-20,transition:{duration:.1}},className:g1,"data-likec4-search-views":!0,children:[o.jsxs(oe,{px:"sm",py:"md",justify:"space-between",children:[o.jsx(dn,{order:2,lh:1,children:"Select view"}),o.jsx(Z,{size:"md",variant:"default",onClick:r=>{r.stopPropagation(),s()},children:o.jsx(jn,{})})]}),o.jsxs(Xe,{mah:"calc(100vh - 110px)",type:"never",children:[i.length>0&&o.jsxs(Te,{gap:"sm",px:"sm",className:Ks,children:[o.jsx(dn,{order:6,c:"dimmed",children:"scoped views of the element"}),i.map((r,l)=>o.jsx(Li,{view:r,search:"",loop:!0,mod:{autofocus:l===0}},r.id))]}),a.length>0&&o.jsxs(Te,{gap:"sm",px:"sm",className:Ks,children:[o.jsx(dn,{order:6,c:"dimmed",children:"views including this element"}),a.map((r,l)=>o.jsx(Li,{view:r,search:"",loop:!0,mod:{autofocus:l===0&&i.length===0}},r.id))]})]})]},"pickview")})]})}function m1(){const e=m.useRef(null);let t=be().tagsSortedByUsage,n=V0(),i=Ra(),a=t.length;if(i.startsWith("#")){const r=i.slice(1);t=t.filter(({tag:l})=>l.toLocaleLowerCase().includes(r))}if(t.length===0)return null;const s=t.length!==a;return o.jsxs(ae,{ref:e,css:{gap:"md",paddingLeft:"[48px]",flexWrap:"nowrap"},children:[o.jsx(ae,{css:{gap:"1.5",flexWrap:"wrap",opacity:s?1:.3,grayscale:s?0:.9,filter:"auto",transition:"fast",_groupHover:{opacity:1,grayscale:0},_groupFocusWithin:{opacity:1,grayscale:0}},children:t.map(({tag:r})=>o.jsx(To,{tag:r,className:x({userSelect:"none",cursor:"pointer"}),onClick:l=>{l.stopPropagation(),n(`#${r}`),setTimeout(()=>{ho(e.current)},350)}},r))}),s&&o.jsx(ke,{size:"compact-xs",variant:"light",onClick:r=>{r.stopPropagation(),n(""),Dn(e.current)},rightSection:o.jsx(jn,{size:14}),children:"Clear"})]})}function Us(e){return e.match(/^(k|ki|kin|kind|kind:)$/)!=null}const f1=["#","kind:"],x1=m.memo(()=>{const e=ht(),t=be(),n=m.useRef(null),{ref:i,focused:a}=Zd(),[s,r]=$0(),l=Kd({scrollBehavior:"smooth",loop:!1});jr("keydown",u=>{try{!a&&(u.key==="Backspace"||u.key.startsWith("Arrow")||u.key.match(new RegExp("^\\p{L}$","u")))&&Dn(n.current)}catch(p){console.warn(p)}});let d=[],c=!1;switch(!0){case s.startsWith("#"):{const u=s.toLocaleLowerCase().slice(1),p=t.tags.filter(g=>g.toLocaleLowerCase().includes(u));p.length===0?(c=!1,d=[o.jsx(Ba,{children:"No tags found"},"empty-tags")]):(c=t.tags.some(g=>g.toLocaleLowerCase()===u),d=p.map(g=>o.jsxs(Ta,{value:`#${g}`,children:[o.jsx(z,{component:"span",opacity:.5,mr:1,fz:"sm",children:"#"}),g]},g)));break}case s.startsWith("kind:"):case Us(s):{const u=s.length>5?s.slice(5).toLocaleLowerCase():"";let p=$i(t.specification.elements);u&&(p=p.filter(g=>g.toLocaleLowerCase().includes(u))),p.length===0?(c=!1,d=[o.jsx(Ba,{children:"No kinds found"},"empty-kinds")]):(c=p.some(g=>g.toLocaleLowerCase()===u),d=p.map(g=>o.jsxs(Ta,{value:`kind:${g}`,children:[o.jsx(z,{component:"span",opacity:.5,mr:1,fz:"sm",children:"kind:"}),g]},g)));break}}return o.jsxs(Ud,{onOptionSubmit:u=>{r(u),l.resetSelectedOption(),f1.includes(u)||(l.closeDropdown(),setTimeout(()=>{ho(n.current)},350))},width:"max-content",position:"bottom-start",shadow:"md",offset:{mainAxis:4,crossAxis:50},store:l,withinPortal:!1,children:[o.jsx(Qd,{children:o.jsx(mi,{ref:Oi(n,i),placeholder:"Search by title, description or start with # or kind:",autoFocus:!0,"data-autofocus":!0,"data-likec4-search-input":!0,tabIndex:0,classNames:{input:u1},size:"lg",value:s,leftSection:o.jsx(la,{style:{width:tt(20)},stroke:2}),rightSection:o.jsx(mi.ClearButton,{onClick:u=>{u.stopPropagation();const p=e.getSnapshot().context.openedWithSearch;s===""||s===p?e.send({type:"close"}):r("")}}),rightSectionPointerEvents:"auto",onChange:u=>{r(u.currentTarget.value),l.openDropdown(),l.updateSelectedOptionIndex()},onClick:()=>l.openDropdown(),onFocus:()=>l.openDropdown(),onBlur:()=>l.closeDropdown(),onKeyDownCapture:u=>{if(u.key==="Tab"){switch(!0){case l.getSelectedOptionIndex()>=0:return l.clickSelectedOption(),De(u);case d.length===1:return l.selectFirstOption()&&l.clickSelectedOption(),De(u);case Us(s):return r("kind:"),De(u)}return}if(u.key==="Backspace"&&l.dropdownOpened){if(s==="kind:")return r(""),l.resetSelectedOption(),De(u);if(s.startsWith("kind:")&&c)return r("kind:"),l.resetSelectedOption(),De(u);if(s.startsWith("#")&&c)return r("#"),l.resetSelectedOption(),De(u)}if(u.key==="Escape"&&l.dropdownOpened&&d.length>0){De(u),l.closeDropdown();return}if(u.key==="ArrowUp"&&l.dropdownOpened&&s===""&&l.getSelectedOptionIndex()===0){l.closeDropdown(),De(u);return}if(u.key==="ArrowDown"&&(!l.dropdownOpened||d.length===0||c||s===""&&l.getSelectedOptionIndex()===d.length-1)){l.closeDropdown(),De(u),ho(n.current);return}}})}),o.jsx(Jd,{hidden:d.length===0,style:{minWidth:300},children:o.jsx(ec,{children:o.jsx(Xe,{mah:"min(322px, calc(100cqh - 50px))",type:"scroll",children:d})})})]})}),y1=x({backgroundColor:"[rgb(34 34 34 / var(--_opacity, 95%))]",_light:{backgroundColor:"[rgb(250 250 250 / var(--_opacity, 95%))]"},backdropFilter:"auto",backdropBlur:"var(--_blur, 10px)"}),b1=x({width:"100%",height:"100%",maxHeight:"100vh",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"stretch",gap:"sm",paddingTop:"[20px]",paddingLeft:"md",paddingRight:"md",paddingBottom:"sm",background:"[transparent]"}),w1=e=>!e.matches("inactive");function v1({searchActorRef:e}){const t=ee.useSelector(e,w1),n=()=>{e.send({type:"open"})},i=B(()=>{e.send({type:"close"})});return wc([["mod+k",n,{preventDefault:!0}],["mod+f",n,{preventDefault:!0}]]),o.jsx(A0,{value:e,children:o.jsx(Pt.Overlays,{children:o.jsx(Gi,{FallbackComponent:ba,onReset:i,children:o.jsx(Ee,{children:t&&o.jsx(uo,{fullscreen:!0,withBackdrop:!1,backdrop:{opacity:.9},classes:{dialog:y1,body:b1},openDelay:0,onClose:i,"data-likec4-search":"true",children:o.jsx(k1,{searchActorRef:e})})})})})})}const Qs=x({height:["100%","100cqh"],"& .mantine-ScrollArea-viewport":{minHeight:"100%","& > div":{minHeight:"100%",height:"100%"}}}),k1=({searchActorRef:e})=>{const t=m.useRef(null),n=W0();return Jn(()=>{_e(e.getSnapshot().context.openedWithSearch)&&ho(t.current)},150),o.jsxs(J,{ref:t,display:"contents",children:[o.jsx(oe,{className:"group",wrap:"nowrap",onClick:i=>{i.stopPropagation(),Dn(t.current)},children:o.jsxs(Qt,{flex:1,px:"sm",children:[o.jsx(x1,{}),o.jsx(m1,{})]})}),o.jsxs(za,{children:[o.jsx(Ln,{span:6,children:o.jsx(dn,{component:"div",order:6,c:"dimmed",pl:"sm",children:"Elements"})}),o.jsx(Ln,{span:6,children:o.jsx(dn,{component:"div",order:6,c:"dimmed",pl:"sm",children:"Views"})})]}),o.jsxs(za,{className:x({containerName:"likec4-search-elements",containerType:"size",overflow:"hidden",flexGrow:1}),children:[o.jsx(Ln,{span:6,children:o.jsx(vt,{type:"scroll",className:Qs,pr:"xs",scrollbars:"y",children:o.jsx(Ee,{children:o.jsx(Wt,{id:"likec4-search-elements",children:o.jsx(r1,{})})})})}),o.jsx(Ln,{span:6,children:o.jsx(vt,{type:"scroll",className:Qs,pr:"xs",scrollbars:"y",children:o.jsx(Ee,{children:o.jsx(Wt,{id:"likec4-search-views",children:o.jsx(s1,{})})})})})]}),n&&o.jsx(h1,{elementFqn:n})]})},j1=h.setup({types:{context:{},events:{},tags:"opened"},delays:{"open timeout":({context:e})=>e.openTimeout,"close timeout":600,"long idle":1500},actions:{"update edgeId":h.assign(({context:e,event:t})=>(h.assertEvent(t,["xyedge.select","xyedge.mouseEnter"]),{edgeId:t.edgeId,edgeSelected:e.edgeSelected||t.type==="xyedge.select"})),"increase open timeout":h.assign(()=>({openTimeout:800})),"decrease open timeout":h.assign(()=>({openTimeout:300})),"reset edgeId":h.assign({edgeId:null,edgeSelected:!1})},guards:{"edge was selected":({context:e})=>e.edgeSelected,"edge was hovered":({context:e})=>!e.edgeSelected}}).createMachine({id:"breadcrumbs",context:()=>({edgeId:null,edgeSelected:!1,openTimeout:800}),initial:"idle",on:{close:{target:"#idle",actions:["reset edgeId","increase open timeout"]}},states:{idle:{id:"idle",on:{"xyedge.mouseEnter":{target:"opening",actions:"update edgeId"},"xyedge.select":{target:"active",actions:"update edgeId"}},after:{"long idle":{actions:"increase open timeout"}}},opening:{on:{"xyedge.mouseLeave":{target:"idle"},"xyedge.select":{target:"active",actions:"update edgeId"}},after:{"open timeout":{actions:"decrease open timeout",target:"active"}}},active:{tags:["opened"],initial:"opened",exit:"reset edgeId",on:{"xyedge.unselect":{target:"idle",actions:"increase open timeout"},"xyedge.select":{actions:"update edgeId"}},states:{opened:{on:{"dropdown.mouseEnter":{target:"hovered"},"xyedge.mouseLeave":{guard:"edge was hovered",target:"closing"}}},hovered:{on:{"dropdown.mouseLeave":[{guard:"edge was selected",target:"opened"},{target:"closing"}]}},closing:{on:{"xyedge.mouseEnter":{guard:"edge was hovered",target:"opened",actions:"update edgeId"},"xyedge.select":{target:"opened",actions:"update edgeId"},"dropdown.mouseEnter":{target:"hovered"}},after:{"close timeout":{target:"#idle"}}}}}}}),C1=j1,Js=x({display:"block",fontSize:"xxs",fontWeight:500,whiteSpace:"nowrap",paddingX:"1",paddingY:"0.5",borderRadius:"[2px]",background:{_light:"var(--likec4-palette-fill)/90",_dark:"var(--likec4-palette-fill)/60"},lineHeight:"1",color:{_light:"var(--likec4-palette-hiContrast)",_dark:"var(--likec4-palette-loContrast)"}}),S1=x({whiteSpaceCollapse:"preserve-breaks",fontSize:"sm",lineHeight:"sm",userSelect:"all"});function _1(e){let t=null;for(const n of e.xyedges)if(n.selected){if(t){t=null;break}t=n.data.id}return{viewId:e.view.id,selected:t}}const P1=m.memo(()=>{const e=be(),t=ee.useActorRef(C1),n=W(),{viewId:i,selected:a}=Ne(_1),s=ee.useSelector(t,f=>f.hasTag("opened")?f.context.edgeId:null);$e("navigateTo",()=>{t.send({type:"close"})}),$e("edgeMouseEnter",({edge:f})=>{t.send({type:"xyedge.mouseEnter",edgeId:f.data.id})}),$e("edgeMouseLeave",()=>{t.send({type:"xyedge.mouseLeave"})}),$e("edgeEditingStarted",()=>{t.send({type:"close"})}),$e("walkthroughStarted",()=>{t.send({type:"close"})}),m.useEffect(()=>{a?t.send({type:"xyedge.select",edgeId:a}):t.send({type:"xyedge.unselect"})},[a]);const r=m.useCallback(f=>{if(!s)return;t.send({type:"dropdown.mouseEnter"});const y=n.findEdge(s);y&&!y.data.hovered&&n.send({type:"xyflow.edgeMouseEnter",edge:y,event:f})},[t,n,s]),l=m.useCallback(f=>{if(!s)return;t.send({type:"dropdown.mouseLeave"});const y=n.findEdge(s);y?.data.hovered&&n.send({type:"xyflow.edgeMouseLeave",edge:y,event:f})},[t,n,s]),{diagramEdge:d,sourceNode:c,targetNode:u}=Ne(f=>{const y=s?wa(f,s):null,b=y?Ot(f,y.source):null,C=y?Ot(f,y.target):null;return{diagramEdge:y,sourceNode:b,targetNode:C}},le,[s]);if(!d||!c||!u||ut(d.relations))return null;const[p,g]=re(d.relations,me(f=>{try{return e.relationship(f)}catch(y){return console.error(`View is cached and likec4model missing relationship ${f} from ${c.id} -> ${u.id}`,y),null}}),qt(_e),Cr(f=>f.source.id===c.id&&f.target.id===u.id));return p.length===0&&g.length===0?(console.warn("No relationships found  diagram edge",{diagramEdge:d,sourceNode:c,targetNode:u}),null):o.jsx(Nx,{children:o.jsx(E1,{viewId:i,direct:p,nested:g,diagramEdge:d,sourceNode:c,targetNode:u,onMouseEnter:r,onMouseLeave:l})})}),M1=(e,t)=>t?.querySelector(`.likec4-edge-label[data-edge-id="${e}"]`)??null,di=8,E1=({viewId:e,diagramEdge:t,direct:n,nested:i,sourceNode:a,targetNode:s,onMouseEnter:r,onMouseLeave:l})=>{const d=m.useRef(null),{enableNavigateTo:c,enableVscode:u}=K(),{onOpenSource:p}=at(),g=qh(),[f,y]=m.useState(null);m.useLayoutEffect(()=>{y(M1(t.id,g.current))},[t]),m.useEffect(()=>{const k=f,v=d.current;if(!k||!v)return;let M=!1;const w=tc(k,v,()=>{nc(k,v,{placement:"bottom-start",middleware:[oc(4),ic({crossAxis:!0,padding:di,allowedPlacements:["bottom-start","top-start","right-start","right-end","left-end"]}),ac({padding:di,apply({availableHeight:j,availableWidth:_,elements:L}){M||Object.assign(L.floating.style,{maxWidth:`${Ve(Be(_),{min:200,max:400})}px`,maxHeight:`${Ve(Be(j),{min:0,max:500})}px`})}}),sc({padding:di*2})]}).then(({x:j,y:_,middlewareData:L})=>{M||(v.style.transform=`translate(${Be(j)}px, ${Be(_)}px)`,v.style.visibility=L.hide?.referenceHidden?"hidden":"visible")})},{ancestorResize:!1,animationFrame:!0});return()=>{M=!0,w()}},[f]);const b=W(),C=m.useCallback((k,v)=>o.jsxs(m.Fragment,{children:[v>0&&o.jsx(wo,{}),o.jsx(N1,{viewId:e,relationship:k,sourceNode:a,targetNode:s,onNavigateTo:c?M=>{b.navigateTo(M)}:void 0,...p&&u&&{onOpenSource:()=>p({relation:k.id})}})]},k.id),[e,a,s,b,c,p,u]);return o.jsx(Xe,{ref:d,onMouseEnter:r,onMouseLeave:l,type:"auto",scrollbars:"y",scrollbarSize:6,styles:{viewport:{overscrollBehavior:"contain",minWidth:180}},className:S(x({layerStyle:"likec4.dropdown",p:"0",pointerEvents:{base:"all",_whenPanning:"none"},position:"absolute",top:"0",left:"0",width:"max-content",cursor:"default"})),children:o.jsxs(Qt,{css:{gap:"3",padding:"4",paddingTop:"2"},children:[o.jsx(ke,{variant:"default",color:"gray",size:"compact-xs",style:{alignSelf:"flex-start",fontWeight:500,"--button-fz":"var(--font-sizes-xxs)"},onClick:k=>{k.stopPropagation(),b.openRelationshipDetails(t.id)},children:"browse relationships"}),n.length>0&&o.jsxs(o.Fragment,{children:[o.jsx($t,{children:"DIRECT RELATIONSHIPS"}),n.map(C)]}),i.length>0&&o.jsxs(o.Fragment,{children:[o.jsx($t,{css:{mt:n.length>0?"2":"0"},children:"RESOLVED FROM NESTED"}),i.map(C)]})]})})},N1=m.forwardRef(({viewId:e,relationship:t,sourceNode:n,targetNode:i,onNavigateTo:a,onOpenSource:s},r)=>{const l=er(t,"source",n),d=er(t,"target",i),c=a&&t.navigateTo?.id!==e?t.navigateTo?.id:void 0,u=t.links;return o.jsxs(Qt,{ref:r,className:jl({block:"2",inline:"2",paddingY:"2.5",paddingX:"2",gap:"1",rounded:"sm",backgroundColor:{_hover:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]/70"}}}),children:[o.jsx(ae,{gap:"0.5",children:o.jsxs(vo,{openDelay:200,children:[o.jsx(Yn,{label:l.full,offset:2,position:"top-start",children:o.jsx(z,{component:"div","data-likec4-color":n.color,className:Js,children:l.short})}),o.jsx(Xt,{stroke:2.5,size:"11px",opacity:.65}),o.jsx(Yn,{label:d.full,offset:2,position:"top-start",children:o.jsx(z,{component:"div","data-likec4-color":i.color,className:Js,children:d.short})}),c&&o.jsx(Yn,{label:"Open dynamic view",children:o.jsx(Z,{size:"sm",radius:"sm",variant:"default",onClick:p=>{p.stopPropagation(),a?.(c)},style:{alignSelf:"flex-end"},role:"button",children:o.jsx(Ae,{size:"80%",stroke:2})})}),s&&o.jsx(Yn,{label:"Open source",children:o.jsx(Z,{size:"sm",radius:"sm",variant:"default",onClick:p=>{p.stopPropagation(),s()},role:"button",children:o.jsx(Ut,{size:"80%",stroke:2})})})]})}),o.jsx(J,{className:S1,children:t.title||"untitled"}),t.kind&&o.jsxs(ae,{gap:"2",children:[o.jsx($t,{children:"kind"}),o.jsx(z,{size:"xs",className:x({userSelect:"all"}),children:t.kind})]}),t.technology&&o.jsxs(ae,{gap:"2",children:[o.jsx($t,{children:"technology"}),o.jsx(z,{size:"xs",className:x({userSelect:"all"}),children:t.technology})]}),t.description.nonEmpty&&o.jsxs(o.Fragment,{children:[o.jsx($t,{children:"description"}),o.jsx(J,{css:{paddingLeft:"2.5",py:"1.5",borderLeft:"2px dotted",borderLeftColor:{base:"mantine.colors.gray[3]",_dark:"mantine.colors.dark[4]"}},children:o.jsx(Et,{value:t.description,fontSize:"sm"})})]}),u.length>0&&o.jsxs(o.Fragment,{children:[o.jsx($t,{children:"links"}),o.jsx(ae,{gap:"1",flexWrap:"wrap",children:u.map(p=>o.jsx(_a,{size:"sm",value:p},p.url))})]})]})}),$t=st("div",{base:{display:"block",fontSize:"xxs",fontWeight:500,userSelect:"none",lineHeight:"sm",color:"mantine.colors.dimmed"}}),Yn=Me.withProps({color:"dark",fz:"xs",label:"",children:null,offset:8,withinPortal:!1});function er(e,t,n){const i=e.isDeploymentRelation()?n.id:n.modelRef||"",a=e[t].id,s=ga(i)+a.slice(i.length);return{full:a,short:s}}const ci=x({position:"absolute",bottom:"0",right:"0",padding:"2",margin:"0",width:"min-content",height:"min-content"}),I1=x({"--ai-radius":"0px",_noReduceGraphics:{"--ai-radius":"{radii.md}"}}),R1=x({cursor:"default",userSelect:"none",minWidth:200,maxWidth:"calc(100vw - 20px)",backgroundColor:"mantine.colors.body/80",sm:{minWidth:300,maxWidth:"65vw"},md:{maxWidth:"40vw"},_dark:{backgroundColor:"mantine.colors.dark[6]/80"}}),D1=x({padding:"xxs"}),B1=x({backgroundColor:"transparent",transition:"all 100ms ease-in",_hover:{transition:"all 120ms ease-out",backgroundColor:"mantine.colors.primary[2]/50"},_dark:{_hover:{backgroundColor:"mantine.colors.dark[3]/40"}}});x({fill:"var(--likec4-palette-fill)",stroke:"var(--likec4-palette-stroke)",strokeWidth:1,overflow:"visible",width:"100%",height:"auto",filter:`
    drop-shadow(0 2px 3px rgb(0 0 0 / 22%))
    drop-shadow(0 1px 8px rgb(0 0 0 / 10%))
  `});const T1=x({fontWeight:500,letterSpacing:"0.2px",paddingTop:"0",paddingBottom:"0",textTransform:"lowercase",transition:"all 150ms ease-in-out",cursor:"pointer","--badge-radius":"2px","--badge-fz":"9.5px","--badge-padding-x":"3px","--badge-height":"13.5px","--badge-lh":"1","--badge-bg":"var(--likec4-palette-fill)","--badge-color":"var(--likec4-palette-hiContrast)"}),L1=({value:e})=>{const{title:t,color:n="primary",shape:i="rectangle"}=e,[a,s]=m.useState(null),r=W(),l=300,d=200;return o.jsx(xc,{shadow:"none",px:"xs",py:"sm",className:S(B1),"data-likec4-color":n,onMouseEnter:()=>{s(null),r.highlightNotation(e)},onMouseLeave:()=>{s(null),r.unhighlightNotation()},children:o.jsxs(oe,{gap:"sm",align:"stretch",wrap:"nowrap",children:[o.jsx(X,{flex:"0 0 70px",style:{position:"relative",width:70,height:yc(70*(d/l),0)},children:o.jsx(nn,{data:{shape:i,width:l,height:d}})}),o.jsxs(Te,{gap:4,flex:1,children:[o.jsx(oe,{gap:4,flex:"0 0 auto",children:e.kinds.map(c=>o.jsx(St,{className:S(T1),onMouseEnter:()=>{s(c),r.highlightNotation(e,c)},onMouseLeave:()=>{s(null),r.highlightNotation(e)},opacity:Nr(a)&&a!==c?.25:1,children:c},c))}),o.jsx(z,{component:"div",fz:"sm",fw:500,lh:"1.25",style:{textWrap:"pretty"},children:t})]})]})})},A1=e=>({id:e.view.id,notations:e.view.notation?.nodes??[],isVisible:!0}),z1=m.memo(()=>{const e=ua(d=>d.height),{id:t,notations:n,isVisible:i}=Ne(A1),[a,s]=rc({key:"notation-webview-collapsed",defaultValue:!0}),r=n.length>0,l=en();return o.jsxs(Ee,{children:[!r&&i&&o.jsx(Oe.div,{initial:{opacity:.75,translateX:"50%"},animate:{opacity:1,translateX:0},exit:{translateX:"100%",opacity:.6},className:ci,children:o.jsx(Me,{label:"View has no notations",color:"orange",...l,children:o.jsx(Ke,{size:"lg",variant:"light",color:"orange",radius:"md",children:o.jsx(nl,{})})})},"empty"),r&&i&&a&&o.jsx(Oe.div,{initial:{opacity:.75,translateX:"50%"},animate:{opacity:1,translateX:0},exit:{translateX:"100%",opacity:.6},className:ci,children:o.jsx(Me,{label:"Show notation",color:"dark",fz:"xs",...l,children:o.jsx(Z,{size:"lg",variant:"default",color:"gray",className:I1,onClick:()=>s(!1),children:o.jsx(Ap,{stroke:1.5})})})},"collapsed"),r&&i&&!a&&o.jsx(Oe.div,{initial:{opacity:.75,scale:.2},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.25},className:S("react-flow__panel",ci),style:{transformOrigin:"bottom right"},children:o.jsx(qi,{radius:"sm",withBorder:!0,shadow:"lg",className:R1,children:o.jsxs(Sr,{defaultValue:"first",radius:"xs",children:[o.jsxs(_r,{children:[o.jsx(Z,{size:"md",variant:"subtle",color:"gray",ml:2,style:{alignSelf:"center"},onClick:()=>s(!0),children:o.jsx(pp,{stroke:2})}),o.jsx(fi,{value:"first",fz:"xs",children:"Elements"}),o.jsx(fi,{value:"second",fz:"xs",disabled:!0,children:"Relationships"})]}),o.jsx(Lt,{value:"first",className:D1,hidden:a,children:o.jsx(Xe,{viewportProps:{style:{maxHeight:`min(40vh, ${Math.max(e-60,50)}px)`}},children:o.jsx(Te,{gap:0,children:n.map((d,c)=>o.jsx(L1,{value:d},c))})})})]})})},t)]})}),Nd=m.memo(()=>{const{enableControls:e,enableNotations:t,enableSearch:n,enableRelationshipDetails:i}=K(),a=lc(),s=_l(),r=Nm();return o.jsxs(Cl,{onReset:a,children:[e&&o.jsx(nm,{children:o.jsx(gd,{})}),s&&o.jsx(L0,{overlaysActorRef:s}),t&&o.jsx(z1,{}),n&&r&&o.jsx(v1,{searchActorRef:r}),i&&o.jsx(P1,{})]})});Nd.displayName="DiagramUI";const $1=".react-flow__edge.selected",F1=x({overflow:"visible",position:"absolute",pointerEvents:"none",top:"0",left:"0",mixBlendMode:"normal"}),V1=x({fill:"var(--likec4-palette-relation-stroke)",stroke:"var(--likec4-palette-relation-stroke)",fillOpacity:.75,strokeWidth:1,cursor:"grab",pointerEvents:"auto",visibility:"hidden",_hover:{fillOpacity:1,stroke:"mantine.colors.primary.filledHover",strokeWidth:10,transition:"stroke 100ms ease-out, stroke-width 100ms ease-out"},[`:where(${$1}, [data-likec4-hovered='true']) &`]:{visibility:"visible",transition:"fill-opacity 150ms ease-out, stroke 150ms ease-out, stroke-width 150ms ease-out",transitionDelay:"50ms",fillOpacity:1,strokeWidth:5}}),O1=x({cursor:"grabbing","& *":{cursor:"grabbing !important"},"& .react-flow__edge-interaction":{cursor:"grabbing !important"}});function W1(e){const{width:t,height:n}=it(e),{x:i,y:a}=e.internals.positionAbsolute;return{x:i+t/2,y:a+n/2}}function Gn(e,t,n=0){const i=W1(e),{width:a,height:s}=it(e),r=new ve(t.x,t.y).sub(i),l=(n+(a||0)/2)/r.x,d=(n+(s||0)/2)/r.y,c=Math.min(Math.abs(l),Math.abs(d));return Ct(r).mul(c).add(i)}const H1=dc().curve(cc).x(e=>e.x).y(e=>e.y),q1=Sa(e=>{const[t,n]=m.useState(!1),i=pa(),a=Xg(),s=W(),{enableNavigateTo:r,enableEdgeEditing:l}=K(),{id:d,source:c,sourceX:u,sourceY:p,target:g,targetX:f,targetY:y,selected:b=!1,data:{id:C,points:k,hovered:v=!1,active:M=!1,labelBBox:w,labelXY:j,..._},style:L={}}=e,P=r?_.navigateTo:void 0,V=F(Qa(c),`source node ${c} not found`),O=F(Qa(g),`target node ${g} not found`),D=_e(_.controlPoints)||!rn(V.internals.positionAbsolute,V.data)||!rn(O.internals.positionAbsolute,O.data);let $=_.controlPoints??ul(e.data),H;if(D){const Y={x:u,y:p},U={x:f,y},G=6,we=_.dir==="back"?[U,Gn(O,gn($)??Y,G),...$,Gn(V,wt($)??U,G),Y]:[Y,Gn(V,gn($)??U,G),...$,Gn(O,wt($)??Y,G),U];H=F(H1(we))}else H=Ah(k);let E=w?.x??0,N=w?.y??0;const[Q,je]=m.useState({x:j?.x??E,y:j?.y??N}),he=m.useRef(null);m.useEffect(()=>{const Y=he.current;if(!Y)return;const U=Y.getPointAtLength(Y.getTotalLength()*.5),G={x:Be(U.x),y:Be(U.y)};je(we=>rn(we,G)?we:G)},[H]),uu(()=>{!w||w.x===Q.x&&w.y===Q.y||s.updateEdgeData(d,{labelXY:{x:Q.x,y:Q.y}})},[Q],50,300),(D||t)&&(E=Q.x,N=Q.y);const lt=(Y,U,G)=>{const{addSelectedEdges:we}=i.getState();we([d]);const Ie=s.cancelSaveManualLayout();U.stopPropagation();let Ce=!1,Ue={x:U.clientX,y:U.clientY};const mt=ze=>{const xt={x:ze.clientX,y:ze.clientY};if(!rn(Ue,xt)){n(!0),Ce||(s.send({type:"xyflow.edgeEditingStarted",edge:e.data}),Ce=!0),Ue=xt;const{x:Tn,y:qo}=a.screenToFlowPosition(Ue,{snapToGrid:!1}),an=$.slice();an[Y]={x:Be(Tn),y:Be(qo)},s.updateEdgeData(d,{controlPoints:an})}ze.stopPropagation()},ft=ze=>{G.removeEventListener("pointermove",mt,{capture:!0}),Ce&&ze.stopPropagation(),(Ce||Ie)&&s.scheduleSaveManualLayout(),n(!1)},Bn=ze=>{ze.stopPropagation(),ze.preventDefault()};G.addEventListener("pointermove",mt,{capture:!0}),G.addEventListener("pointerup",ft,{once:!0,capture:!0}),G.addEventListener("click",Bn,{capture:!0,once:!0})},se=(Y,U,G)=>{if($.length<=1)return;const we=Ie=>{const Ce=$.slice();Ce.splice(Y,1),Ie.stopPropagation(),setTimeout(()=>{s.updateEdgeData(d,{controlPoints:Ce}),s.scheduleSaveManualLayout()},10)};G.addEventListener("pointerup",we,{once:!0,capture:!0}),U.stopPropagation()},on=(Y,U)=>{const{domNode:G}=i.getState();if(!(!G||U.pointerType!=="mouse"))switch(U.button){case 0:lt(Y,U,G);break;case 2:se(Y,U,G);break}},A=Y=>{const{domNode:U}=i.getState();if(!U||Y.pointerType!=="mouse"||Y.button!==2)return;const G=[new ve(u,p),...$.map(Ct)||[],new ve(f,y)];let we={x:Y.clientX,y:Y.clientY};const Ie=Ct(a.screenToFlowPosition(we,{snapToGrid:!1}));let Ce=0,Ue=1/0;for(let ft=0;ft<G.length-1;ft++){const Bn=G[ft],ze=G[ft+1],xt=ze.sub(Bn),Tn=Ie.sub(Bn),qo=Ie.sub(ze);if(xt.dot(Tn)*xt.dot(qo)<0){const an=Math.abs(xt.cross(Tn).abs()/xt.abs());an<Ue&&(Ue=an,Ce=ft)}}const mt=$.slice()||[];mt.splice(Ce,0,Ie),s.updateEdgeData(d,{controlPoints:mt}),s.scheduleSaveManualLayout(),Y.stopPropagation()};let xe=We.Edge;return(v||M)&&(xe=We.Element+1),o.jsxs(o.Fragment,{children:[o.jsxs(fn,{...e,className:S(t&&O1),children:[o.jsx(En,{edgeProps:e,svgPath:H,ref:he,...l&&{onEdgePointerDown:A}}),o.jsx(Do,{edgeProps:e,labelPosition:{x:E,y:N,translate:D?"translate(-50%, 0)":void 0},children:o.jsx(Mn,{edgeProps:e,children:P&&o.jsx(Ro,{onClick:Y=>{Y.stopPropagation(),s.navigateTo(P)}})})})]}),l&&$.length>0&&(b||v||t)&&o.jsx($r,{children:o.jsx(fn,{component:"svg",className:F1,...e,style:{...L,zIndex:xe},children:o.jsx("g",{onContextMenu:Y=>{Y.preventDefault(),Y.stopPropagation()},children:$.map((Y,U)=>o.jsx("circle",{onPointerDown:G=>on(U,G),className:S("nodrag nopan",V1),cx:Math.round(Y.x),cy:Math.round(Y.y),r:3},"controlPoints"+C+"#"+U))})})})]})}),Zn=16;function X1(e){const t=W(),{navigateTo:n}=e.data,i=e.source===e.target,a=e.sourceX>e.targetX,[s]=cu({sourceX:e.sourceX,sourceY:e.sourceY,sourcePosition:e.sourcePosition,targetX:e.targetX,targetY:e.targetY,targetPosition:e.targetPosition,...i&&{offset:30,borderRadius:16}});let r=e.sourceX;switch(!0){case i:r=e.sourceX+24+Zn;break;case a:r=e.sourceX-Zn;break;default:r=e.sourceX+Zn;break}return o.jsxs(fn,{...e,children:[o.jsx(En,{edgeProps:e,svgPath:s}),o.jsx(Do,{edgeProps:e,labelPosition:{x:r,y:e.sourceY+(i?0:Zn),translate:a?"translate(-100%, 0)":void 0},children:o.jsx(Mn,{edgeProps:e,children:n&&o.jsx(Ro,{onClick:l=>{l.stopPropagation(),t.navigateTo(n)}})})})]})}const bt={ElementNode:bx,DeploymentNode:wx,CompoundElementNode:vx,CompoundDeploymentNode:kx,ViewGroupNode:jx,SequenceActorNode:Px,SequenceParallelArea:Mx},tr={RelationshipEdge:q1,SequenceStepEdge:X1};class Ft{static LeftPadding=40;static RightPadding=40;static TopPadding=55;static BottomPadding=40;id;minX=1/0;minY=1/0;maxX=-1/0;maxY=-1/0;get positionAbsolute(){return{x:this.minX,y:this.minY}}set positionAbsolute(t){const n=Math.round(t.x),i=Math.round(t.y);this.maxX+=n-this.minX,this.maxY+=i-this.minY,this.minX=n,this.minY=i}get dimensions(){return{width:this.maxX-this.minX,height:this.maxY-this.minY}}get position(){const t=this.positionAbsolute;if(!this.parent)return t;const n=this.parent.positionAbsolute;return{x:t.x-n.x,y:t.y-n.y}}constructor(t,n=null){this.id=t.id,this.positionAbsolute=n?{x:t.position.x+n.minX,y:t.position.y+n.minY}:t.position;const{width:i,height:a}=it(t);this.maxX=this.minX+Math.ceil(i),this.maxY=this.minY+Math.ceil(a),n&&n.children.push(this)}}class ui extends Ft{constructor(t,n=null){super(t,n),this.parent=n}children=[]}class Y1 extends Ft{constructor(t,n=null){super(t,n),this.parent=n}}function Id(e,t){const{parentLookup:n,nodeLookup:i}=e.getState(),a=new Map,s=f=>{const y=[];let b=i.get(f)?.parentId,C;for(;b&&(C=i.get(b));)y.push(C.id),b=C.parentId;return y},r=new Set(t.flatMap(s)),l=[...i.values()].flatMap(f=>f.parentId?[]:{xynode:f,parent:null});for(;l.length>0;){const{xynode:f,parent:y}=l.shift();if(!t.includes(f.id)&&f.type!=="element"&&f.type!=="deployment"&&r.has(f.id)){const b=new ui(f,y);a.set(f.id,b),n.get(f.id)?.forEach(C=>{l.push({xynode:C,parent:b})})}else a.set(f.id,new Y1(f,y))}const d=[...a.values()];c(d);function c(f){for(const y of f){if(!(y instanceof ui))continue;c(y.children);const b={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(const C of y.children)b.minX=Math.min(b.minX,C.minX),b.minY=Math.min(b.minY,C.minY),b.maxX=Math.max(b.maxX,C.maxX),b.maxY=Math.max(b.maxY,C.maxY);y.minX=b.minX-Ft.LeftPadding,y.minY=b.minY-Ft.TopPadding,y.maxX=b.maxX+Ft.RightPadding,y.maxY=b.maxY+Ft.BottomPadding}}function u(){c(d),e.getState().triggerNodeChanges(d.reduce((f,y)=>(f.push({id:y.id,type:"position",dragging:!1,position:y.position,positionAbsolute:y.positionAbsolute}),y instanceof ui&&f.push({id:y.id,type:"dimensions",setAttributes:!0,dimensions:y.dimensions}),f),[]))}let p=null;function g(){d.length!==0&&(p??=requestAnimationFrame(()=>{p=null;const{nodeLookup:f}=e.getState();for(const y of t){const b=F(a.get(y)),C=F(f.get(y));b.positionAbsolute=C.internals.positionAbsolute}u()}))}return{rects:a,updateXYFlowNodes:u,onMove:g}}function G1(){const e=pa(),t=W(),n=m.useRef(void 0);return m.useMemo(()=>{let i=!1;const a={x:0,y:0};let s=!1;return{onNodeDragStart:(r,l)=>{i=t.cancelSaveManualLayout();const{nodeLookup:d}=e.getState(),c=re(Array.from(d.values()),qt(u=>u.draggable!==!1&&(u.dragging===!0||u.id===l.id||u.selected===!0)));de(c,1)&&(n.current=Id(e,me(c,u=>u.id))),a.x=r.clientX,a.y=r.clientY,s=!1},onNodeDrag:r=>{s=Math.abs(r.clientX-a.x)>4||Math.abs(r.clientY-a.y)>4,n.current?.onMove()},onNodeDragStop:r=>{s=Math.abs(r.clientX-a.x)>4||Math.abs(r.clientY-a.y)>4,(i||s)&&t.scheduleSaveManualLayout(),n.current=void 0}}},[e,t])}const Z1={relationship:tr.RelationshipEdge,"seq-step":tr.SequenceStepEdge},dt={element:et(bt.ElementNode),deployment:et(bt.DeploymentNode),"compound-element":et(bt.CompoundElementNode),"compound-deployment":et(bt.CompoundDeploymentNode),"view-group":et(bt.ViewGroupNode),"seq-actor":et(bt.SequenceActorNode),"seq-parallel":et(bt.SequenceParallelArea)};function K1(e){return!e||ut(e)?dt:{element:e.element??dt.element,deployment:e.deployment??dt.deployment,"compound-element":e.compoundElement??dt["compound-element"],"compound-deployment":e.compoundDeployment??dt["compound-deployment"],"view-group":e.viewGroup??dt["view-group"],"seq-actor":e.seqActor??dt["seq-actor"],"seq-parallel":e.seqParallel??dt["seq-parallel"]}}const U1=e=>({initialized:e.initialized.xydata&&e.initialized.xyflow,nodes:e.xynodes,edges:e.xyedges,pannable:e.pannable,zoomable:e.zoomable,fitViewPadding:e.fitViewPadding,enableFitView:e.features.enableFitView,enableReadOnly:e.features.enableReadOnly||e.toggledFeatures.enableReadOnly||e.dynamicViewVariant==="sequence"&&e.view._type==="dynamic",...!e.features.enableFitView&&{viewport:{x:-Math.min(e.view.bounds.x,0),y:-Math.min(e.view.bounds.y,0),zoom:1}}}),Q1=(e,t)=>e.initialized===t.initialized&&e.pannable===t.pannable&&e.zoomable===t.zoomable&&e.enableFitView===t.enableFitView&&e.enableReadOnly===t.enableReadOnly&&I(e.fitViewPadding,t.fitViewPadding)&&le(e.nodes,t.nodes)&&le(e.edges,t.edges)&&le(e.viewport??null,t.viewport??null);function J1({background:e="dots",nodesDraggable:t=!1,nodesSelectable:n=!1,reactFlowProps:i={},children:a,renderNodes:s}){const r=W(),{initialized:l,nodes:d,edges:c,enableReadOnly:u,enableFitView:p,...g}=Ne(U1,Q1),{onNodeContextMenu:f,onCanvasContextMenu:y,onEdgeContextMenu:b,onNodeClick:C,onEdgeClick:k,onCanvasClick:v,onCanvasDblClick:M}=at(),w=!u,j=Yh(),_=G1(),L=Zh(),P=ru(()=>{L.set(!0)},j?120:400),V=lu(()=>{P.clear(),L.get()&&L.set(!1)},j?350:200),O=B(E=>{E&&(L.get()||P.start(),V())}),D=B((E,N)=>{P.clear(),r.send({type:"xyflow.viewportMoved",viewport:N,manually:!!E})}),$=B(()=>{r.send({type:"xyflow.resized"})}),H=ta(()=>K1(s),[s],sl);return So(()=>{console.warn("renderNodes changed - this might degrade performance")},[H]),o.jsx(ha,{nodes:d,edges:c,className:S(l?"initialized":"not-initialized"),nodeTypes:H,edgeTypes:Z1,onNodesChange:B(E=>{r.send({type:"xyflow.applyNodeChanges",changes:E})}),onEdgesChange:B(E=>{r.send({type:"xyflow.applyEdgeChanges",changes:E})}),background:l?e:"transparent",fitView:!1,onNodeClick:B((E,N)=>{E.stopPropagation(),r.send({type:"xyflow.nodeClick",node:N}),C?.(r.findDiagramNode(N.id),E)}),onEdgeClick:B((E,N)=>{E.stopPropagation(),r.send({type:"xyflow.edgeClick",edge:N}),k?.(r.findDiagramEdge(N.id),E)}),onPaneClick:B(E=>{E.stopPropagation(),r.send({type:"xyflow.paneClick"}),v?.(E)}),onDoubleClick:B(E=>{E.stopPropagation(),E.preventDefault(),r.send({type:"xyflow.paneDblClick"}),M?.(E)}),onNodeMouseEnter:B((E,N)=>{E.stopPropagation(),N.data.hovered||r.send({type:"xyflow.nodeMouseEnter",node:N})}),onNodeMouseLeave:B((E,N)=>{E.stopPropagation(),N.data.hovered&&r.send({type:"xyflow.nodeMouseLeave",node:N})}),onEdgeMouseEnter:B((E,N)=>{E.stopPropagation(),N.data.hovered||r.send({type:"xyflow.edgeMouseEnter",edge:N,event:E})}),onEdgeMouseLeave:B((E,N)=>{E.stopPropagation(),N.data.hovered&&r.send({type:"xyflow.edgeMouseLeave",edge:N,event:E})}),onMove:O,onMoveEnd:D,onInit:B(E=>{r.send({type:"xyflow.init",instance:E})}),onNodeContextMenu:B((E,N)=>{const Q=F(r.findDiagramNode(N.id),`diagramNode ${N.id} not found`);f?.(Q,E)}),onEdgeContextMenu:B((E,N)=>{const Q=F(r.findDiagramEdge(N.id),`diagramEdge ${N.id} not found`);b?.(Q,E)}),onPaneContextMenu:B(E=>{y?.(E)}),...p&&{onViewportResize:$},nodesDraggable:w&&t,nodesSelectable:n,edgesFocusable:!1,...w&&t&&_,...g,...i,children:a})}function eb(e){const{view:t,nodesSelectable:n}=e,i=[],a=[],s=new Map,r=Zi.from(t.nodes.reduce((p,g)=>(s.set(g.id,g),g.parent||p.push({node:g,parent:null}),p),[]));let l=p=>!0;if(e.where)try{const p=sn(e.where);l=g=>p({...Or(g,["tags","kind"]),..."source"in g?{source:c(g.source)}:g,..."target"in g?{target:c(g.target)}:g})}catch(p){console.error("Error in where filter:",p)}const d="",c=p=>F(s.get(p),`Node not found: ${p}`);let u;for(;u=r.dequeue();){const{node:p,parent:g}=u,f=de(p.children,1)||p.kind==At;if(f)for(const j of p.children)r.enqueue({node:c(j),parent:p});const y={x:p.x,y:p.y};g&&(y.x-=g.x,y.y-=g.y);const b={id:d+p.id,selectable:n&&p.kind!==At,focusable:n&&p.kind!==At,deletable:!1,position:y,zIndex:f?We.Compound:We.Element,style:{width:p.width,height:p.height},initialWidth:p.width,initialHeight:p.height,hidden:p.kind!==At&&!l(p),...g&&{parentId:d+g.id}},C={viewId:t.id,id:p.id,title:p.title,color:p.color,shape:p.shape,style:p.style,depth:p.depth??0,icon:p.icon??"none",tags:p.tags??null,x:p.x,y:p.y},k={viewId:t.id,id:p.id,title:p.title,technology:p.technology??null,description:te.from(p.description),height:p.height,width:p.width,level:p.level,color:p.color,shape:p.shape,style:p.style,icon:p.icon??null,tags:p.tags,x:p.x,y:p.y,isMultiple:p.style?.multiple??!1};if(p.kind===At){i.push({...b,type:"view-group",data:{isViewGroup:!0,...C},dragHandle:".likec4-compound-title"});continue}const v=p.modelRef??null,M=p.deploymentRef??null;if(!v&&!M)throw console.error("Invalid node",p),new Error("Element should have either modelRef or deploymentRef");const w={navigateTo:p.navigateTo??null};switch(!0){case(f&&!!M):{i.push({...b,type:"compound-deployment",data:{...C,...w,deploymentFqn:M,modelFqn:v},dragHandle:".likec4-compound-title"});break}case f:{T(!!v,"ModelRef expected"),i.push({...b,type:"compound-element",data:{...C,...w,modelFqn:v},dragHandle:".likec4-compound-title"});break}case!!M:{i.push({...b,type:"deployment",data:{...k,...w,deploymentFqn:M,modelFqn:v}});break}default:T(!!v,"ModelRef expected"),i.push({...b,type:"element",data:{...k,...w,modelFqn:v}})}}for(const p of t.edges){const g=p.source,f=p.target,y=d+p.id;if(!de(p.points,2)){console.error("edge should have at least 2 points",p);continue}a.push({id:y,type:"relationship",source:d+g,target:d+f,zIndex:We.Edge,selectable:n,hidden:!l(p),deletable:!1,data:{id:p.id,label:p.label,technology:p.technology,notes:te.from(p.notes),navigateTo:p.navigateTo,controlPoints:p.controlPoints??null,labelBBox:p.labelBBox??null,labelXY:p.labelBBox?{x:p.labelBBox.x,y:p.labelBBox.y}:null,points:p.points,color:p.color??"gray",line:p.line??"dashed",dir:p.dir??"forward",head:p.head??"normal",tail:p.tail??"none",astPath:p.astPath},interactionWidth:20})}return{bounds:t.bounds,xynodes:i,xyedges:a}}const Rd={parallel:1,actor:10},mo={default:"gray",active:"amber"};function tb(e){const{actors:t,steps:n,compounds:i,parallelAreas:a,bounds:s}=e.sequenceLayout,r=[],l=[],d=c=>F(e.nodes.find(u=>u.id===c));for(const c of i)r.push(nb(c,d(c.origin),e));for(const c of a)r.push(ob(c,e));for(const c of t)r.push(ib(c,d(c.id),s,e));for(const c of n){const u=e.edges.find(p=>p.id===c.id);if(!u)throw new Error(`Edge ${c.id} not found`);l.push(ab(c,u))}return{bounds:s,xynodes:r,xyedges:l}}function nb({id:e,x:t,y:n,width:i,height:a,depth:s},r,l){return{id:e,type:"view-group",data:{id:r.id,title:r.title,color:r.color??"gray",shape:r.shape,style:r.style,tags:r.tags,x:t,y:n,viewId:l.id,depth:s,isViewGroup:!0},position:{x:t,y:n},draggable:!1,selectable:!1,focusable:!1,style:{pointerEvents:"none"},width:i,initialWidth:i,height:a,initialHeight:a}}function ob({parallelPrefix:e,x:t,y:n,width:i,height:a},s){return{id:`seq-parallel-${e}`,type:"seq-parallel",data:{id:`seq-parallel-${e}`,title:"PARALLEL",technology:null,color:mo.default,shape:"rectangle",style:{},tags:[],x:t,y:n,level:0,icon:null,width:i,height:a,description:te.EMPTY,viewId:s.id,parallelPrefix:e},zIndex:Rd.parallel,position:{x:t,y:n},draggable:!1,deletable:!1,selectable:!1,focusable:!1,style:{pointerEvents:"none"},width:i,initialWidth:i,height:a,initialHeight:a}}function ib({id:e,x:t,y:n,width:i,height:a,ports:s},r,l,d){return{id:e,type:"seq-actor",data:{id:r.id,x:t,y:n,level:0,icon:r.icon??null,isMultiple:r.style.multiple??!1,title:r.title,width:i,height:a,color:r.color,navigateTo:r.navigateTo??null,shape:r.shape,style:r.style,tags:r.tags,modelFqn:r.modelRef??null,technology:r.technology??null,description:te.from(r.description),viewHeight:l.height,viewId:d.id,ports:s},deletable:!1,selectable:!0,zIndex:Rd.actor,position:{x:t,y:n},width:i,initialWidth:i,height:a,initialHeight:a}}function ab({id:e,labelBBox:t,sourceHandle:n,targetHandle:i},a){return{id:e,type:"seq-step",data:{id:e,label:a.label,technology:a.technology,notes:te.from(a.notes),navigateTo:a.navigateTo,controlPoints:null,labelBBox:{x:0,y:0,width:t?.width??a.labelBBox?.width??32,height:t?.height??a.labelBBox?.height??32},labelXY:null,points:a.points,color:a.color,line:a.line,dir:"forward",head:a.head??"normal",tail:a.tail??"none",astPath:a.astPath},selectable:!0,focusable:!1,zIndex:20,interactionWidth:40,source:a.source,sourceHandle:n,target:a.target,targetHandle:i}}function sb({dynamicViewVariant:e,...t}){const n=t.view,i=n._type==="dynamic",{bounds:a,xynodes:s,xyedges:r}=i&&e==="sequence"?tb(n):eb(t);return i&&n.variant!==e?{view:{...n,bounds:a,variant:e},xynodes:s,xyedges:r}:{view:a===n.bounds?n:{...n,bounds:a},xynodes:s,xyedges:r}}function nr(e,t){return t.map(n=>{const i=e.find(a=>a.id===n.id);return i&&I(i.type,n.type)?I(i.hidden??!1,n.hidden??!1)&&I(i.source,n.source)&&I(i.sourceHandle??null,n.sourceHandle??null)&&I(i.target,n.target)&&I(i.targetHandle??null,n.targetHandle??null)&&I(i.zIndex??0,n.zIndex??0)&&I(i.data,n.data)?i:{..._t(i,["hidden","zIndex"]),...n,data:n.data}:n})}function Dd(e,t){return Ir(t)?nr(e,t):(t=e,n=>nr(n,t))}function or(e,t){return t.map(n=>{const i=e.find(a=>a.id===n.id);if(i&&I(i.type,n.type)){const{width:a,height:s}=it(i);return I(a,n.initialWidth)&&I(s,n.initialHeight)&&I(i.parentId??null,n.parentId??null)&&I(i.hidden??!1,n.hidden??!1)&&I(i.zIndex??0,n.zIndex??0)&&I(i.position,n.position)&&I(i.data,n.data)?i:{..._t(i,["measured","parentId","hidden","zIndex"]),...n,width:n.initialWidth,height:n.initialHeight,data:n.data}}return n})}function Ai(e,t){return Ir(t)?or(e,t):(t=e,n=>or(n,t))}const zi={top:"40px",bottom:"16px",left:"16px",right:"16px"};function Bd(e){const t=[],n=[],i=new Map,a=Zi.from(e.nodes.reduce((l,d)=>(i.set(d.id,d),d.parent||l.push({node:d,parent:null}),l),[])),s=l=>F(i.get(l),`Node not found: ${l}`);let r;for(;r=a.dequeue();){const{node:l,parent:d}=r,c=de(l.children,1)||l.kind==At;if(c)for(const b of l.children)a.enqueue({node:s(b),parent:l});const u={x:l.x,y:l.y};d&&(u.x-=d.x,u.y-=d.y);const p=l.id,g={id:p,draggable:!1,selectable:!0,focusable:!0,position:u,zIndex:c?We.Compound:We.Element,style:{width:l.width,height:l.height},initialWidth:l.width,initialHeight:l.height,...d&&{parentId:d.id}},f=l.modelRef??null,y={navigateTo:l.navigateTo??null};switch(!0){case l.kind===po.Empty:{t.push({...g,type:"empty",data:{column:l.column}});break}case(c&&!!f):{t.push({...g,type:"compound",data:{id:p,column:l.column,title:l.title,color:l.color,shape:l.shape,style:l.style,depth:l.depth??0,icon:l.icon??"none",ports:l.ports,existsInCurrentView:l.existsInCurrentView,fqn:f,...y}});break}default:T(f,"Element should have either modelRef or deploymentRef"),t.push({...g,type:"element",data:{id:p,column:l.column,fqn:f,title:l.title,technology:l.technology,description:l.description,height:l.height,width:l.width,color:l.color,shape:l.shape,icon:l.icon??"none",ports:l.ports,style:l.style,existsInCurrentView:l.existsInCurrentView,tags:l.tags,...y}})}}for(const l of e.edges){const d=l.source,c=l.target,u=l.id;if(!de(l.points,2)){console.error("edge should have at least 2 points",l);continue}if(!de(l.relations,1)){console.error("edge should have at least 1 relation",l);continue}n.push({id:u,type:"relationship",source:d,target:c,sourceHandle:l.sourceHandle,targetHandle:l.targetHandle,data:{sourceFqn:l.sourceFqn,targetFqn:l.targetFqn,relations:l.relations,color:l.color??"gray",label:l.label,navigateTo:l.navigateTo??null,line:l.line??"dashed",existsInCurrentView:l.existsInCurrentView},interactionWidth:20})}return{xynodes:t,xyedges:n}}const ir=e=>e.find(t=>t.data.column==="subjects"&&Ki(t.parentId)),rb=h.fromPromise(async({input:e,self:t,signal:n})=>{const{subjectId:i,navigateFromNode:a,xyflow:s,xystore:r,update:l}=e;let{nodes:d,width:c,height:u}=r.getState();const p=Bd(l),g=()=>{const{nodes:P,edges:V}=r.getState();return{xynodes:Ai(P,p.xynodes),xyedges:Dd(V,p.xyedges)}},f=F(t._parent);let y=s.getZoom();const b=Math.max(y,1),C=hn(l.bounds,c,u,qe,b,zi),k=p.xynodes.find(P=>P.type!=="empty"&&P.data.column==="subjects"&&P.data.fqn===i)??ir(p.xynodes),v=ir(d),M=a?d.find(P=>P.id===a):d.find(P=>P.type!=="empty"&&P.data.column!=="subjects"&&P.data.fqn===i);if(!k||!M||k.type==="empty"||!v||k.data.fqn===v.data.fqn)return await s.setViewport(C),g();const w={x:k.position.x+(k.initialWidth??0)/2,y:k.position.y+(k.initialHeight??0)/2},j=s.getInternalNode(v.id),_=Lh(j),L=new Set;return d.forEach(P=>{if(P.id!==M.id){if(P.data.column==="subjects"){L.add(P.id);return}P.parentId&&(P.parentId===M.id||L.has(P.parentId))&&L.add(P.id)}}),d=Ai(d,d.flatMap(P=>L.has(P.id)?[]:P.id!==M.id?{...P,data:{...P.data,dimmed:P.data.column==="subjects"?"immediate":!0}}:{..._t(P,["parentId"]),position:{x:_.x-P.initialWidth/2,y:_.y-P.initialHeight/2},zIndex:We.Max,hidden:!1,data:{...P.data,dimmed:!1}})),f.send({type:"update.xydata",xynodes:d,xyedges:[]}),await lh(120),p.xynodes=p.xynodes.map(q.setDimmed(!1)),n.aborted||(await s.setCenter(_.x,_.y,{zoom:y,duration:300}),await s.setCenter(w.x,w.y,{zoom:y})),g()}),lb=h.setup({types:{context:{},tags:"",children:{},input:{},events:{}},actors:{layouter:rb},guards:{hasViewId:({context:e})=>e.viewId!==null,isReady:({context:e})=>e.xyflow!==null&&e.xystore!==null&&e.layouted!==null,anotherSubject:({context:e,event:t})=>t.type==="update.view"?e.layouted?.subject!==t.layouted.subject:!1},actions:{"xyflow.init":h.assign(({event:e})=>(h.assertEvent(e,"xyflow.init"),{xyflow:e.instance,xystore:e.store})),"update.view":h.assign(({event:e})=>(h.assertEvent(e,"update.view"),{layouted:e.layouted,...Bd(e.layouted)})),"xyflow:updateNodeInternals":({context:e})=>{T(e.xystore,"xystore is not initialized");const{domNode:t,updateNodeInternals:n}=e.xystore.getState(),i=new Set(e.xyedges.flatMap(s=>[s.source,s.target]));if(i.size===0||!t)return;const a=new Map;for(const s of i){const r=t.querySelector(`.react-flow__node[data-id="${s}"]`);r&&a.set(s,{id:s,nodeElement:r,force:!0})}n(a,{triggerFitView:!1})},"xyflow:fitDiagram":({context:e},t)=>{let{duration:n,bounds:i}=t??{};n??=450;const{xyflow:a,xystore:s}=e;T(a,"xyflow is not initialized"),T(s,"xystore is not initialized"),i??=e.layouted?.bounds;const r=Math.max(a.getZoom(),1);if(i){const{width:l,height:d}=s.getState(),c=hn(i,l,d,qe,r,zi);a.setViewport(c,n>0?{duration:n}:void 0).catch(console.error)}else a.fitView({minZoom:qe,maxZoom:r,padding:zi,...n>0&&{duration:n}}).catch(console.error)},"xyflow.applyNodeChanges":h.assign(({context:e,event:t})=>(h.assertEvent(t,"xyflow.applyNodeChanges"),{xynodes:Yi(t.changes,e.xynodes)})),"xyflow.applyEdgeChanges":h.assign(({context:e,event:t})=>(h.assertEvent(t,"xyflow.applyEdgeChanges"),{xyedges:Xi(t.changes,e.xyedges)}))}}).createMachine({id:"relationships-browser",context:({input:e})=>({subject:e.subject,viewId:e.viewId,scope:e.viewId?e.scope:"global",closeable:e.closeable??!0,enableSelectSubject:e.enableSelectSubject??!0,enableChangeScope:e.enableChangeScope??!0,xyflow:null,xystore:null,layouted:null,navigateFromNode:null,xynodes:[],xyedges:[]}),initial:"initializing",on:{"xyflow.applyNodeChanges":{actions:"xyflow.applyNodeChanges"},"xyflow.applyEdgeChanges":{actions:"xyflow.applyEdgeChanges"}},states:{initializing:{on:{"xyflow.init":{actions:"xyflow.init",target:"isReady"},"update.view":{actions:"update.view",target:"isReady"},stop:"closed",close:"closed"}},isReady:{always:[{guard:"isReady",actions:[{type:"xyflow:fitDiagram",params:{duration:0}},h.raise({type:"xyflow.updateNodeInternals"},{delay:150})],target:"active"},{target:"initializing"}]},active:{initial:"idle",tags:["active"],on:{"xyflow.nodeClick":{actions:h.enqueueActions(({event:e,enqueue:t})=>{if("fqn"in e.node.data){const n=e.node.data.fqn;t.raise({type:"navigate.to",subject:n,fromNode:e.node.id})}})},"xyflow.edgeClick":{guard:"hasViewId",actions:h.enqueueActions(({event:e,context:t,system:n,enqueue:i})=>{(e.edge.selected||e.edge.data.relations.length>1)&&i.sendTo(Je(n).overlaysActorRef,{type:"open.relationshipDetails",viewId:t.viewId,source:e.edge.data.sourceFqn,target:e.edge.data.targetFqn})})},"navigate.to":{actions:[h.assign({subject:({event:e})=>e.subject,viewId:({event:e,context:t})=>e.viewId??t.viewId??null,navigateFromNode:({event:e})=>e.fromNode??null})]},"xyflow.paneDblClick":{actions:"xyflow:fitDiagram"},"update.view":{actions:"update.view",target:".layouting"},"change.scope":{actions:h.assign({scope:({event:e})=>e.scope})},"xyflow.updateNodeInternals":{actions:"xyflow:updateNodeInternals"},fitDiagram:{actions:{type:"xyflow:fitDiagram",params:Se("event")}},"xyflow.resized":{actions:[h.cancel("fitDiagram"),h.raise({type:"fitDiagram"},{id:"fitDiagram",delay:300})]},"xyflow.init":{actions:"xyflow.init"},"xyflow.unmount":{target:"initializing"},close:"closed"},states:{idle:{on:{"xyflow.edgeMouseEnter":{actions:[h.assign({xyedges:({context:e,event:t})=>{const n=e.xyedges.some(i=>i.data.dimmed!==!1||i.selected);return e.xyedges.map(i=>i.id===t.edge.id?q.setData(i,{hovered:!0,dimmed:!1}):n&&!i.selected?q.setDimmed(i,"immediate"):i)}}),h.cancel("undim.edges"),h.cancel("dim.nonhovered.edges"),h.raise({type:"dim.nonhovered.edges"},{id:"dim.nonhovered.edges",delay:200})]},"xyflow.edgeMouseLeave":{actions:[h.assign({xyedges:({context:e,event:t})=>e.xyedges.map(n=>n.id===t.edge.id?q.setHovered(n,!1):n)}),h.cancel("dim.nonhovered.edges"),h.raise({type:"undim.edges"},{id:"undim.edges",delay:400})]},"dim.nonhovered.edges":{actions:h.assign({xyedges:({context:e})=>e.xyedges.map(t=>t.data.hovered?t:q.setDimmed(t,t.data.dimmed==="immediate"?"immediate":!0))})},"undim.edges":{actions:h.assign({xyedges:({context:e})=>e.xyedges.map(q.setDimmed(!1))})},"xyflow.selectionChange":{actions:h.enqueueActions(({event:e,context:t,enqueue:n})=>{e.edges.length===0&&t.xyedges.some(i=>i.data.dimmed)&&!t.xyedges.some(i=>i.data.hovered)&&n.raise({type:"undim.edges"})})}}},layouting:{invoke:{id:"layouter",src:"layouter",input:({context:e})=>({subjectId:e.subject,navigateFromNode:e.navigateFromNode,xyflow:F(e.xyflow),xystore:F(e.xystore),update:F(e.layouted)}),onDone:{target:"idle",actions:h.enqueueActions(({enqueue:e,event:t})=>{e.assign({xynodes:t.output.xynodes,xyedges:t.output.xyedges,navigateFromNode:null}),e.raise({type:"fitDiagram",duration:200},{id:"fitDiagram",delay:50});for(let n=0;n<6;n++)e.raise({type:"xyflow.updateNodeInternals"},{delay:100+n*100})})}},on:{"update.xydata":{actions:h.assign({xynodes:({event:e})=>e.xynodes,xyedges:({event:e})=>e.xyedges})},"xyflow.applyEdgeChanges":{},"xyflow.applyNodeChanges":{}}}}},closed:{id:"closed",type:"final"}},exit:h.assign({xyflow:null,layouted:null,xystore:null,xyedges:[],xynodes:[]})}),Td=lb,db=h.setup({types:{context:{},input:{},events:{},children:{}},actors:{relationshipsBrowserLogic:Td}}).createMachine({id:"element-details",context:({input:e})=>({...e,initiatedFrom:{node:e.initiatedFrom?.node??null,clientRect:e.initiatedFrom?.clientRect??null}}),initial:"active",states:{active:{entry:h.spawnChild("relationshipsBrowserLogic",{id:({self:e})=>`${e.id}-relationships`,input:({context:e})=>({subject:e.subject,viewId:e.currentView.id,scope:"view",enableSelectSubject:!1,enableChangeScope:!0,closeable:!1})}),exit:[h.sendTo(({self:e})=>`${e.id}-relationships`,{type:"close"}),h.stopChild(({self:e})=>`${e.id}-relationships`)],on:{"change.subject":{actions:h.assign({subject:({event:e})=>e.subject})},close:"closed"}},closed:{id:"closed",type:"final"}}}),cb=db;function ub(e){const t=[],n=[],i=new Map,a=Zi.from(e.nodes.reduce((l,d)=>(i.set(d.id,d),d.parent||l.push({node:d,parent:null}),l),[])),s=l=>F(i.get(l),`Node not found: ${l}`);let r;for(;r=a.dequeue();){const{node:l,parent:d}=r,c=de(l.children,1);if(c)for(const b of l.children)a.enqueue({node:s(b),parent:l});const u={x:l.x,y:l.y};d&&(u.x-=d.x,u.y-=d.y);const p=l.id,g={id:p,draggable:!1,selectable:!0,focusable:!0,deletable:!1,position:u,zIndex:c?We.Compound:We.Element,style:{width:l.width,height:l.height},initialWidth:l.width,initialHeight:l.height,...d&&{parentId:d.id}},f=l.modelRef,y={navigateTo:l.navigateTo??null};switch(!0){case c:{t.push({...g,type:"compound",data:{id:p,column:l.column,title:l.title,color:l.color,style:l.style,depth:l.depth??0,icon:l.icon??"none",ports:l.ports,fqn:f,...y}});break}default:t.push({...g,type:"element",data:{id:p,column:l.column,fqn:f,title:l.title,technology:l.technology,description:te.from(l.description),height:l.height,width:l.width,color:l.color,shape:l.shape,icon:l.icon??"none",ports:l.ports,style:l.style,tags:l.tags,...y}})}}for(const{source:l,target:d,relationId:c,label:u,technology:p,description:g,navigateTo:f=null,color:y="gray",line:b="dashed",...C}of e.edges){const k=C.id;n.push({id:k,type:"relationship",source:l,target:d,sourceHandle:C.sourceHandle,targetHandle:C.targetHandle,deletable:!1,data:{relationId:c,label:u,color:y,navigateTo:f,line:b,description:te.from(g),...p&&{technology:p}}})}return{xynodes:t,xyedges:n,bounds:e.bounds}}function ar(e){return"edgeId"in e?(T(nt(e.edgeId),"edgeId is required"),{edgeId:e.edgeId}):{source:e.source,target:e.target}}const pb=h.setup({types:{context:{},input:{},events:{}},actions:{"xyflow:fitDiagram":({context:e},t)=>{let{duration:n,bounds:i}=t??{};n??=450;const{xyflow:a,xystore:s}=e;T(a,"xyflow is not initialized"),T(s,"xystore is not initialized"),i??=e.bounds;const r=Math.max(a.getZoom(),1);if(i){const{width:l,height:d}=s.getState(),c=hn(i,l,d,qe,r,.1);a.setViewport(c,n>0?{duration:n}:void 0).catch(console.error)}else a.fitView({minZoom:qe,maxZoom:r,padding:.1,...n>0&&{duration:n}}).catch(console.error)},"xyflow:updateNodeInternals":({context:e})=>{T(e.xystore,"xystore is not initialized");const{domNode:t,updateNodeInternals:n}=e.xystore.getState(),i=new Set(e.xyedges.flatMap(s=>[s.source,s.target]));if(i.size===0||!t)return;const a=new Map;for(const s of i){const r=t.querySelector(`.react-flow__node[data-id="${s}"]`);r&&a.set(s,{id:s,nodeElement:r,force:!0})}n(a,{triggerFitView:!1})},updateXYFlow:h.assign(({context:e,event:t})=>{h.assertEvent(t,"xyflow.init");let n=e.initialized;return n.xyflow||(n={...n,xyflow:!0}),{initialized:n,xyflow:t.instance,xystore:t.store}}),updateLayoutData:h.assign(({context:e,event:t})=>{h.assertEvent(t,"update.layoutData");const{xynodes:n,xyedges:i,bounds:a}=ub(t.data);let s=e.initialized;return s.xydata||(s={...s,xydata:!0}),{initialized:s,xynodes:Ai(e.xynodes,n),xyedges:Dd(e.xyedges,i),bounds:le(e.bounds,a)?e.bounds:a}})},guards:{isReady:({context:e})=>e.initialized.xydata&&e.initialized.xyflow,"enable: navigate.to":()=>!0}}).createMachine({initial:"initializing",context:({input:e})=>({subject:ar(e),viewId:e.viewId,bounds:{x:0,y:0,width:200,height:200},initialized:{xydata:!1,xyflow:!1},xyflow:null,xystore:null,xynodes:[],xyedges:[]}),states:{initializing:{on:{"xyflow.init":{actions:"updateXYFlow",target:"isReady"},"update.layoutData":{actions:"updateLayoutData",target:"isReady"},close:{target:"closed"}}},isReady:{always:[{guard:"isReady",actions:[{type:"xyflow:fitDiagram",params:{duration:0}},h.raise({type:"xyflow.updateNodeInternals"},{delay:50})],target:"ready"},{target:"initializing"}]},ready:{on:{"xyflow.edgeMouseEnter":{actions:[h.assign({xyedges:({context:e,event:t})=>{const n=e.xyedges.some(i=>i.data.dimmed===!0||i.data.dimmed==="immediate");return e.xyedges.map(i=>i.id===t.edge.id?q.setData(i,{hovered:!0,dimmed:!1}):n&&!i.selected?q.setDimmed(i,"immediate"):i)}}),h.cancel("undim.edges"),h.cancel("dim.nonhovered.edges"),h.raise({type:"dim.nonhovered.edges"},{id:"dim.nonhovered.edges",delay:100})]},"xyflow.edgeMouseLeave":{actions:[h.assign({xyedges:({context:e,event:t})=>e.xyedges.map(n=>n.id===t.edge.id?q.setHovered(n,!1):n)}),h.cancel("dim.nonhovered.edges"),h.raise({type:"undim.edges"},{id:"undim.edges",delay:400})]},"dim.nonhovered.edges":{actions:h.assign({xyedges:({context:e})=>e.xyedges.map(t=>q.setDimmed(t,t.data.hovered!==!0))})},"undim.edges":{actions:h.assign({xyedges:({context:e})=>e.xyedges.some(t=>t.selected===!0)?e.xyedges.map(t=>q.setDimmed(t,t.selected!==!0?t.data.dimmed||"immediate":!1)):e.xyedges.map(q.setDimmed(!1))})},"xyflow.selectionChange":{actions:h.enqueueActions(({event:e,context:t,enqueue:n})=>{e.edges.length===0&&t.xyedges.some(i=>i.data.dimmed)&&!t.xyedges.some(i=>i.data.hovered)&&n.raise({type:"undim.edges"})})},"update.layoutData":{actions:["updateLayoutData",h.cancel("fitDiagram"),h.raise({type:"fitDiagram",duration:0},{id:"fitDiagram",delay:50}),h.raise({type:"xyflow.updateNodeInternals"},{delay:75})]},"xyflow.init":{actions:"updateXYFlow"},"xyflow.applyNodeChanges":{actions:h.assign({xynodes:({context:e,event:t})=>Yi(t.changes,e.xynodes)})},"xyflow.applyEdgeChanges":{actions:h.assign({xyedges:({context:e,event:t})=>Xi(t.changes,e.xyedges)})},"xyflow.paneDblClick":{actions:"xyflow:fitDiagram"},"navigate.to":{actions:h.assign({subject:({event:e})=>ar(e.params),viewId:({context:e,event:t})=>t.params.viewId??e.viewId})},close:{target:"closed"}},exit:h.assign({xyedges:[],xynodes:[],initialized:{xydata:!1,xyflow:!1},xyflow:null,xystore:null})},closed:{type:"final"}},on:{fitDiagram:{actions:{type:"xyflow:fitDiagram",params:Se("event")}},"xyflow.resized":{actions:[h.cancel("fitDiagram"),h.raise({type:"fitDiagram"},{id:"fitDiagram",delay:200})]},"xyflow.updateNodeInternals":{actions:"xyflow:updateNodeInternals"}}}),gb=pb,hb=h.fromCallback(({sendBack:e})=>{const t=xi([["Escape",n=>{n.stopPropagation(),e({type:"close"})},{preventDefault:!0}]]);return document.body.addEventListener("keydown",t,{capture:!0}),()=>{document.body.removeEventListener("keydown",t,{capture:!0})}}),mb=h.setup({types:{context:{},events:{},emitted:{},children:{}},actors:{relationshipDetails:gb,elementDetails:cb,relationshipsBrowser:Td,hotkey:hb},actions:{closeLastOverlay:h.enqueueActions(({context:e,enqueue:t})=>{if(e.overlays.length===0)return;const n=wt(e.overlays)?.id;n&&(t.sendTo(n,{type:"close"}),t.stopChild(n),t.assign({overlays:e.overlays.filter(i=>i.id!==n)}))}),closeSpecificOverlay:h.enqueueActions(({context:e,enqueue:t},n)=>{const i=e.overlays.find(a=>a.id===n.actorId)?.id;i&&(t.sendTo(i,{type:"close"}),t.stopChild(i),t.assign({overlays:e.overlays.filter(a=>a.id!==i)}))}),closeAllOverlays:h.enqueueActions(({context:e,enqueue:t})=>{for(const{id:n}of uc(e.overlays))t.sendTo(n,{type:"close"}),t.stopChild(n);t.assign({overlays:[]})}),openElementDetails:h.enqueueActions(({context:e,enqueue:t,event:n})=>{if(h.assertEvent(n,"open.elementDetails"),e.overlays.some(a=>a.type==="elementDetails"&&a.subject===n.subject))return;const i=`elementDetails-${e.seq}`;t.spawnChild("elementDetails",{id:i,input:n}),t.assign({seq:e.seq+1,overlays:[...e.overlays,{type:"elementDetails",id:i,subject:n.subject}]})}),openRelationshipDetails:h.enqueueActions(({context:e,enqueue:t,event:n})=>{h.assertEvent(n,"open.relationshipDetails");const i=wt(e.overlays);if(i?.type==="relationshipDetails"){t.sendTo(i.id,{...n,type:"navigate.to"});return}const a=`relationshipDetails-${e.seq}`;t.spawnChild("relationshipDetails",{id:a,input:n}),t.assign({seq:e.seq+1,overlays:[...e.overlays,{type:"relationshipDetails",id:a}]})}),openRelationshipsBrowser:h.enqueueActions(({context:e,enqueue:t,event:n})=>{h.assertEvent(n,"open.relationshipsBrowser");const i=wt(e.overlays);if(i?.type==="relationshipsBrowser"){t.sendTo(i.id,{type:"navigate.to",subject:n.subject,viewId:n.viewId});return}const a=`relationshipsBrowser-${e.seq}`;t.spawnChild("relationshipsBrowser",{id:a,input:n}),t.assign({seq:e.seq+1,overlays:[...e.overlays,{type:"relationshipsBrowser",id:a,subject:n.subject}]})}),listenToEsc:h.spawnChild("hotkey",{id:"hotkey"}),stopListeningToEsc:h.stopChild("hotkey")},guards:{"has overlays?":({context:e})=>e.overlays.length>0,"close specific overlay?":({context:e,event:t})=>(h.assertEvent(t,"close"),nt(t.actorId)&&e.overlays.some(n=>n.id===t.actorId)),"last: is relationshipDetails?":({context:e})=>wt(e.overlays)?.type==="relationshipDetails","last: is relationshipsBrowser?":({context:e})=>wt(e.overlays)?.type==="relationshipsBrowser"}}).createMachine({id:"overlays",context:()=>({seq:1,overlays:[]}),initial:"idle",on:{"open.elementDetails":{actions:"openElementDetails",target:".active",reenter:!1},"open.relationshipDetails":{actions:"openRelationshipDetails",target:".active",reenter:!1},"open.relationshipsBrowser":{actions:"openRelationshipsBrowser",target:".active",reenter:!1}},states:{idle:{},active:{entry:"listenToEsc",exit:"stopListeningToEsc",on:{close:[{guard:"close specific overlay?",actions:{type:"closeSpecificOverlay",params:({event:e})=>({actorId:e.actorId})},target:"closing"},{actions:"closeLastOverlay",target:"closing"}],"close.all":{actions:["closeAllOverlays","stopListeningToEsc"],target:"idle"}}},closing:{always:[{guard:"has overlays?",target:"active"},{actions:"stopListeningToEsc",target:"idle"}]}},exit:["stopListeningToEsc","closeAllOverlays"]}),fb=mb,xb=h.setup({types:{context:{},events:{}},actions:{"change searchValue":h.assign({searchValue:({event:e,context:t})=>(h.assertEvent(e,["change.search","open"]),e.search??t.searchValue)}),"reset pickViewFor":h.assign({pickViewFor:()=>null})}}).createMachine({id:"search",context:{openedWithSearch:null,searchValue:"",pickViewFor:null},initial:"inactive",on:{close:{target:".inactive",actions:"reset pickViewFor"}},states:{inactive:{on:{open:{target:"opened",actions:[h.assign({openedWithSearch:({event:e})=>e.search??null,searchValue:({event:e,context:t})=>e.search??t.searchValue})]}}},opened:{on:{open:{actions:"change searchValue"},"change.search":{actions:"change searchValue"},"pickview.open":{target:"pickView",actions:h.assign({pickViewFor:({event:e})=>e.elementFqn})}}},pickView:{on:{"pickview.close":{target:"opened",actions:"reset pickViewFor"}}}}}),yb=xb;class Ld{}class Tt extends Ld{constructor(t,n,i){super(),this.getEdgePosition=t,this.computePosition=n,this.propertyToEdit=i}alignTo;computeLayout(t){this.alignTo=this.getEdgePosition(t)}applyPosition(t){return{[this.propertyToEdit]:this.computePosition(this.alignTo,t)}}}class bb extends Ld{layout=new Map;axisPreset;get primaryAxisCoord(){return this.axisPreset.primaryAxisCoord}get secondaryAxisCoord(){return this.axisPreset.secondaryAxisCoord}get primaryAxisDimension(){return this.axisPreset.primaryAxisDimension}get secondaryAxisDimension(){return this.axisPreset.secondaryAxisDimension}constructor(t){super(),this.axisPreset=t==="Column"?{primaryAxisDimension:"width",secondaryAxisDimension:"height",primaryAxisCoord:"x",secondaryAxisCoord:"y"}:{primaryAxisDimension:"height",secondaryAxisDimension:"width",primaryAxisCoord:"y",secondaryAxisCoord:"x"}}applyPosition(t){return this.layout?.get(t.id)??{}}computeLayout(t){const n=re(t,ao(s=>s[this.primaryAxisCoord])),i=this.getLayoutRect(n),a=this.getLayers(n);this.layout=this.buildLayout(a,i,n)}getLayoutRect(t){const n=Math.min(...t.map(r=>r.x)),i=Math.min(...t.map(r=>r.y)),a=Math.max(...t.map(r=>r.x+r.width)),s=Math.max(...t.map(r=>r.y+r.height));return{x:n,y:i,width:a-n,height:s-i}}getLayers(t){const n=[];let i=0,a=null;for(let s of t)if(a&&s[this.primaryAxisCoord]<i)a.nodes.push(s),a.primaryAxisSize=Math.max(a.primaryAxisSize,s[this.primaryAxisDimension]),a.occupiedSpace+=s[this.secondaryAxisDimension],i=Math.max(s[this.primaryAxisCoord]+s[this.primaryAxisDimension],i);else{a={primaryAxisSize:s[this.primaryAxisDimension],nodes:[s],occupiedSpace:s[this.secondaryAxisDimension],layout:null},n.push(a),i=s[this.primaryAxisCoord]+s[this.primaryAxisDimension];continue}return n.forEach(s=>s.nodes.sort((r,l)=>r[this.secondaryAxisCoord]-l[this.secondaryAxisCoord])),n}buildLayout(t,n,i){const a=new Map(i.map(y=>[y.id,y])),s=[],r=t.reduce((y,b)=>y+b.primaryAxisSize,0),l=t.length>1?(n[this.primaryAxisDimension]-r)/(t.length-1):0,d=t.reduce((y,b,C)=>t[y].occupiedSpace<b.occupiedSpace?C:y,0),c=t[d],u=t.slice(0,d).reduce((y,b)=>y+b.primaryAxisSize+l,n[this.primaryAxisCoord]),p=this.buildLayerLayout(c,n,u,a,null);c.layout=p,s.push(...p.nodePositions);let g=u+c.primaryAxisSize+l,f=c;for(let y=d+1;y<t.length;y++){const b=t[y];b.layout=this.buildLayerLayout(b,n,g,a,f),s.push(...b.layout.nodePositions),f=b.layout.refLayer??b,g+=b.primaryAxisSize+l}g=u,f=c;for(let y=d-1;y>=0;y--){const b=t[y];g-=b.primaryAxisSize+l,b.layout=this.buildLayerLayout(b,n,g,a,f),s.push(...b.layout.nodePositions),f=b.layout.refLayer??b}return new Map(s)}buildLayerLayout(t,n,i,a,s){let r=this.scoreLayout(this.spaceAround(t,n,i),a);if(t.nodes.length!=1){const l=this.scoreLayout(this.spaceBetween(t,n,i),a);r=l[0]<r[0]?l:r}if(s&&s.nodes.length-1>=t.nodes.length){const l=this.scoreLayout(this.placeInGaps(t,i,s),a);r=l[0]<r[0]?l:r}if(s&&s.nodes.length>=t.nodes.length){const l=this.scoreLayout(this.placeInCells(t,i,s),a);r=l[0]<r[0]?l:r}return r[1]}spaceBetween(t,n,i){const a=(n[this.secondaryAxisDimension]-t.occupiedSpace)/(t.nodes.length-1);let s=n[this.secondaryAxisCoord];const r=new Map;for(let l of t.nodes)r.set(l.id,{[this.secondaryAxisCoord]:s,[this.primaryAxisCoord]:i}),s+=l[this.secondaryAxisDimension]+a;return{nodePositions:r,refLayer:null}}spaceAround(t,n,i){const a=(n[this.secondaryAxisDimension]-t.occupiedSpace)/(t.nodes.length+1);let s=n[this.secondaryAxisCoord]+a;const r=new Map;for(let l of ao(t.nodes,d=>d[this.secondaryAxisCoord]))r.set(l.id,{[this.secondaryAxisCoord]:s,[this.primaryAxisCoord]:i}),s+=l[this.secondaryAxisDimension]+a;return{nodePositions:r,refLayer:null}}placeInGaps(t,n,i){const a=new Map,s=t.nodes,r=this.getGapsPositions(i);let l=0;for(let d=0,c=s[d];d<s.length;d++,c=s[d]){const u=c[this.secondaryAxisCoord]+c[this.secondaryAxisDimension]/2;let p=1/0;for(;l-d<=r.length-s.length;){const g=r[l]-u;if(Math.abs(g)<Math.abs(p))p=g,l++;else break}a.set(c.id,{[this.secondaryAxisCoord]:c[this.secondaryAxisCoord]+p,[this.primaryAxisCoord]:n})}return{nodePositions:a,refLayer:i}}placeInCells(t,n,i){const a=new Map,s=t.nodes,r=this.getNodePositions(i);let l=0;for(let d=0,c=s[d];d<s.length;d++,c=s[d]){const u=c[this.secondaryAxisCoord]+c[this.secondaryAxisDimension]/2;let p=1/0;for(;l-d<=r.length-s.length;){const g=r[l]-u;if(Math.abs(g)<Math.abs(p))p=g,l++;else break}a.set(c.id,{[this.secondaryAxisCoord]:c[this.secondaryAxisCoord]+p,[this.primaryAxisCoord]:n})}return{nodePositions:a,refLayer:i}}scoreLayout(t,n){return[re(Array.from(t.nodePositions),me(([i,a])=>{const s=n.get(i);return T(s,`Could not find original rect for node ${i}`),[Or(s,["x","y"]),a]}),me(([i,a])=>Math.abs(i[this.secondaryAxisCoord]-a[this.secondaryAxisCoord])),Ht((i,a)=>i+a,0)),t]}getGapsPositions(t){const n=[],{layout:i,nodes:a}=t;T(i,"Layout of the layer must be computed before calling getGapsPositions");for(let s=1;s<a.length;s++){const r=a[s-1],l=a[s],d=i.nodePositions.get(r.id),c=i.nodePositions.get(l.id);n.push((c[this.secondaryAxisCoord]+d[this.secondaryAxisCoord]+r[this.secondaryAxisDimension])/2)}return n}getNodePositions(t){const n=[],{layout:i,nodes:a}=t;T(i,"Layout of the layer must be computed before calling getGapsPositions");for(let s=0;s<a.length;s++){const r=a[s],l=i.nodePositions.get(r.id);n.push(l[this.secondaryAxisCoord]+r[this.secondaryAxisDimension]/2)}return n}}function wb(e){switch(e){case"Left":return new Tt(t=>Math.min(...t.map(n=>n.x)),(t,n)=>Math.floor(t),"x");case"Top":return new Tt(t=>Math.min(...t.map(n=>n.y)),(t,n)=>Math.floor(t),"y");case"Right":return new Tt(t=>Math.max(...t.map(n=>n.x+n.width)),(t,n)=>Math.floor(t-n.width),"x");case"Bottom":return new Tt(t=>Math.max(...t.map(n=>n.y+n.height)),(t,n)=>Math.floor(t-n.height),"y");case"Center":return new Tt(t=>Math.min(...t.map(n=>n.x+n.width/2)),(t,n)=>Math.floor(t-n.width/2),"x");case"Middle":return new Tt(t=>Math.min(...t.map(n=>n.y+n.height/2)),(t,n)=>Math.floor(t-n.height/2),"y")}}function sr(e){const{width:t,height:n}=it(e);return{...e.internals.positionAbsolute,id:e.id,width:t,height:n}}function vb(e){switch(e){case"Left":case"Right":case"Top":case"Bottom":case"Center":case"Middle":return wb(e);case"Column":case"Row":return new bb(e);default:Le(e)}}function kb(e){const{lastClickedNode:t}=e.context;return!t||t.id!==e.event.node.id?{id:e.event.node.id,clicks:1,timestamp:Date.now()}:{id:t.id,clicks:t.clicks+1,timestamp:Date.now()}}function rr({context:e,event:t}){h.assertEvent(t,"update.view");const n=t.view,i=e.view.id===n.id,a=e.xynodes,s=t.xynodes.map(l=>{const d=a.find(c=>c.id===l.id);if(d){const{width:c,height:u}=it(d);return I(d.type,l.type)&&I(c,l.initialWidth)&&I(u,l.initialHeight)&&I(d.hidden??!1,l.hidden??!1)&&I(d.position,l.position)&&I(d.data,l.data)&&I(d.parentId??null,l.parentId??null)?d:{..._t(d,["measured","parentId"]),...l,width:l.initialWidth,height:l.initialHeight,data:{...d.data,...l.data}}}return l});let r=t.xyedges;if(i&&!n.hasLayoutDrift){const l=e.xyedges;r=t.xyedges.map(d=>{const c=l.find(u=>u.id===d.id);return c&&c.type===d.type?I(c.hidden??!1,d.hidden??!1)&&I(c.data,d.data)&&I(c.source,d.source)&&I(c.target,d.target)&&I(c.sourceHandle,d.sourceHandle)&&I(c.targetHandle,d.targetHandle)?c:{..._t(c,["sourceHandle","targetHandle"]),...d,data:{...c.data,...d.data}}:d})}if(!i){for(const l of s)l.data={...l.data,dimmed:!1,hovered:!1};for(const l of r)l.data={...l.data,dimmed:!1,hovered:!1,active:!1}}return{xynodes:s,xyedges:r,view:n}}function jb(e){const{xynodes:t,xyedges:n,focusedNode:i}=e.context;if(!i)return{};const a=new Set([i]),s=n.map(r=>r.source===i||r.target===i?(a.add(r.source),a.add(r.target),q.setData(r,{dimmed:!1,active:!0})):q.setData(r,{dimmed:!0,active:!1}));return{xynodes:t.map(r=>q.setDimmed(r,!a.has(r.id))),xyedges:s}}function lr({context:e,event:t}){h.assertEvent(t,"update.view");let{navigationHistory:{currentIndex:n,history:i},lastOnNavigate:a,viewport:s}=e;const r=i[n];if(!r)return{navigationHistory:{currentIndex:0,history:[{viewId:t.view.id,fromNode:null,viewport:{...s}}]}};if(r.viewId!==t.view.id){if(!a){const l=n>0?F(i[n-1]):null;if(l&&l.viewId===t.view.id)return{navigationHistory:{currentIndex:n-1,history:i},lastOnNavigate:{fromView:r.viewId,toView:l.viewId,fromNode:r.fromNode}};const d=n<i.length-1?F(i[n+1]):null;if(d&&d.viewId===t.view.id)return{navigationHistory:{currentIndex:n+1,history:i},lastOnNavigate:{fromView:r.viewId,toView:d.viewId,fromNode:d.fromNode}}}return i=[...i.slice(0,n+1),{viewId:t.view.id,fromNode:a?.fromNode??null,viewport:{...s}}],n=i.length-1,{navigationHistory:{currentIndex:n,history:i}}}return{}}function Cb({context:e}){const{navigationHistory:{currentIndex:t,history:n}}=e;T(t>0,"Cannot navigate back");const i=n[t],a=n[t-1];return{navigationHistory:{currentIndex:t-1,history:n},lastOnNavigate:{fromView:i.viewId,toView:a.viewId,fromNode:i.fromNode}}}function Sb({context:e}){const{navigationHistory:{currentIndex:t,history:n}}=e;T(t<n.length-1,"Cannot navigate forward");const i=n[t],a=n[t+1];return{navigationHistory:{currentIndex:t+1,history:n},lastOnNavigate:{fromView:i.viewId,toView:a.viewId,fromNode:a.fromNode}}}function _b({context:e,event:t}){return h.assertEvent(t,"update.nodeData"),{xynodes:e.xynodes.map(n=>{if(n.id!==t.nodeId)return n;const i=Rr(n.data,t.data);return I(i,n.data)?n:{...n,data:i}})}}function Pb({context:e,event:t}){return h.assertEvent(t,"update.edgeData"),{xyedges:e.xyedges.map(n=>{if(n.id!==t.edgeId)return n;const i=Rr(n.data,t.data);return I(i,n.data)?n:{...n,data:i}})}}function Mb({context:e}){const{xynodes:t}=e;function n(s,r){const l=Ct({x:s.width||0,y:s.height||0});let d=Ct(s.position).add(l.mul(.5)),c=s;do{const u=c.parentId&&r.find(p=>p.id==c.parentId);if(!u)break;c=u,d=d.add(u.position)}while(!0);return d}function i(s){const r=t.find(f=>f.id==s.source),l=t.find(f=>f.id==s.target);if(!r||!l)return[];const d=n(r,t),c=n(l,t);if(!d||!c)return[];if(r===l){const f=new ve(0,r.height||0).mul(-.5).add(d);return[f.add(new ve(-80/2.5,-80)),f.add(new ve(80/2.5,-80))]}const u=c.sub(d),p=a(r,d,u),g=a(l,c,u.mul(-1));return[p.add(g.sub(p).mul(.3))]}function a(s,r,l){const d=(s.width||0)/2/l.x,c=(s.height||0)/2/l.y,u=Math.min(Math.abs(d),Math.abs(c));return Ct(l).mul(u).add(r)}return{xyedges:e.xyedges.map(s=>!s.data.controlPoints||ut(s.data.controlPoints)?s:{...s,data:{...s.data,controlPoints:i(s)}})}}function Eb({context:e}){const{stepId:t,parallelPrefix:n}=F(e.activeWalkthrough,"activeWalkthrough is null"),i=F(e.xyedges.find(a=>a.id===t));return{xyedges:e.xyedges.map(a=>{const s=t===a.id||!!n&&a.id.startsWith(n);return q.setData(a,{active:s,dimmed:t!==a.id})}),xynodes:e.xynodes.map(a=>{const s=i.source!==a.id&&i.target!==a.id;return a.type==="seq-parallel"?q.setData(a,{color:n===a.data.parallelPrefix?mo.active:mo.default,dimmed:s}):q.setDimmed(a,s)})}}const Nb=h.fromCallback(({sendBack:e})=>{const t=xi([["Escape",i=>{i.stopPropagation(),e({type:"key.esc"})},{preventDefault:!0}]]),n=xi([["ArrowLeft",i=>{i.stopPropagation(),e({type:"key.arrow.left"})},{preventDefault:!0}],["ArrowRight",i=>{i.stopPropagation(),e({type:"key.arrow.right"})},{preventDefault:!0}]]);return document.body.addEventListener("keydown",t),document.body.addEventListener("keydown",n,{capture:!0}),()=>{document.body.removeEventListener("keydown",t),document.body.removeEventListener("keydown",n,{capture:!0})}}),pi="likec4:diagram:toggledFeatures",dr={read(){try{let e=sessionStorage.getItem(pi);return e?JSON.parse(e):null}catch(e){return console.error(`Error reading fromStorage ${pi}:`,e),null}},write(e){return sessionStorage.setItem(pi,JSON.stringify(Cc(e,fu))),e}},Ib=h.setup({types:{context:{},input:{},events:{},tags:""},delays:{timeout:2e3},actions:{"trigger:OnChange":(e,t)=>{}},guards:{"same view":({context:e})=>e.parent.getSnapshot().context.view.id===e.viewId}}).createMachine({initial:"idle",context:({input:e})=>({...e}),states:{idle:{tags:"ready",on:{sync:{target:"pending"}}},paused:{tags:"pending",on:{sync:{target:"pending"}}},pending:{tags:"pending",on:{sync:{target:"pending",reenter:!0},cancel:{target:"paused"}},after:{timeout:[{guard:"same view",actions:{type:"trigger:OnChange",params:({context:e})=>({change:Rb(e.parent.getSnapshot().context)})},target:"synced"},{target:"stopped"}]}},synced:{tags:"ready",on:{sync:{target:"pending"}}},stopped:{entry:h.assign({parent:null}),type:"final"}},on:{synced:{target:".synced"},stop:{target:".stopped"}}}),Ad=Ib;function Rb(e){const{view:t,xystore:n,xyflow:i}=e,{nodeLookup:a}=n.getState(),s=new Set;let r;const l=Ht([...a.values()],(c,u)=>{const p=it(u);(!rn(u.internals.positionAbsolute,u.data)||u.initialWidth!==p.width||u.initialHeight!==p.height)&&s.add(u.id);const g=c[u.id]={isCompound:u.type!=="element"&&u.type!=="deployment",x:Math.floor(u.internals.positionAbsolute.x),y:Math.floor(u.internals.positionAbsolute.y),width:Math.ceil(p.width),height:Math.ceil(p.height)};return r=r?La(r,g):g,c},{}),d=Ht(i?.getEdges()??[],(c,{source:u,target:p,data:g})=>{let f=g.controlPoints??[];const y=s.has(u)||s.has(p);if(f.length===0&&y&&(f=ul(g)),g.points.length===0&&f.length===0)return c;const b=c[g.id]={points:g.points};g.labelXY&&g.labelBBox&&(b.labelBBox={...g.labelBBox,...g.labelXY}),g.labelBBox&&(b.labelBBox??=g.labelBBox),de(f,1)&&(b.controlPoints=f);const C=[...g.points.map(M=>M[0]),...f.map(M=>M.x),...b.labelBBox?[b.labelBBox.x,b.labelBBox.x+b.labelBBox.width]:[]],k=[...g.points.map(M=>M[1]),...f.map(M=>M.y),...b.labelBBox?[b.labelBBox.y,b.labelBBox.y+b.labelBBox.height]:[]],v=kc({x:Math.floor(Math.min(...C)),y:Math.floor(Math.min(...k)),x2:Math.ceil(Math.max(...C)),y2:Math.ceil(Math.max(...k))});return r=r?La(r,v):v,c},{});return r??=t.bounds,{op:"save-manual-layout",layout:{hash:t.hash,autoLayout:t.autoLayout,nodes:l,edges:d,...r}}}const Db=h.setup({types:{context:{},input:{},children:{},events:{},emitted:{}},actors:{syncManualLayoutActorLogic:Ad,hotkeyActorLogic:Nb,overlaysActorLogic:fb,searchActorLogic:yb},guards:{isReady:({context:e})=>e.initialized.xydata&&e.initialized.xyflow,"enabled: FitView":({context:e})=>e.features.enableFitView,"enabled: FocusMode":({context:e})=>e.features.enableFocusMode&&(e.view._type!=="dynamic"||e.dynamicViewVariant!=="sequence"),"enabled: Readonly":({context:e})=>e.features.enableReadOnly,"enabled: RelationshipDetails":({context:e})=>e.features.enableRelationshipDetails,"enabled: Search":({context:e})=>e.features.enableSearch,"enabled: ElementDetails":({context:e})=>e.features.enableElementDetails,"enabled: DynamicViewWalkthrough":({context:e})=>e.features.enableDynamicViewWalkthrough,"not readonly":({context:e})=>!e.features.enableReadOnly,"is dynamic view":({context:e})=>e.view._type==="dynamic","is another view":({context:e,event:t})=>{if(h.assertEvent(t,["update.view","navigate.to"]),t.type==="update.view")return e.view.id!==t.view.id;if(t.type==="navigate.to")return e.view.id!==t.viewId;Le(t.type)},"click: node has modelFqn":({event:e})=>(h.assertEvent(e,"xyflow.nodeClick"),"modelFqn"in e.node.data),"click: selected node":({event:e})=>(h.assertEvent(e,"xyflow.nodeClick"),e.node.selected===!0),"click: same node":({context:e,event:t})=>(h.assertEvent(t,"xyflow.nodeClick"),e.lastClickedNode?.id===t.node.id),"click: focused node":({context:e,event:t})=>(h.assertEvent(t,"xyflow.nodeClick"),e.focusedNode===t.node.id),"click: node has connections":({context:e,event:t})=>(h.assertEvent(t,"xyflow.nodeClick"),e.xyedges.some(n=>n.source===t.node.id||n.target===t.node.id)),"click: selected edge":({event:e})=>(h.assertEvent(e,"xyflow.edgeClick"),e.edge.selected===!0||e.edge.data.active===!0)},actions:{"trigger:NavigateTo":h.emit(({context:e})=>({type:"navigateTo",viewId:F(e.lastOnNavigate,"Invalid state, lastOnNavigate is null").toView})),"assign lastClickedNode":h.assign(({context:e,event:t})=>(h.assertEvent(t,"xyflow.nodeClick"),{lastClickedNode:kb({context:e,event:t})})),"assign: focusedNode":h.assign(({event:e})=>{let t;switch(e.type){case"xyflow.nodeClick":t=e.node.data.id;break;case"focus.node":t=e.nodeId;break;default:throw new Error(`Unexpected event type: ${e.type} in action 'assign: focusedNode'`)}return{focusedNode:t}}),"reset lastClickedNode":h.assign(()=>({lastClickedNode:null})),"open source of focused or last clicked node":h.enqueueActions(({context:e,enqueue:t})=>{const n=e.focusedNode??e.lastClickedNode?.id;if(!n||!e.features.enableVscode)return;const i=Ot(e,n);i&&(i.deploymentRef?t.raise({type:"open.source",deployment:i.deploymentRef}):i.modelRef&&t.raise({type:"open.source",element:i.modelRef}))}),"xyflow:fitDiagram":({context:e},t)=>{const{bounds:n=e.view.bounds,duration:i=450}=t??{},{width:a,height:s,panZoom:r,transform:l}=F(e.xystore).getState(),d=Math.max(1,l[2]),c=hn(n,a,s,qe,d,e.fitViewPadding);c.x=Math.round(c.x),c.y=Math.round(c.y),r?.setViewport(c,i>0?{duration:i}:void 0).catch(console.error)},"xyflow:fitFocusedBounds":({context:e})=>{const t=!!e.activeWalkthrough&&e.dynamicViewVariant==="sequence",{bounds:n,duration:i=450}=t?Sm({context:e}):jm({context:e}),{width:a,height:s,panZoom:r,transform:l}=F(e.xystore).getState(),d=Math.max(1,l[2]),c=hn(n,a,s,qe,d,e.fitViewPadding);c.x=Math.round(c.x),c.y=Math.round(c.y),r?.setViewport(c,i>0?{duration:i}:void 0)},"xyflow:setViewportCenter":({context:e},t)=>{const{x:n,y:i}=t;T(e.xyflow,"xyflow is not initialized");const a=e.xyflow.getZoom();e.xyflow.setCenter(Math.round(n),Math.round(i),{zoom:a})},"xyflow:setViewport":({context:e},t)=>{const{viewport:n,duration:i=350}=t;e.xystore?.getState().panZoom?.setViewport(n,i>0?{duration:i}:void 0)},"xyflow:alignNodeFromToAfterNavigate":({context:e},t)=>{const n=F(e.xyflow,"xyflow is not initialized"),i=n.getInternalNode(t.fromNode);if(!i)return;const a=n.flowToScreenPosition({x:i.internals.positionAbsolute.x,y:i.internals.positionAbsolute.y}),s=n.flowToScreenPosition(t.toPosition),r={x:Math.round(a.x-s.x),y:Math.round(a.y-s.y)};e.xystore.getState().panBy(r)},"layout.align":({context:e},t)=>{const{mode:n}=t,i=F(e.xystore,"xystore is not initialized"),{nodeLookup:a,parentLookup:s}=i.getState(),r=[...new Set(a.values().filter(u=>u.selected).map(u=>u.id)).difference(new Set(s.keys()))];if(!de(r,2)){console.warn("At least 2 nodes must be selected to align");return}const l=Id(i,r),d=vb(n),c=r.map(u=>({node:F(a.get(u)),rect:F(l.rects.get(u))}));d.computeLayout(c.map(({node:u})=>sr(u)));for(const{rect:u,node:p}of c)u.positionAbsolute={...u.positionAbsolute,...d.applyPosition(sr(p))};l.updateXYFlowNodes()},"ensure overlays actor state":h.enqueueActions(({enqueue:e,context:{features:t},system:n})=>{const i=t.enableElementDetails||t.enableRelationshipDetails||t.enableRelationshipBrowser,a=Je(n).overlaysActorRef;if(i&&!a){e.spawnChild("overlaysActorLogic",{id:"overlays",systemId:"overlays"});return}!i&&a&&(e.sendTo(a,{type:"close.all"}),e.stopChild("overlays"))}),"ensure search actor state":h.enqueueActions(({enqueue:e,context:{features:{enableSearch:t}},system:n})=>{const i=Je(n).searchActorRef;if(t&&!i){e.spawnChild("searchActorLogic",{id:"search",systemId:"search"});return}!t&&i&&(e.sendTo(i,{type:"close"}),e.stopChild("search"))}),updateFeatures:h.assign(({event:e})=>(h.assertEvent(e,"update.features"),{features:{...e.features}})),updateInputs:h.assign(({event:e})=>(h.assertEvent(e,"update.inputs"),{...e.inputs})),closeSearch:h.sendTo(({system:e})=>Je(e).searchActorRef,{type:"close"}),closeAllOverlays:h.sendTo(({system:e})=>Je(e).overlaysActorRef,{type:"close.all"}),startSyncLayout:h.assign(({context:e,spawn:t,self:n})=>({syncLayoutActorRef:t("syncManualLayoutActorLogic",{id:"syncLayout",input:{parent:n,viewId:e.view.id}})})),stopSyncLayout:h.enqueueActions(({context:e,enqueue:t})=>{t.sendTo(e.syncLayoutActorRef,{type:"stop"}),t.stopChild(e.syncLayoutActorRef),t.assign({syncLayoutActorRef:null})}),onNodeMouseEnter:h.assign(({context:e},t)=>({xynodes:e.xynodes.map(n=>n.id===t.node.id?q.setHovered(n,!0):n)})),onNodeMouseLeave:h.assign(({context:e},t)=>({xynodes:e.xynodes.map(n=>n.id===t.node.id?q.setHovered(n,!1):n)})),onEdgeMouseEnter:h.enqueueActions(({enqueue:e,context:t,event:n})=>{h.assertEvent(n,"xyflow.edgeMouseEnter");let i=n.edge;e.assign({xyedges:t.xyedges.map(a=>a.id===n.edge.id?(i=q.setHovered(a,!0),i):a)}),e.emit({type:"edgeMouseEnter",edge:i,event:n.event})}),onEdgeMouseLeave:h.enqueueActions(({enqueue:e,context:t,event:n})=>{h.assertEvent(n,"xyflow.edgeMouseLeave");let i=n.edge;e.assign({xyedges:t.xyedges.map(a=>a.id===n.edge.id?(i=q.setHovered(a,!1),i):a)}),e.emit({type:"edgeMouseLeave",edge:i,event:n.event})}),"focus on nodes and edges":h.assign(jb),"notations.highlight":h.assign(({context:e},t)=>{const n=t.kind?[t.kind]:t.notation.kinds;return{xynodes:e.xynodes.map(i=>{const a=Ot(e,i.id);return a&&a.notation===t.notation.title&&a.shape===t.notation.shape&&a.color===t.notation.color&&n.includes(a.kind)?q.setDimmed(i,!1):q.setDimmed(i,"immediate")}),xyedges:e.xyedges.map(q.setDimmed("immediate"))}}),"tag.highlight":h.assign(({context:e,event:t})=>(h.assertEvent(t,"tag.highlight"),{xynodes:e.xynodes.map(n=>n.data.tags?.includes(t.tag)?q.setDimmed(n,!1):q.setDimmed(n,!0))})),"undim everything":h.assign(({context:e})=>({xynodes:e.xynodes.map(q.setDimmed(!1)),xyedges:e.xyedges.map(q.setData({dimmed:!1,active:!1}))})),"update active walkthrough":h.assign(Eb),"open element details":h.sendTo(({system:e})=>Je(e).overlaysActorRef,({context:e,event:t},n)=>{let i=null,a,s;if(n)s=n.fqn,a=n.fromNode??e.view.nodes.find(l=>l.modelRef===n.fqn)?.id;else if(t.type==="xyflow.nodeClick")T("modelFqn"in t.node.data&&!!t.node.data.modelFqn,"No modelFqn in event node data"),s=t.node.data.modelFqn,a=t.node.data.id;else if(t.type==="open.elementDetails")s=t.fqn,a=t.fromNode;else{T(e.lastClickedNode,"No last clicked node"),a=F(e.lastClickedNode).id;const l=F(e.xynodes.find(d=>d.id===a));T("modelFqn"in l.data&&!!l.data.modelFqn,"No modelFqn in last clicked node"),s=l.data.modelFqn}const r=a?e.xystore.getState().nodeLookup.get(a):null;if(a&&r){const l=pc(r),d=e.xyflow.getZoom(),c={...e.xyflow.flowToScreenPosition(l),width:l.width*d,height:l.height*d};i={node:a,clientRect:c}}return{type:"open.elementDetails",subject:s,currentView:e.view,...i&&{initiatedFrom:i}}}),"emit: walkthroughStarted":h.emit(({context:e})=>{const t=e.xyedges.find(n=>n.id===e.activeWalkthrough?.stepId);return T(t,"Invalid walkthrough state"),{type:"walkthroughStarted",edge:t}}),"emit: walkthroughStep":h.emit(({context:e})=>{const t=e.xyedges.find(n=>n.id===e.activeWalkthrough?.stepId);return T(t,"Invalid walkthrough state"),{type:"walkthroughStep",edge:t}}),"emit: walkthroughStopped":h.emit(()=>({type:"walkthroughStopped"})),"emit: edgeEditingStarted":h.emit(({context:e,event:t})=>(h.assertEvent(t,"xyflow.edgeEditingStarted"),{type:"edgeEditingStarted",edge:F(e.xyedges.find(n=>n.id===t.edge.id),`Edge ${t.edge.id} not found`)})),"emit: paneClick":h.emit(()=>({type:"paneClick"})),"emit: nodeClick":h.emit(({context:e,event:t})=>(h.assertEvent(t,"xyflow.nodeClick"),{type:"nodeClick",node:F(Ot(e,t.node.id),`Node ${t.node.id} not found in diagram`),xynode:t.node})),"emit: edgeClick":h.emit(({context:e,event:t})=>(h.assertEvent(t,"xyflow.edgeClick"),{type:"edgeClick",edge:F(wa(e,t.edge.id),`Edge ${t.edge.id} not found in diagram`),xyedge:t.edge})),"emit: initialized":h.emit(({context:e})=>(T(e.xyflow,"XYFlow instance not found"),{type:"initialized",instance:e.xyflow})),"emit: openSource":h.emit((e,t)=>({type:"openSource",params:t})),"assign: dynamicViewVariant":h.assign(({event:e})=>(h.assertEvent(e,"switch.dynamicViewVariant"),{dynamicViewVariant:e.variant}))}}).createMachine({initial:"initializing",context:({input:e})=>({...e,xyedges:[],xynodes:[],features:{...fl},toggledFeatures:dr.read()??{enableReadOnly:!0},initialized:{xydata:!1,xyflow:!1},viewportChangedManually:!1,lastOnNavigate:null,lastClickedNode:null,focusedNode:null,activeElementDetails:null,viewportBeforeFocus:null,navigationHistory:{currentIndex:0,history:[]},viewport:{x:0,y:0,zoom:1},xyflow:null,syncLayoutActorRef:null,dynamicViewVariant:e.dynamicViewVariant??(e.view._type==="dynamic"?e.view.variant:"diagram")??"diagram",activeWalkthrough:null}),states:{initializing:{on:{"xyflow.init":{actions:h.assign(({context:e,event:t})=>({initialized:{...e.initialized,xyflow:!0},xyflow:t.instance})),target:"isReady"},"update.view":{actions:h.assign(({context:e,event:t})=>({initialized:{...e.initialized,xydata:!0},view:t.view,xynodes:t.xynodes,xyedges:t.xyedges})),target:"isReady"}}},isReady:{always:[{guard:"isReady",actions:[{type:"xyflow:fitDiagram",params:{duration:0}},h.assign(({context:e})=>({navigationHistory:{currentIndex:0,history:[{viewId:e.view.id,fromNode:null,viewport:{...e.xyflow.getViewport()}}]}})),"startSyncLayout","emit: initialized"],target:"ready"},{target:"initializing"}]},ready:{initial:"idle",on:{"navigate.to":{guard:"is another view",actions:h.assign({lastOnNavigate:({context:e,event:t})=>({fromView:e.view.id,toView:t.viewId,fromNode:t.fromNode??null})}),target:"#navigating"},"navigate.back":{guard:({context:e})=>e.navigationHistory.currentIndex>0,actions:h.assign(Cb),target:"#navigating"},"navigate.forward":{guard:({context:e})=>e.navigationHistory.currentIndex<e.navigationHistory.history.length-1,actions:h.assign(Sb),target:"#navigating"},"layout.align":{guard:"not readonly",actions:[{type:"layout.align",params:({event:e})=>({mode:e.mode})},h.raise({type:"saveManualLayout.schedule"})]},"layout.resetEdgeControlPoints":{guard:"not readonly",actions:[h.assign(Mb),h.raise({type:"saveManualLayout.schedule"})]},"xyflow.resized":{guard:({context:e})=>e.features.enableFitView&&!e.viewportChangedManually,actions:[h.cancel("fitDiagram"),h.raise({type:"fitDiagram"},{id:"fitDiagram",delay:200})]},"open.elementDetails":{guard:"enabled: ElementDetails",actions:"open element details"},"open.relationshipsBrowser":{actions:h.sendTo(({system:e})=>Je(e).overlaysActorRef,({context:e,event:t})=>({type:"open.relationshipsBrowser",subject:t.fqn,viewId:e.view.id,scope:"view",closeable:!0,enableChangeScope:!0,enableSelectSubject:!0}))},"open.relationshipDetails":{actions:h.sendTo(({system:e})=>Je(e).overlaysActorRef,({context:e,event:t})=>({type:"open.relationshipDetails",viewId:e.view.id,...t.params}))},"open.source":{actions:{type:"emit: openSource",params:Se("event")}},"walkthrough.start":{guard:"is dynamic view",target:".walkthrough"},"toggle.feature":{actions:h.assign({toggledFeatures:({context:e,event:t})=>dr.write({...e.toggledFeatures,[`enable${t.feature}`]:t.forceValue??!(e.toggledFeatures[`enable${t.feature}`]??e.features[`enable${t.feature}`])})})},"xyflow.nodeMouseEnter":{actions:{type:"onNodeMouseEnter",params:Se("event")}},"xyflow.nodeMouseLeave":{actions:{type:"onNodeMouseLeave",params:Se("event")}},"xyflow.edgeMouseEnter":{actions:"onEdgeMouseEnter"},"xyflow.edgeMouseLeave":{actions:"onEdgeMouseLeave"},"notations.highlight":{actions:{type:"notations.highlight",params:Se("event")}},"notations.unhighlight":{actions:"undim everything"},"tag.highlight":{actions:"tag.highlight"},"tag.unhighlight":{actions:"undim everything"},"saveManualLayout.*":{guard:"not readonly",actions:h.sendTo(e=>e.context.syncLayoutActorRef,({event:e})=>{if(e.type==="saveManualLayout.schedule")return{type:"sync"};if(e.type==="saveManualLayout.cancel")return{type:"cancel"};Le(e)})},"open.search":{guard:"enabled: Search",actions:h.sendTo(({system:e})=>Je(e).searchActorRef,({event:e})=>({type:"open",search:e.search}))}},exit:[h.cancel("fitDiagram")],states:{idle:{id:"idle",on:{"xyflow.nodeClick":[{guard:h.and(["enabled: FocusMode","click: node has connections",h.or(["click: same node","click: selected node"])]),actions:["assign lastClickedNode","assign: focusedNode","emit: nodeClick"],target:"focused"},{guard:h.and(["enabled: ElementDetails","click: node has modelFqn",h.or(["click: same node","click: selected node"])]),actions:["assign lastClickedNode","open source of focused or last clicked node","open element details","emit: nodeClick"]},{actions:["assign lastClickedNode","open source of focused or last clicked node","emit: nodeClick"]}],"xyflow.paneClick":{actions:["reset lastClickedNode","emit: paneClick"]},"xyflow.paneDblClick":{actions:["reset lastClickedNode","xyflow:fitDiagram",{type:"emit: openSource",params:({context:e})=>({view:e.view.id})}]},"focus.node":{guard:"enabled: FocusMode",actions:"assign: focusedNode",target:"focused"},"xyflow.edgeClick":{guard:h.and(["is dynamic view","enabled: DynamicViewWalkthrough","click: selected edge"]),actions:[h.raise(({event:e})=>({type:"walkthrough.start",stepId:e.edge.id})),"emit: edgeClick"]}}},focused:{entry:["focus on nodes and edges",h.assign(e=>({viewportBeforeFocus:{...e.context.viewport}})),"open source of focused or last clicked node",h.spawnChild("hotkeyActorLogic",{id:"hotkey"}),"xyflow:fitFocusedBounds"],exit:h.enqueueActions(({enqueue:e,context:t})=>{e.stopChild("hotkey"),t.viewportBeforeFocus?e({type:"xyflow:setViewport",params:{viewport:t.viewportBeforeFocus}}):e("xyflow:fitDiagram"),e("undim everything"),e.assign({viewportBeforeFocus:null,focusedNode:null})}),on:{"xyflow.nodeClick":[{guard:h.and(["click: focused node","click: node has modelFqn"]),actions:["open element details","emit: nodeClick"]},{guard:"click: focused node",actions:"emit: nodeClick",target:"#idle"},{actions:["assign lastClickedNode",h.raise(({event:e})=>({type:"focus.node",nodeId:e.node.id})),"emit: nodeClick"]}],"focus.node":{actions:["assign: focusedNode","focus on nodes and edges","open source of focused or last clicked node","xyflow:fitFocusedBounds"]},"key.esc":{target:"idle"},"xyflow.paneClick":{actions:["reset lastClickedNode","emit: paneClick"],target:"idle"},"notations.unhighlight":{actions:"focus on nodes and edges"},"tag.unhighlight":{actions:"focus on nodes and edges"}}},walkthrough:{entry:[h.spawnChild("hotkeyActorLogic",{id:"hotkey"}),h.assign({viewportBeforeFocus:({context:e})=>e.viewport,activeWalkthrough:({context:e,event:t})=>{h.assertEvent(t,"walkthrough.start");const n=t.stepId??gn(e.xyedges).id;return{stepId:n,parallelPrefix:Yo(n)}}}),"update active walkthrough","xyflow:fitFocusedBounds","emit: walkthroughStarted"],exit:h.enqueueActions(({enqueue:e,context:t})=>{e.stopChild("hotkey"),t.viewportBeforeFocus?e({type:"xyflow:setViewport",params:{viewport:t.viewportBeforeFocus}}):e("xyflow:fitDiagram"),t.dynamicViewVariant==="sequence"&&t.activeWalkthrough?.parallelPrefix&&e.assign({xynodes:t.xynodes.map(n=>n.type==="seq-parallel"?q.setData(n,{color:mo.default}):n)}),e("undim everything"),e.assign({activeWalkthrough:null,viewportBeforeFocus:null}),e("emit: walkthroughStopped")}),on:{"key.esc":{target:"idle"},"key.arrow.left":{actions:h.raise({type:"walkthrough.step",direction:"previous"})},"key.arrow.right":{actions:h.raise({type:"walkthrough.step",direction:"next"})},"walkthrough.step":{actions:[h.assign(({context:e,event:t})=>{const{stepId:n}=e.activeWalkthrough,i=e.xyedges.findIndex(r=>r.id===n),a=Ve(t.direction==="next"?i+1:i-1,{min:0,max:e.xyedges.length-1});if(a===i)return{};const s=e.xyedges[a].id;return{activeWalkthrough:{stepId:s,parallelPrefix:Yo(s)}}}),"update active walkthrough","xyflow:fitFocusedBounds","emit: walkthroughStep"]},"xyflow.edgeClick":{actions:[h.assign(({event:e,context:t})=>!_o(e.edge.id)||e.edge.id===t.activeWalkthrough?.stepId?{}:{activeWalkthrough:{stepId:e.edge.id,parallelPrefix:Yo(e.edge.id)}}),"update active walkthrough","xyflow:fitFocusedBounds","emit: edgeClick","emit: walkthroughStep"]},"notations.unhighlight":{actions:"update active walkthrough"},"tag.unhighlight":{actions:"update active walkthrough"},"walkthrough.end":{target:"idle"},"xyflow.paneDblClick":{target:"idle"},"update.view":{guard:"is another view",actions:h.raise(({event:e})=>e,{delay:50}),target:"idle"}}}}},navigating:{id:"navigating",entry:["closeAllOverlays","closeSearch","stopSyncLayout","trigger:NavigateTo"],on:{"update.view":{actions:h.enqueueActions(({enqueue:e,context:t,event:n})=>{const{fromNode:i,toNode:a}=ur(t,n);e(i&&a?{type:"xyflow:alignNodeFromToAfterNavigate",params:{fromNode:i.id,toPosition:{x:a.data.x,y:a.data.y}}}:{type:"xyflow:setViewportCenter",params:ct.center(n.view.bounds)}),e.assign(lr),e.assign({...rr({context:t,event:n}),lastOnNavigate:null}),e("startSyncLayout"),e.raise({type:"fitDiagram"},{id:"fitDiagram",delay:25})}),target:"#idle"}}}},on:{"xyflow.paneClick":{actions:"emit: paneClick"},"xyflow.nodeClick":{actions:"emit: nodeClick"},"xyflow.edgeClick":{actions:"emit: edgeClick"},"xyflow.applyNodeChanges":{actions:h.assign({xynodes:({context:e,event:t})=>Yi(t.changes,e.xynodes)})},"xyflow.applyEdgeChanges":{actions:h.assign({xyedges:({context:e,event:t})=>Xi(t.changes,e.xyedges)})},"xyflow.viewportMoved":{actions:h.assign({viewportChangedManually:(({event:e})=>e.manually),viewport:(({event:e})=>e.viewport)})},"xyflow.edgeEditingStarted":{actions:"emit: edgeEditingStarted"},fitDiagram:{guard:"enabled: FitView",actions:{type:"xyflow:fitDiagram",params:Se("event")}},"update.nodeData":{actions:h.assign(_b)},"update.edgeData":{actions:h.assign(Pb)},"update.view":{actions:[h.assign(lr),h.enqueueActions(({enqueue:e,event:t,check:n,context:i})=>{const a=n("is another view");if(a){e("closeAllOverlays"),e("closeSearch"),e("stopSyncLayout"),e.assign({focusedNode:null});const{fromNode:s,toNode:r}=ur(i,t);s&&r?(e({type:"xyflow:alignNodeFromToAfterNavigate",params:{fromNode:s.id,toPosition:{x:r.data.x,y:r.data.y}}}),e.raise({type:"fitDiagram"},{id:"fitDiagram",delay:80})):(e({type:"xyflow:setViewportCenter",params:ct.center(t.view.bounds)}),e.raise({type:"fitDiagram",duration:200},{id:"fitDiagram",delay:25}))}else{const s=t.view;s._type==="dynamic"&&i.view._type==="dynamic"&&s.variant!==i.view.variant&&e({type:"xyflow:setViewportCenter",params:ct.center(s.bounds)})}e.assign({...rr({context:i,event:t}),lastOnNavigate:null}),a?e("startSyncLayout"):(e.sendTo(s=>s.context.syncLayoutActorRef,{type:"synced"}),i.viewportChangedManually||e.raise({type:"fitDiagram"},{id:"fitDiagram",delay:50}))})]},"update.inputs":{actions:"updateInputs"},"update.features":{actions:["updateFeatures","ensure overlays actor state","ensure search actor state"]},"switch.dynamicViewVariant":{actions:"assign: dynamicViewVariant"}},exit:["stopSyncLayout",h.cancel("fitDiagram"),h.stopChild("hotkey"),h.stopChild("overlays"),h.stopChild("search"),h.assign({xyflow:null,xystore:null,xyedges:[],xynodes:[],initialized:{xydata:!1,xyflow:!1},syncLayoutActorRef:null})]});function cr(e){switch(e.type){case"element":case"compound-element":case"seq-actor":return e.data.modelFqn;case"deployment":case"compound-deployment":return e.data.modelFqn??e.data.deploymentFqn;case"seq-parallel":case"view-group":return null;default:Le(e)}}function ur(e,t){const n=e.lastOnNavigate?.fromNode,i=n&&e.xynodes.find(r=>r.id===n),a=i&&cr(i),s=a&&t.xynodes.find(r=>cr(r)===a);return{fromNode:i,toNode:s}}const Bb=Db,Tb=e=>e.context.dynamicViewVariant;function Lb({view:e,zoomable:t,pannable:n,fitViewPadding:i,nodesSelectable:a,where:s,children:r,dynamicViewVariant:l}){const{handlersRef:d}=at(),c=yo(),u=m.useRef(null);u.current||(u.current=Bb.provide({actors:{syncManualLayoutActorLogic:Ad.provide({actions:{"trigger:OnChange":((b,C)=>{d.current.onChange?.(C)})}})}}));const p=ee.useActorRef(u.current,{id:"diagram",systemId:"diagram",input:{xystore:c,view:e,zoomable:t,pannable:n,fitViewPadding:i,nodesSelectable:a,dynamicViewVariant:l}}),g=K();Wr(()=>{p.send({type:"update.features",features:g})},[g],le),m.useEffect(()=>{p.send({type:"update.inputs",inputs:{zoomable:t,pannable:n,fitViewPadding:i,nodesSelectable:a}})},[t,n,i,a]);const f=ee.useSelector(p,Tb),y=m.useMemo(()=>sb({view:e,where:s,nodesSelectable:a,dynamicViewVariant:f}),[e,s,a,f]);return vr(()=>{p.send({type:"update.view",...y})},[p,y]),So(()=>{l&&p.send({type:"switch.dynamicViewVariant",variant:l})},[l]),o.jsxs(Pm,{value:p,children:[o.jsx(Cl,{children:o.jsx(zb,{actorRef:p,children:r})}),o.jsx($b,{actorRef:p})]})}const Ab=e=>e.context.features.enableReadOnly||e.context.activeWalkthrough?{viewId:e.context.view.id,toggledFeatures:{...e.context.toggledFeatures,enableReadOnly:!0}}:{viewId:e.context.view.id,toggledFeatures:e.context.toggledFeatures};function zb({children:e,actorRef:t}){const{viewId:n,toggledFeatures:i}=ee.useSelector(t,Ab,I),a=be().findView(n);return o.jsx(fa.Provider,{value:a,children:o.jsx(Pt,{overrides:i,children:e})})}function $b({actorRef:e}){const t=W(),{onNavigateTo:n,onOpenSource:i,handlersRef:a}=at();$e("openSource",({params:r})=>i?.(r)),$e("navigateTo",({viewId:r})=>n?.(r));const s=m.useRef(!1);return m.useEffect(()=>{if(s.current)return;let r=e.on("initialized",({instance:l})=>{try{a.current.onInitialized?.({diagram:t,xyflow:l})}catch(d){console.error(d)}s.current=!0,r?.unsubscribe(),r=null});return()=>{r?.unsubscribe()}},[e,t]),null}const zd=e=>`[data-mantine-color-scheme="${e}"]`,$d=zd("dark"),Fb=zd("light"),Vb=5,Ob=(e,t,n,i)=>{const a=l=>Oa(Wa(l,{l:-22-5*i,s:-10-6*i})),s=l=>Oa(Wa(l,{l:-20-3*i,s:-3-6*i})),r=`:where(${e} [data-likec4-color="${t}"][data-compound-depth="${i}"])`;return`
${r} {
  --likec4-palette-fill: ${s(n.elements.fill)};
  --likec4-palette-stroke: ${s(n.elements.stroke)};
}
${$d} ${r} {
  --likec4-palette-fill: ${a(n.elements.fill)};
  --likec4-palette-stroke: ${a(n.elements.stroke)};
}
  `.trim()};function Wb(e,t,n){const{elements:i,relationships:a}=n,s=`:where(${e} [data-likec4-color=${t}])`;return[`
${s} {
  --likec4-palette-fill: ${i.fill};
  --likec4-palette-stroke: ${i.stroke};
  --likec4-palette-hiContrast: ${i.hiContrast};
  --likec4-palette-loContrast: ${i.loContrast};
  --likec4-palette-relation-stroke: ${a.line};
  --likec4-palette-relation-label: ${a.label};
  --likec4-palette-relation-label-bg: ${a.labelBg};
}
${Fb} ${s} {
  --likec4-palette-relation-stroke-selected: ${$a(Fa(a.line,"black",85))};
}
${$d} ${s} {
  --likec4-palette-relation-stroke-selected: ${$a(Fa(a.line,"white",70))};
}

  `.trim(),...$c(1,Vb+1).map(r=>Ob(e,t,n,r))].join(`
`)}function Hb(e,t){return re(t.colors,Ui(),me(([n,i])=>Wb(e,n,i)),Dr(`
`))}const qb=m.memo(({id:e})=>{const t=`#${e}`,n=Fi()?.(),{theme:i}=Wl(),a=Hb(t,i);return o.jsx("style",{type:"text/css","data-likec4-colors":e,dangerouslySetInnerHTML:{__html:a},nonce:n})});function Xb({onCanvasClick:e,onCanvasContextMenu:t,onCanvasDblClick:n,onEdgeClick:i,onChange:a,onEdgeContextMenu:s,onNavigateTo:r,onNodeClick:l,onNodeContextMenu:d,onOpenSource:c,onBurgerMenuClick:u,onInitialized:p,view:g,className:f,readonly:y=!0,controls:b=!y,fitView:C=!0,fitViewPadding:k=b?ds.withControls:ds.default,pannable:v=!0,zoomable:M=!0,background:w="dots",enableElementTags:j=!1,enableFocusMode:_=!1,enableElementDetails:L=!1,enableRelationshipDetails:P=!1,enableRelationshipBrowser:V=!1,nodesDraggable:O=!y,nodesSelectable:D=!y||_||!!r||!!l,showNotations:$=!0,showNavigationButtons:H=!!r,enableDynamicViewWalkthrough:E=!1,dynamicViewVariant:N,enableSearch:Q=!1,initialWidth:je,initialHeight:he,experimentalEdgeEditing:lt=!y,reduceGraphics:se="auto",renderIcon:on,where:A,reactFlowProps:xe,renderNodes:Y,children:U}){const G=cm(),we=m.useRef(null),Ie=Of(g,N),Ce=Yb(k);we.current==null&&(we.current={defaultEdges:[],defaultNodes:[],initialWidth:je??Ie.width,initialHeight:he??Ie.height,initialFitViewOptions:{maxZoom:Ei,minZoom:qe,padding:Ce},initialMaxZoom:Ei,initialMinZoom:qe});const Ue=se==="auto"?v&&(Ie.width??1)*(Ie.height??1)>6e6&&g.nodes.some(mt=>mt.children?.length>0):se;return o.jsx(xl,{children:o.jsx(tm,{...Ue&&{reducedMotion:"always"},children:o.jsx(Og,{value:on??null,children:o.jsx(Pt,{features:{enableFitView:C,enableReadOnly:y,enableFocusMode:_,enableNavigateTo:!!r,enableElementDetails:L,enableRelationshipDetails:P,enableRelationshipBrowser:V,enableSearch:Q,enableNavigationButtons:H&&!!r,enableDynamicViewWalkthrough:g._type==="dynamic"&&E,enableEdgeEditing:lt,enableNotations:$,enableVscode:!!c,enableControls:b,enableElementTags:j},children:o.jsxs(Uh,{handlers:{onCanvasClick:e,onCanvasContextMenu:t,onCanvasDblClick:n,onEdgeClick:i,onChange:a,onEdgeContextMenu:s,onNavigateTo:r,onNodeClick:l,onNodeContextMenu:d,onOpenSource:c,onBurgerMenuClick:u,onInitialized:p},children:[o.jsx(qb,{id:G}),o.jsx(rm,{rootSelector:`#${G}`,children:o.jsx(Kh,{id:G,className:f,reduceGraphics:Ue,children:o.jsx(Ji,{fitView:C,...we.current,children:o.jsxs(Lb,{view:g,zoomable:M,pannable:v,fitViewPadding:Ce,nodesSelectable:D,where:A??null,dynamicViewVariant:N,children:[o.jsx(J1,{nodesDraggable:O,nodesSelectable:D,background:w,reactFlowProps:xe,renderNodes:Y,children:U}),o.jsx(Nd,{})]})})})})]})})})})})}const pr=e=>typeof e=="number"?`${e}px`:e;function Yb(e){return ta(()=>Jc(e)?Qc(e,pr):pr(e),[e],I)}function nw({children:e,likec4model:t}){return o.jsx(Mo.Provider,{value:t,children:e})}function ow({children:e,projects:t,onProjectChange:n}){m.useContext(lo)&&console.warn("LikeC4ProjectsProvider should not be nested inside another one");const i=B(n),a=ta(()=>({projects:t,onProjectChange:i}),[t,i],le);return o.jsx(lo.Provider,{value:a,children:e})}function iw({view:e,fitView:t=!0,fitViewPadding:n="8px",enableRelationshipDetails:i=!1,enableRelationshipBrowser:a=i,background:s="transparent",className:r,...l}){return o.jsx(Xb,{view:e,readonly:!0,className:S(r,"likec4-static-view"),fitView:t,fitViewPadding:n,pannable:!1,zoomable:!1,controls:!1,background:s,showNotations:!1,enableElementDetails:!1,enableRelationshipDetails:i,enableRelationshipBrowser:a,enableDynamicViewWalkthrough:!1,showNavigationButtons:!1,experimentalEdgeEditing:!1,enableFocusMode:!1,enableSearch:!1,nodesSelectable:!1,nodesDraggable:!1,enableElementTags:!1,...l})}export{Ub as A,J as B,Ig as C,Le as D,ll as E,pt as F,F as G,Qg as H,Jb as I,ow as L,Et as M,te as R,iw as S,kp as a,So as b,x as c,Og as d,nw as e,Qb as f,ew as g,hp as h,Vg as i,Vs as j,Of as k,Xb as l,be as m,al as n,ca as o,ng as p,dl as q,T as r,Yt as s,mn as t,tw as u,Ne as v,ol as w,_p as x,nl as y,Kb as z};
